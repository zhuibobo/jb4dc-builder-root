<!DOCTYPE html>
<html lang="zh" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <th:block th:replace="Fragment/GeneralLib::GeneralLib"></th:block>
    <th:block th:replace="Fragment/GeneralLib::JBuild4DFormDesignLib"></th:block>
    <th:block th:replace="Fragment/GeneralLib::ThemesLib"></th:block>
    <th:block th:replace="Fragment/GeneralLib::HTMLDesignRuntimeLib"></th:block>
</head>
<body>
    <div class="html-design-plugin-dialog-wraper" id="dialogApp" v-cloak>
        <tabs size="small">
            <tab-pane label="绑定信息">
                <table class="html-design-plugin-dialog-table-wraper" cellpadding="0" cellspacing="0" border="0">
                    <colgroup>
                        <col style="width: 120px" />
                        <col style="width: 240px" />
                        <col style="width: 90px" />
                        <col style="width: 120px" />
                        <col style="width: 90px" />
                        <col />
                    </colgroup>
                    <tbody>
                        <tr>
                            <td>触发按钮：</td>
                            <td>
                                <i-select v-model="normalProps.targetButtonId" style="width:230px" :clearable="true">
                                    <i-option :value="item.buttonId" v-for="item in buttons">{{item.buttonCaption}}</i-option>
                                </i-select>
                            </td>
                            <td>标题：</td>
                            <td colspan="3">
                                <input type="text" v-model="baseInfo.id" />
                            </td>
                        </tr>
                        <tr>
                            <td>选定图标：</td>
                            <td colspan="5">
                                <div class="list-row-button-wrap ">
                                    <div class="list-row-button view"></div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>可选图标：</td>
                            <td colspan="5">
                                <div class="wldct-list-table-row-button-wrap ">
                                    <div class="wldct-list-table-row-inner-button view"></div>
                                    <div class="wldct-list-table-row-inner-button edit"></div>
                                    <div class="wldct-list-table-row-inner-button del"></div>
                                    <div class="wldct-list-table-row-inner-button selected"></div>
                                    <div class="wldct-list-table-row-inner-button listmanager"></div>
                                    <div class="wldct-list-table-row-inner-button edit-model"></div>
                                    <div class="wldct-list-table-row-inner-button view-model"></div>
                                    <div class="wldct-list-table-row-inner-button move-up"></div>
                                    <div class="wldct-list-table-row-inner-button move-down"></div>
                                    <div class="wldct-list-table-row-inner-button kded"></div>
                                    <div class="wldct-list-table-row-inner-button grade"></div>
                                    <div class="wldct-list-table-row-inner-button image-cultured"></div>
                                    <div class="wldct-list-table-row-inner-button page-white-edit"></div>
                                    <div class="wldct-list-table-row-inner-button page-attach"></div>
                                    <div class="wldct-list-table-row-inner-button page-go"></div>
                                    <div class="wldct-list-table-row-inner-button script-go"></div>
                                    <div class="wldct-list-table-row-inner-button script-key"></div>
                                    <div class="wldct-list-table-row-inner-button wrench-orange"></div>
                                    <div class="wldct-list-table-row-inner-button x-office-document-template"></div>
                                    <div class="wldct-list-table-row-inner-button x-office-drawing"></div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>提示信息：</td>
                            <td colspan="5">
                                <input type="text" v-model="baseInfo.id" />
                            </td>
                        </tr>
                        <tr>
                            <td>显示条件：</td>
                            <td colspan="5">
                                <input type="text" v-model="baseInfo.id" />
                                eg:record.字段="是"
                            </td>
                        </tr>
                        <tr>
                            <td>显示条件方法：</td>
                            <td colspan="5">
                                <input type="text" v-model="baseInfo.id" />
                            </td>
                        </tr>
                    </tbody>
                </table>
            </tab-pane>
            <tab-pane label="基础信息">
                <fd-control-base-info v-model="baseInfo">
                </fd-control-base-info>
            </tab-pane>
            <tab-pane label="开发扩展">
                <table cellpadding="0" cellspacing="0" border="0" class="html-design-plugin-dialog-table-wraper">
                    <colgroup>
                        <col style="width: 150px" />
                        <col />
                    </colgroup>
                    <tbody>
                        <tr>
                            <td>
                                服务端解析类：
                            </td>
                            <td>
                                <i-input v-model="normalProps.custServerResolveMethod" placeholder="按钮进行服务端解析时,保存模版时候调用,类全称,需要实现接口IListTableLabelCustResolve" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                参数：
                            </td>
                            <td>
                                <i-input v-model="normalProps.custServerResolveMethodPara" placeholder="服务端解析类的参数" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                客户端渲染方法：
                            </td>
                            <td>
                                <i-input v-model="normalProps.custClientRendererMethod" placeholder="客户端渲染方法,生成前端页面时调动,最终形成页面元素,需要返回最终元素的HTML对象" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                参数：
                            </td>
                            <td>
                                <i-input v-model="normalProps.custClientRendererMethodPara" placeholder="客户端渲染方法的参数" />
                            </td>
                        </tr>
                    </tbody>
                </table>
            </tab-pane>
        </tabs>
    </div>
    <script>
        var DialogApp=new Vue({
            el:"#dialogApp",
            data: {
                baseInfo:CKEditorPluginUtility.DefaultProps.baseInfo,
                defaultValue: CKEditorPluginUtility.DefaultProps.defaultValue,
                normalProps:{
                    targetButtonId:"",
                    //开发扩展
                    custServerResolveMethod:"",
                    custServerResolveMethodPara:"",
                    custClientRendererMethod:"",
                    custClientRendererMethodPara:""
                },
                dataSetId:null,
                buttons:[]
            },
            mounted:function () {

            },
            methods: {
                ready:function(actionName,sel,parents){
                    this.baseInfo.id="btn_lt_inner_"+StringUtility.Timestamp();
                    this.baseInfo.name=this.baseInfo.id;

                    this.dataSetId=CKEditorPluginUtility.TryGetDataSetId(sel,parents);
                    this.buttons=CKEditorPluginUtility.TryGetListButtonsInPluginPage();

                    //this.bindDataSetFieldTree();
                },
                bindDataSetFieldTree:function(){
                    /*if(this.dataSetId){
                        var dataSetPO=window.parent.listDesign.getDataSet(this.dataSetId);
                        this.$refs.listTableLabelBindToComp.init(dataSetPO,this.buttons);
                    }
                    else {
                        DialogUtility.AlertText("请先设定DataSet");
                    }*/
                },
                getControlProps:function () {
                    var bindData=this.$refs.listTableLabelBindToComp.getData();
                    //for(var key in this.normalProps)
                    var result = {
                        success: true,
                        baseInfo: this.baseInfo,
                        normalProps:{
                            columnTableName: bindData.bindProp.columnTableName,
                            columnName: bindData.bindProp.columnName,
                            columnCaption: bindData.bindProp.columnCaption,
                            columnDataTypeName: bindData.bindProp.columnDataTypeName,
                            targetButtonId: bindData.bindProp.targetButtonId,
                            columnAlign:bindData.bindProp.columnAlign,
                            //开发扩展
                            custServerResolveMethod:this.normalProps.custServerResolveMethod,
                            custServerResolveMethodPara:this.normalProps.custServerResolveMethodPara,
                            custClientRendererMethod:this.normalProps.custClientRendererMethod,
                            custClientRendererMethodPara:this.normalProps.custClientRendererMethodPara
                        },
                        defaultValue: bindData.defaultValue
                    }
                    return result;
                },
                setControlProps:function ($elem,props) {
                    console.log(props);
                    this.baseInfo = props.baseInfo ? props.baseInfo : this.baseInfo;
                    //this.bindToSearchField = props.bindToSearchField ? props.bindToSearchField : this.bindToSearchField;
                    this.defaultValue = props.defaultValue ? props.defaultValue : this.defaultValue;


                    this.normalProps.targetButtonId=$elem.attr("targetbuttonid");

                    this.normalProps.custServerResolveMethod =$elem.attr("custserverresolvemethod");
                    this.normalProps.custServerResolveMethodPara = $elem.attr("custserverresolvemethodpara");
                    this.normalProps.custClientRendererMethod =$elem.attr("custclientrenderermethod");
                    this.normalProps.custClientRendererMethodPara = $elem.attr("custclientrenderermethodpara");

                    //this.$refs.listTableLabelBindToComp.setData(this.normalProps,this.defaultValue);
                }
            }
        });
    </script>
</body>
</html>