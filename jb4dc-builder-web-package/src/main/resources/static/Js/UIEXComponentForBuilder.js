"use strict";var EditTable_FieldName={Get_EditStatus_HtmlElem:function(e,t,l,a,i,n,u,r){var d="",f=t.BindName;if(null!=t.DefaultValue&&null!=t.DefaultValue)d=EditTableDefauleValue.GetValue(t);null!=r&&null!=r&&(d=r[f]),null!=n&&null!=n&&(d=n.html());var p=$("<input type='text' style='width: 98%' />");return p.val(d),p.attr("BindName",t.BindName),p.attr("Val",d),p.attr("IsSerialize","true"),p},Get_CompletedStatus_HtmlElem:function(e,t,l,a,i,n){var u=n.val().toUpperCase();return $("<label IsSerialize='true' BindName='"+t.BindName+"' Value='"+u+"'>"+u+"</label>")},ValidateToCompletedEnable:function(e,t,l,a,i,n){var u=n.val(),r=EditTableValidate.Validate(u,t);return r.Success&&i.find("[renderer=EditTable_FieldName]").each(function(){$(this).find("label").each(function(){var e=$(this);e.text()!=u&&e.text()!=u.toUpperCase()||(r={Success:!1,Msg:"[字段名称]不能重复!"})})}),r}},EditTable_SelectDefaultValue={Get_EditStatus_HtmlElem:function(e,t,l,a,i,n,u,r){var d="",f="",p="";null!=r&&null!=r&&(d=r.fieldDefaultType?r.fieldDefaultType:"",f=r.fieldDefaultValue?r.fieldDefaultValue:"",p=r.fieldDefaultText?r.fieldDefaultText:""),null!=n&&null!=n&&n.find("label").each(function(){"fieldDefaultType"==$(this).attr("BindName")?d=$(this).attr("Value"):"fieldDefaultText"==$(this).attr("BindName")?p=$(this).attr("Value"):"fieldDefaultValue"==$(this).attr("BindName")&&(f=$(this).attr("Value"))});var o=$("<div></div>"),c=$("<input type='text' style='width: 90%' readonly />");c.attr("fieldDefaultType",d),c.attr("fieldDefaultValue",f),c.attr("fieldDefaultText",p),c.val(JBuild4DSelectView.SelectEnvVariable.formatText(d,p));var T=$("<input class='normalbutton-v1' style='margin-left: 4px;' type='button' value='...'/>");return o.append(c).append(T),window.$Temp$Inputtxt=c,T.click(function(){window.tableDesion?tableDesion.selectDefaultValueDialogBegin(EditTable_SelectDefaultValue,null):(window.parent.listDesign.selectDefaultValueDialogBegin(window,null),window._SelectBindObj={setSelectEnvVariableResultValue:function(e){EditTable_SelectDefaultValue.setSelectEnvVariableResultValue(e)}})}),o},Get_CompletedStatus_HtmlElem:function(e,t,l,a,i,n){var u=n.find("input[type='text']");if(0<u.length){var r=u.attr("fieldDefaultType"),d=u.attr("fieldDefaultValue"),f=u.attr("fieldDefaultText"),p=$("<div></div>");return p.append("<label>"+JBuild4DSelectView.SelectEnvVariable.formatText(r,f)+"</label>"),p.append("<label IsSerialize='true' BindName='fieldDefaultType' Value='"+r+"' style='display:none'/>"),p.append("<label IsSerialize='true' BindName='fieldDefaultText' Value='"+f+"' style='display:none'/>"),p.append("<label IsSerialize='true' BindName='fieldDefaultValue' Value='"+d+"' style='display:none'/>"),p}return $("<label></label>")},ValidateToCompletedEnable:function(e,t,l,a,i,n){var u=n.val();return EditTableValidate.Validate(u,t)},setSelectEnvVariableResultValue:function(e){var t=window.$Temp$Inputtxt;null!=e?(t.attr("fieldDefaultType",e.Type),t.attr("fieldDefaultValue",e.Value),t.attr("fieldDefaultText",e.Text),t.val(JBuild4DSelectView.SelectEnvVariable.formatText(e.Type,e.Text))):(t.attr("fieldDefaultType",""),t.attr("fieldDefaultValue",""),t.attr("fieldDefaultText",""),t.val(""))}},EditTable_SelectFieldTypeDataLoader={_fieldDataTypeArray:null,GetFieldDataTypeArray:function(){if(null==this._fieldDataTypeArray){var l=this;AjaxUtility.PostSync("/Rest/Builder/DataStorage/DataBase/Table/GetTableFieldType",{},function(e){if(1==e.success){var t=JsonUtility.StringToJson(e.data);null!=t&&null!=t&&(l._fieldDataTypeArray=t)}else DialogUtility.Alert(window,"AlertLoadingQueryError",{},"加载字段类型失败！",null)},this)}return this._fieldDataTypeArray},GetFieldDataTypeObjectByValue:function(e){for(var t=this.GetFieldDataTypeArray(),l=0;l<t.length;l++){var a=t[l];if(a.Value==e)return a}alert("找不到指定的数据类型，请确认是否支持该类型！")},GetFieldDataTypeObjectByText:function(e){for(var t=this.GetFieldDataTypeArray(),l=0;l<t.length;l++){var a=t[l];if(a.Text==e)return a}alert("找不到指定的数据类型，请确认是否支持该类型！")}},EditTable_SelectFieldType={Get_EditStatus_HtmlElem:function(e,t,l,a,i,n,u,r){var d="",f=$("<select />");null!=r&&null!=r&&(d=r.fieldDataType),null!=n&&null!=n&&(d=n.attr("Value"));for(var p=EditTable_SelectFieldTypeDataLoader.GetFieldDataTypeArray(),o=0;o<p.length;o++){var c=p[o].Value,T=p[o].Text;f.append("<option value='"+c+"'>"+T+"</option>")}return""!=d?f.val(d):f.val(EditTable_SelectFieldTypeDataLoader.GetFieldDataTypeObjectByText("字符串").Value),f.change(function(){var e=$(this).val();"整数"==e?($(l).next().find("input").attr("disabled",!0),$(l).next().find("input").val(0),$(l).next().next().find("input").attr("disabled",!0),$(l).next().next().find("input").val(0)):"小数"==e?($(l).next().find("input").attr("disabled",!1),$(l).next().find("input").val(10),$(l).next().next().find("input").attr("disabled",!1),$(l).next().next().find("input").val(2)):"日期时间"==e?($(l).next().find("input").attr("disabled",!0),$(l).next().find("input").val(20),$(l).next().next().find("input").attr("disabled",!0),$(l).next().next().find("input").val(0)):"字符串"==e?($(l).next().find("input").attr("disabled",!1),$(l).next().find("input").val(50),$(l).next().next().find("input").attr("disabled",!0),$(l).next().next().find("input").val(0)):"长字符串"==e&&($(l).next().find("input").attr("disabled",!0),$(l).next().find("input").val(0),$(l).next().next().find("input").attr("disabled",!0),$(l).next().next().find("input").val(0))}),f},Get_CompletedStatus_HtmlElem:function(e,t,l,a,i,n){var u=n.val(),r=EditTable_SelectFieldTypeDataLoader.GetFieldDataTypeObjectByValue(u).Text;return $("<label IsSerialize='true' BindName='"+t.BindName+"' Value='"+u+"'>"+r+"</label>")},ValidateToCompletedEnable:function(e,t,l,a,i,n){var u=n.val();return EditTableValidate.Validate(u,t)}},Column_SelectDefaultValue={Get_EditStatus_HtmlElem:function(e,t,l,a,i,n,u,r){var d="",f="",p="";null!=r&&null!=r&&(d=r.columnDefaultType?r.columnDefaultType:"",f=r.columnDefaultValue?r.columnDefaultValue:"",p=r.columnDefaultText?r.columnDefaultText:""),null!=n&&null!=n&&n.find("label").each(function(){"columnDefaultType"==$(this).attr("BindName")?d=$(this).attr("Value"):"columnDefaultText"==$(this).attr("BindName")?p=$(this).attr("Value"):"columnDefaultValue"==$(this).attr("BindName")&&(f=$(this).attr("Value"))});var o=$("<div></div>"),c=$("<input type='text' style='width: 90%' readonly />");c.attr("columnDefaultType",d),c.attr("columnDefaultValue",f),c.attr("columnDefaultText",p),c.val(JBuild4DSelectView.SelectEnvVariable.formatText(d,p));var T=$("<input class='normalbutton-v1' style='margin-left: 4px;' type='button' value='...'/>");return o.append(c).append(T),window.$Temp$Inputtxt=c,T.click(function(){JBuild4DSelectView.SelectEnvVariable.beginSelect("Column_SelectDefaultValue")}),o},Get_CompletedStatus_HtmlElem:function(e,t,l,a,i,n){var u=n.find("input[type='text']");if(0<u.length){var r=u.attr("columnDefaultType"),d=u.attr("columnDefaultValue"),f=u.attr("columnDefaultText"),p=$("<div></div>");return p.append("<label>"+JBuild4DSelectView.SelectEnvVariable.formatText(r,f)+"</label>"),p.append("<label IsSerialize='true' BindName='columnDefaultType' Value='"+r+"' style='display:none'/>"),p.append("<label IsSerialize='true' BindName='columnDefaultText' Value='"+f+"' style='display:none'/>"),p.append("<label IsSerialize='true' BindName='columnDefaultValue' Value='"+d+"' style='display:none'/>"),p}return $("<label></label>")},ValidateToCompletedEnable:function(e,t,l,a,i,n){var u=n.val();return EditTableValidate.Validate(u,t)},setSelectEnvVariableResultValue:function(e){var t=window.$Temp$Inputtxt;null!=e?(t.attr("columnDefaultType",e.Type),t.attr("columnDefaultValue",e.Value),t.attr("columnDefaultText",e.Text),t.val(JBuild4DSelectView.SelectEnvVariable.formatText(e.Type,e.Text))):(t.attr("columnDefaultType",""),t.attr("columnDefaultValue",""),t.attr("columnDefaultText",""),t.val(""))}},Column_SelectFieldTypeDataLoader={_fieldDataTypeArray:null,GetFieldDataTypeArray:function(){if(null==this._fieldDataTypeArray){var l=this;AjaxUtility.PostSync("/Rest/Builder/DataStorage/DataBase/Table/GetTableFieldType",{},function(e){if(1==e.success){var t=JsonUtility.StringToJson(e.data);null!=t&&null!=t&&(l._fieldDataTypeArray=t)}else DialogUtility.Alert(window,"AlertLoadingQueryError",{},"加载字段类型失败！",null)},this)}return this._fieldDataTypeArray},GetFieldDataTypeObjectByValue:function(e){for(var t=this.GetFieldDataTypeArray(),l=0;l<t.length;l++){var a=t[l];if(a.Value==e)return a}alert("找不到指定的数据类型，请确认是否支持该类型！")},GetFieldDataTypeObjectByText:function(e){for(var t=this.GetFieldDataTypeArray(),l=0;l<t.length;l++){var a=t[l];if(a.Text==e)return a}alert("找不到指定的数据类型，请确认是否支持该类型！")}},Column_SelectFieldType={Get_EditStatus_HtmlElem:function(e,t,l,a,i,n,u,r){var d="",f=$("<select />");null!=r&&null!=r&&(d=r.columnDataTypeName),null!=n&&null!=n&&(d=n.attr("Value"));for(var p=Column_SelectFieldTypeDataLoader.GetFieldDataTypeArray(),o=0;o<p.length;o++){var c=p[o].Value,T=p[o].Text;f.append("<option value='"+c+"'>"+T+"</option>")}return""!=d?f.val(d):f.val(Column_SelectFieldTypeDataLoader.GetFieldDataTypeObjectByText("字符串").Value),f},Get_CompletedStatus_HtmlElem:function(e,t,l,a,i,n){var u=n.val(),r=Column_SelectFieldTypeDataLoader.GetFieldDataTypeObjectByValue(u).Text;return $("<label IsSerialize='true' BindName='"+t.BindName+"' Value='"+u+"'>"+r+"</label>")},ValidateToCompletedEnable:function(e,t,l,a,i,n){var u=n.val();return EditTableValidate.Validate(u,t)}};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJlbmRlcmVycy9UYWJsZURlc2lnbi9FZGl0VGFibGVfRmllbGROYW1lLmpzIiwiUmVuZGVyZXJzL1RhYmxlRGVzaWduL0VkaXRUYWJsZV9TZWxlY3REZWZhdWx0VmFsdWUuanMiLCJSZW5kZXJlcnMvVGFibGVEZXNpZ24vRWRpdFRhYmxlX1NlbGVjdEZpZWxkVHlwZS5qcyIsIlJlbmRlcmVycy9EYXRhU2V0L0NvbHVtbl9TZWxlY3REZWZhdWx0VmFsdWUuanMiLCJSZW5kZXJlcnMvRGF0YVNldC9Db2x1bW5fU2VsZWN0RmllbGRUeXBlLmpzIl0sIm5hbWVzIjpbIkVkaXRUYWJsZV9GaWVsZE5hbWUiLCJHZXRfRWRpdFN0YXR1c19IdG1sRWxlbSIsIl9jb25maWciLCJ0ZW1wbGF0ZSIsImhvc3RDZWxsIiwiaG9zdFJvdyIsImhvc3RUYWJsZSIsInZpZXdTdGF1c0h0bWxFbGVtIiwianNvbkRhdGFzIiwianNvbkRhdGFTaW5nbGUiLCJ2YWwiLCJiaW5kbmFtZSIsIkJpbmROYW1lIiwidW5kZWZpbmVkIiwiRGVmYXVsdFZhbHVlIiwiRWRpdFRhYmxlRGVmYXVsZVZhbHVlIiwiR2V0VmFsdWUiLCJodG1sIiwiJGVsZW0iLCIkIiwiYXR0ciIsIkdldF9Db21wbGV0ZWRTdGF0dXNfSHRtbEVsZW0iLCJlZGl0U3RhdXNIdG1sRWxlbSIsInRvVXBwZXJDYXNlIiwiVmFsaWRhdGVUb0NvbXBsZXRlZEVuYWJsZSIsInJlc3VsdCIsIkVkaXRUYWJsZVZhbGlkYXRlIiwiVmFsaWRhdGUiLCJTdWNjZXNzIiwiZmluZCIsImVhY2giLCJ0aGlzIiwibGFiZWxpdGVtIiwidGV4dCIsIk1zZyIsIkVkaXRUYWJsZV9TZWxlY3REZWZhdWx0VmFsdWUiLCJmaWVsZERlZmF1bHRUeXBlIiwiZmllbGREZWZhdWx0VmFsdWUiLCJmaWVsZERlZmF1bHRUZXh0IiwiJGlucHV0VHh0IiwiSkJ1aWxkNERTZWxlY3RWaWV3IiwiU2VsZWN0RW52VmFyaWFibGUiLCJmb3JtYXRUZXh0IiwiJGlucHV0QnRuIiwiYXBwZW5kIiwid2luZG93IiwiJFRlbXAkSW5wdXR0eHQiLCJjbGljayIsInRhYmxlRGVzaW9uIiwic2VsZWN0RGVmYXVsdFZhbHVlRGlhbG9nQmVnaW4iLCJwYXJlbnQiLCJsaXN0RGVzaWduIiwiX1NlbGVjdEJpbmRPYmoiLCJzZXRTZWxlY3RFbnZWYXJpYWJsZVJlc3VsdFZhbHVlIiwibGVuZ3RoIiwiZGVmYXVsdFR5cGUiLCJkZWZhdWx0VmFsdWUiLCJkZWZhdWx0VGV4dCIsImRlZmF1bHREYXRhIiwiVHlwZSIsIlZhbHVlIiwiVGV4dCIsIkVkaXRUYWJsZV9TZWxlY3RGaWVsZFR5cGVEYXRhTG9hZGVyIiwiX2ZpZWxkRGF0YVR5cGVBcnJheSIsIkdldEZpZWxkRGF0YVR5cGVBcnJheSIsIl9zZWxmIiwiQWpheFV0aWxpdHkiLCJQb3N0U3luYyIsImRhdGEiLCJzdWNjZXNzIiwibGlzdCIsIkpzb25VdGlsaXR5IiwiU3RyaW5nVG9Kc29uIiwiRGlhbG9nVXRpbGl0eSIsIkFsZXJ0IiwiR2V0RmllbGREYXRhVHlwZU9iamVjdEJ5VmFsdWUiLCJhcnJheURhdGEiLCJpIiwib2JqIiwiYWxlcnQiLCJHZXRGaWVsZERhdGFUeXBlT2JqZWN0QnlUZXh0IiwiRWRpdFRhYmxlX1NlbGVjdEZpZWxkVHlwZSIsInZhbHVlIiwiY2hhbmdlIiwibmV4dCIsIkNvbHVtbl9TZWxlY3REZWZhdWx0VmFsdWUiLCJiZWdpblNlbGVjdCIsIkNvbHVtbl9TZWxlY3RGaWVsZFR5cGVEYXRhTG9hZGVyIiwiQ29sdW1uX1NlbGVjdEZpZWxkVHlwZSJdLCJtYXBwaW5ncyI6IkFBQUEsYUFFQSxJQUFBQSxvQkFBQSxDQUNBQyx3QkFBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBLElBQUFDLEVBQUEsR0FDQUMsRUFBQVIsRUFBQVMsU0FFQSxHQUFBQyxNQUFBVixFQUFBVyxjQUFBLE1BQUFYLEVBQUFXLGFBQ0FKLEVBQUFLLHNCQUFBQyxTQUFBYixHQUdBLE1B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QSxJQUFBSyxFQUFBbkIsRUFBQWMsR0FBQWpCLE1BQ0EzQixFQUFBOEIsRUFBQWMsR0FBQWhCLEtBQ0EzQyxFQUFBMEIsT0FBQSxrQkFBQXNDLEVBQUEsS0FBQWpELEVBQUEsYUFTQSxNQU5BLElBQUF2QixFQUNBUSxFQUFBUixJQUFBQSxHQUVBUSxFQUFBUixJQUFBNkUsaUNBQUFQLDZCQUFBLE9BQUFwQixPQUdBMUMsR0FFQUcsNkJBQUEsU0FBQW5CLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFnQixHQUNBLElBQUE0RCxFQUFBNUQsRUFBQVosTUFDQXVCLEVBQUFzRCxpQ0FBQVosOEJBQUFPLEdBQUFyQixLQUVBLE9BREExQyxFQUFBLHVDQUFBaEIsRUFBQVMsU0FBQSxZQUFBc0UsRUFBQSxLQUFBakQsRUFBQSxhQUdBVCwwQkFBQSxTQUFBdEIsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQWdCLEdBQ0EsSUFBQVosRUFBQVksRUFBQVosTUFDQSxPQUFBZ0Isa0JBQUFDLFNBQUFqQixFQUFBUCIsImZpbGUiOiJVSUVYQ29tcG9uZW50Rm9yQnVpbGRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG52YXIgRWRpdFRhYmxlX0ZpZWxkTmFtZSA9IHtcbiAgR2V0X0VkaXRTdGF0dXNfSHRtbEVsZW06IGZ1bmN0aW9uIEdldF9FZGl0U3RhdHVzX0h0bWxFbGVtKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCB2aWV3U3RhdXNIdG1sRWxlbSwganNvbkRhdGFzLCBqc29uRGF0YVNpbmdsZSkge1xuICAgIHZhciB2YWwgPSBcIlwiO1xuICAgIHZhciBiaW5kbmFtZSA9IHRlbXBsYXRlLkJpbmROYW1lO1xuXG4gICAgaWYgKHRlbXBsYXRlLkRlZmF1bHRWYWx1ZSAhPSB1bmRlZmluZWQgJiYgdGVtcGxhdGUuRGVmYXVsdFZhbHVlICE9IG51bGwpIHtcbiAgICAgIHZhciB2YWwgPSBFZGl0VGFibGVEZWZhdWxlVmFsdWUuR2V0VmFsdWUodGVtcGxhdGUpO1xuICAgIH1cblxuICAgIGlmIChqc29uRGF0YVNpbmdsZSAhPSBudWxsICYmIGpzb25EYXRhU2luZ2xlICE9IHVuZGVmaW5lZCkge1xuICAgICAgdmFsID0ganNvbkRhdGFTaW5nbGVbYmluZG5hbWVdO1xuICAgIH1cblxuICAgIGlmICh2aWV3U3RhdXNIdG1sRWxlbSAhPSBudWxsICYmIHZpZXdTdGF1c0h0bWxFbGVtICE9IHVuZGVmaW5lZCkge1xuICAgICAgdmFsID0gdmlld1N0YXVzSHRtbEVsZW0uaHRtbCgpO1xuICAgIH1cblxuICAgIHZhciAkZWxlbSA9ICQoXCI8aW5wdXQgdHlwZT0ndGV4dCcgc3R5bGU9J3dpZHRoOiA5OCUnIC8+XCIpO1xuICAgICRlbGVtLnZhbCh2YWwpO1xuICAgICRlbGVtLmF0dHIoXCJCaW5kTmFtZVwiLCB0ZW1wbGF0ZS5CaW5kTmFtZSk7XG4gICAgJGVsZW0uYXR0cihcIlZhbFwiLCB2YWwpO1xuICAgICRlbGVtLmF0dHIoXCJJc1NlcmlhbGl6ZVwiLCBcInRydWVcIik7XG4gICAgcmV0dXJuICRlbGVtO1xuICB9LFxuICBHZXRfQ29tcGxldGVkU3RhdHVzX0h0bWxFbGVtOiBmdW5jdGlvbiBHZXRfQ29tcGxldGVkU3RhdHVzX0h0bWxFbGVtKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCBlZGl0U3RhdXNIdG1sRWxlbSkge1xuICAgIHZhciB2YWwgPSBlZGl0U3RhdXNIdG1sRWxlbS52YWwoKS50b1VwcGVyQ2FzZSgpO1xuICAgIHZhciAkZWxlbSA9ICQoXCI8bGFiZWwgSXNTZXJpYWxpemU9J3RydWUnIEJpbmROYW1lPSdcIiArIHRlbXBsYXRlLkJpbmROYW1lICsgXCInIFZhbHVlPSdcIiArIHZhbCArIFwiJz5cIiArIHZhbCArIFwiPC9sYWJlbD5cIik7XG4gICAgcmV0dXJuICRlbGVtO1xuICB9LFxuICBWYWxpZGF0ZVRvQ29tcGxldGVkRW5hYmxlOiBmdW5jdGlvbiBWYWxpZGF0ZVRvQ29tcGxldGVkRW5hYmxlKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCBlZGl0U3RhdXNIdG1sRWxlbSkge1xuICAgIHZhciB2YWwgPSBlZGl0U3RhdXNIdG1sRWxlbS52YWwoKTtcbiAgICB2YXIgcmVzdWx0ID0gRWRpdFRhYmxlVmFsaWRhdGUuVmFsaWRhdGUodmFsLCB0ZW1wbGF0ZSk7XG5cbiAgICBpZiAocmVzdWx0LlN1Y2Nlc3MpIHtcbiAgICAgIGhvc3RUYWJsZS5maW5kKFwiW3JlbmRlcmVyPUVkaXRUYWJsZV9GaWVsZE5hbWVdXCIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VyaXRlbSA9ICQodGhpcyk7XG4gICAgICAgIHNlcml0ZW0uZmluZChcImxhYmVsXCIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBsYWJlbGl0ZW0gPSAkKHRoaXMpO1xuXG4gICAgICAgICAgaWYgKGxhYmVsaXRlbS50ZXh0KCkgPT0gdmFsIHx8IGxhYmVsaXRlbS50ZXh0KCkgPT0gdmFsLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgU3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgIE1zZzogXCJb5a2X5q615ZCN56ewXeS4jeiDvemHjeWkjSFcIlxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxufTsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIEVkaXRUYWJsZV9TZWxlY3REZWZhdWx0VmFsdWUgPSB7XG4gIEdldF9FZGl0U3RhdHVzX0h0bWxFbGVtOiBmdW5jdGlvbiBHZXRfRWRpdFN0YXR1c19IdG1sRWxlbShfY29uZmlnLCB0ZW1wbGF0ZSwgaG9zdENlbGwsIGhvc3RSb3csIGhvc3RUYWJsZSwgdmlld1N0YXVzSHRtbEVsZW0sIGpzb25EYXRhcywganNvbkRhdGFTaW5nbGUpIHtcbiAgICB2YXIgZmllbGREZWZhdWx0VHlwZSA9IFwiXCI7XG4gICAgdmFyIGZpZWxkRGVmYXVsdFZhbHVlID0gXCJcIjtcbiAgICB2YXIgZmllbGREZWZhdWx0VGV4dCA9IFwiXCI7XG5cbiAgICBpZiAoanNvbkRhdGFTaW5nbGUgIT0gbnVsbCAmJiBqc29uRGF0YVNpbmdsZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgIGZpZWxkRGVmYXVsdFR5cGUgPSBqc29uRGF0YVNpbmdsZVtcImZpZWxkRGVmYXVsdFR5cGVcIl0gPyBqc29uRGF0YVNpbmdsZVtcImZpZWxkRGVmYXVsdFR5cGVcIl0gOiBcIlwiO1xuICAgICAgZmllbGREZWZhdWx0VmFsdWUgPSBqc29uRGF0YVNpbmdsZVtcImZpZWxkRGVmYXVsdFZhbHVlXCJdID8ganNvbkRhdGFTaW5nbGVbXCJmaWVsZERlZmF1bHRWYWx1ZVwiXSA6IFwiXCI7XG4gICAgICBmaWVsZERlZmF1bHRUZXh0ID0ganNvbkRhdGFTaW5nbGVbXCJmaWVsZERlZmF1bHRUZXh0XCJdID8ganNvbkRhdGFTaW5nbGVbXCJmaWVsZERlZmF1bHRUZXh0XCJdIDogXCJcIjtcbiAgICB9XG5cbiAgICBpZiAodmlld1N0YXVzSHRtbEVsZW0gIT0gbnVsbCAmJiB2aWV3U3RhdXNIdG1sRWxlbSAhPSB1bmRlZmluZWQpIHtcbiAgICAgIHZpZXdTdGF1c0h0bWxFbGVtLmZpbmQoXCJsYWJlbFwiKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCQodGhpcykuYXR0cihcIkJpbmROYW1lXCIpID09IFwiZmllbGREZWZhdWx0VHlwZVwiKSB7XG4gICAgICAgICAgZmllbGREZWZhdWx0VHlwZSA9ICQodGhpcykuYXR0cihcIlZhbHVlXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKCQodGhpcykuYXR0cihcIkJpbmROYW1lXCIpID09IFwiZmllbGREZWZhdWx0VGV4dFwiKSB7XG4gICAgICAgICAgZmllbGREZWZhdWx0VGV4dCA9ICQodGhpcykuYXR0cihcIlZhbHVlXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKCQodGhpcykuYXR0cihcIkJpbmROYW1lXCIpID09IFwiZmllbGREZWZhdWx0VmFsdWVcIikge1xuICAgICAgICAgIGZpZWxkRGVmYXVsdFZhbHVlID0gJCh0aGlzKS5hdHRyKFwiVmFsdWVcIik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHZhciAkZWxlbSA9ICQoXCI8ZGl2PjwvZGl2PlwiKTtcbiAgICB2YXIgJGlucHV0VHh0ID0gJChcIjxpbnB1dCB0eXBlPSd0ZXh0JyBzdHlsZT0nd2lkdGg6IDkwJScgcmVhZG9ubHkgLz5cIik7XG4gICAgJGlucHV0VHh0LmF0dHIoXCJmaWVsZERlZmF1bHRUeXBlXCIsIGZpZWxkRGVmYXVsdFR5cGUpO1xuICAgICRpbnB1dFR4dC5hdHRyKFwiZmllbGREZWZhdWx0VmFsdWVcIiwgZmllbGREZWZhdWx0VmFsdWUpO1xuICAgICRpbnB1dFR4dC5hdHRyKFwiZmllbGREZWZhdWx0VGV4dFwiLCBmaWVsZERlZmF1bHRUZXh0KTtcbiAgICAkaW5wdXRUeHQudmFsKEpCdWlsZDREU2VsZWN0Vmlldy5TZWxlY3RFbnZWYXJpYWJsZS5mb3JtYXRUZXh0KGZpZWxkRGVmYXVsdFR5cGUsIGZpZWxkRGVmYXVsdFRleHQpKTtcbiAgICB2YXIgJGlucHV0QnRuID0gJChcIjxpbnB1dCBjbGFzcz0nbm9ybWFsYnV0dG9uLXYxJyBzdHlsZT0nbWFyZ2luLWxlZnQ6IDRweDsnIHR5cGU9J2J1dHRvbicgdmFsdWU9Jy4uLicvPlwiKTtcbiAgICAkZWxlbS5hcHBlbmQoJGlucHV0VHh0KS5hcHBlbmQoJGlucHV0QnRuKTtcbiAgICB3aW5kb3cuJFRlbXAkSW5wdXR0eHQgPSAkaW5wdXRUeHQ7XG4gICAgJGlucHV0QnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh3aW5kb3cudGFibGVEZXNpb24pIHtcbiAgICAgICAgdGFibGVEZXNpb24uc2VsZWN0RGVmYXVsdFZhbHVlRGlhbG9nQmVnaW4oRWRpdFRhYmxlX1NlbGVjdERlZmF1bHRWYWx1ZSwgbnVsbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3aW5kb3cucGFyZW50Lmxpc3REZXNpZ24uc2VsZWN0RGVmYXVsdFZhbHVlRGlhbG9nQmVnaW4od2luZG93LCBudWxsKTtcbiAgICAgICAgd2luZG93Ll9TZWxlY3RCaW5kT2JqID0ge1xuICAgICAgICAgIHNldFNlbGVjdEVudlZhcmlhYmxlUmVzdWx0VmFsdWU6IGZ1bmN0aW9uIHNldFNlbGVjdEVudlZhcmlhYmxlUmVzdWx0VmFsdWUocmVzdWx0KSB7XG4gICAgICAgICAgICBFZGl0VGFibGVfU2VsZWN0RGVmYXVsdFZhbHVlLnNldFNlbGVjdEVudlZhcmlhYmxlUmVzdWx0VmFsdWUocmVzdWx0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuICRlbGVtO1xuICB9LFxuICBHZXRfQ29tcGxldGVkU3RhdHVzX0h0bWxFbGVtOiBmdW5jdGlvbiBHZXRfQ29tcGxldGVkU3RhdHVzX0h0bWxFbGVtKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCBlZGl0U3RhdXNIdG1sRWxlbSkge1xuICAgIHZhciAkaW5wdXRUeHQgPSBlZGl0U3RhdXNIdG1sRWxlbS5maW5kKFwiaW5wdXRbdHlwZT0ndGV4dCddXCIpO1xuXG4gICAgaWYgKCRpbnB1dFR4dC5sZW5ndGggPiAwKSB7XG4gICAgICB2YXIgZGVmYXVsdFR5cGUgPSAkaW5wdXRUeHQuYXR0cihcImZpZWxkRGVmYXVsdFR5cGVcIik7XG4gICAgICB2YXIgZGVmYXVsdFZhbHVlID0gJGlucHV0VHh0LmF0dHIoXCJmaWVsZERlZmF1bHRWYWx1ZVwiKTtcbiAgICAgIHZhciBkZWZhdWx0VGV4dCA9ICRpbnB1dFR4dC5hdHRyKFwiZmllbGREZWZhdWx0VGV4dFwiKTtcbiAgICAgIHZhciAkZWxlbSA9ICQoXCI8ZGl2PjwvZGl2PlwiKTtcbiAgICAgICRlbGVtLmFwcGVuZChcIjxsYWJlbD5cIiArIEpCdWlsZDREU2VsZWN0Vmlldy5TZWxlY3RFbnZWYXJpYWJsZS5mb3JtYXRUZXh0KGRlZmF1bHRUeXBlLCBkZWZhdWx0VGV4dCkgKyBcIjwvbGFiZWw+XCIpO1xuICAgICAgJGVsZW0uYXBwZW5kKFwiPGxhYmVsIElzU2VyaWFsaXplPSd0cnVlJyBCaW5kTmFtZT0nZmllbGREZWZhdWx0VHlwZScgVmFsdWU9J1wiICsgZGVmYXVsdFR5cGUgKyBcIicgc3R5bGU9J2Rpc3BsYXk6bm9uZScvPlwiKTtcbiAgICAgICRlbGVtLmFwcGVuZChcIjxsYWJlbCBJc1NlcmlhbGl6ZT0ndHJ1ZScgQmluZE5hbWU9J2ZpZWxkRGVmYXVsdFRleHQnIFZhbHVlPSdcIiArIGRlZmF1bHRUZXh0ICsgXCInIHN0eWxlPSdkaXNwbGF5Om5vbmUnLz5cIik7XG4gICAgICAkZWxlbS5hcHBlbmQoXCI8bGFiZWwgSXNTZXJpYWxpemU9J3RydWUnIEJpbmROYW1lPSdmaWVsZERlZmF1bHRWYWx1ZScgVmFsdWU9J1wiICsgZGVmYXVsdFZhbHVlICsgXCInIHN0eWxlPSdkaXNwbGF5Om5vbmUnLz5cIik7XG4gICAgICByZXR1cm4gJGVsZW07XG4gICAgfVxuXG4gICAgcmV0dXJuICQoXCI8bGFiZWw+PC9sYWJlbD5cIik7XG4gIH0sXG4gIFZhbGlkYXRlVG9Db21wbGV0ZWRFbmFibGU6IGZ1bmN0aW9uIFZhbGlkYXRlVG9Db21wbGV0ZWRFbmFibGUoX2NvbmZpZywgdGVtcGxhdGUsIGhvc3RDZWxsLCBob3N0Um93LCBob3N0VGFibGUsIGVkaXRTdGF1c0h0bWxFbGVtKSB7XG4gICAgdmFyIHZhbCA9IGVkaXRTdGF1c0h0bWxFbGVtLnZhbCgpO1xuICAgIHJldHVybiBFZGl0VGFibGVWYWxpZGF0ZS5WYWxpZGF0ZSh2YWwsIHRlbXBsYXRlKTtcbiAgfSxcbiAgc2V0U2VsZWN0RW52VmFyaWFibGVSZXN1bHRWYWx1ZTogZnVuY3Rpb24gc2V0U2VsZWN0RW52VmFyaWFibGVSZXN1bHRWYWx1ZShkZWZhdWx0RGF0YSkge1xuICAgIHZhciAkaW5wdXRUeHQgPSB3aW5kb3cuJFRlbXAkSW5wdXR0eHQ7XG5cbiAgICBpZiAobnVsbCAhPSBkZWZhdWx0RGF0YSkge1xuICAgICAgJGlucHV0VHh0LmF0dHIoXCJmaWVsZERlZmF1bHRUeXBlXCIsIGRlZmF1bHREYXRhLlR5cGUpO1xuICAgICAgJGlucHV0VHh0LmF0dHIoXCJmaWVsZERlZmF1bHRWYWx1ZVwiLCBkZWZhdWx0RGF0YS5WYWx1ZSk7XG4gICAgICAkaW5wdXRUeHQuYXR0cihcImZpZWxkRGVmYXVsdFRleHRcIiwgZGVmYXVsdERhdGEuVGV4dCk7XG4gICAgICAkaW5wdXRUeHQudmFsKEpCdWlsZDREU2VsZWN0Vmlldy5TZWxlY3RFbnZWYXJpYWJsZS5mb3JtYXRUZXh0KGRlZmF1bHREYXRhLlR5cGUsIGRlZmF1bHREYXRhLlRleHQpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGlucHV0VHh0LmF0dHIoXCJmaWVsZERlZmF1bHRUeXBlXCIsIFwiXCIpO1xuICAgICAgJGlucHV0VHh0LmF0dHIoXCJmaWVsZERlZmF1bHRWYWx1ZVwiLCBcIlwiKTtcbiAgICAgICRpbnB1dFR4dC5hdHRyKFwiZmllbGREZWZhdWx0VGV4dFwiLCBcIlwiKTtcbiAgICAgICRpbnB1dFR4dC52YWwoXCJcIik7XG4gICAgfVxuICB9XG59OyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgRWRpdFRhYmxlX1NlbGVjdEZpZWxkVHlwZURhdGFMb2FkZXIgPSB7XG4gIF9maWVsZERhdGFUeXBlQXJyYXk6IG51bGwsXG4gIEdldEZpZWxkRGF0YVR5cGVBcnJheTogZnVuY3Rpb24gR2V0RmllbGREYXRhVHlwZUFycmF5KCkge1xuICAgIGlmICh0aGlzLl9maWVsZERhdGFUeXBlQXJyYXkgPT0gbnVsbCkge1xuICAgICAgdmFyIF9zZWxmID0gdGhpcztcblxuICAgICAgQWpheFV0aWxpdHkuUG9zdFN5bmMoXCIvUmVzdC9CdWlsZGVyL0RhdGFTdG9yYWdlL0RhdGFCYXNlL1RhYmxlL0dldFRhYmxlRmllbGRUeXBlXCIsIHt9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBpZiAoZGF0YS5zdWNjZXNzID09IHRydWUpIHtcbiAgICAgICAgICB2YXIgbGlzdCA9IEpzb25VdGlsaXR5LlN0cmluZ1RvSnNvbihkYXRhLmRhdGEpO1xuXG4gICAgICAgICAgaWYgKGxpc3QgIT0gbnVsbCAmJiBsaXN0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgX3NlbGYuX2ZpZWxkRGF0YVR5cGVBcnJheSA9IGxpc3Q7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIERpYWxvZ1V0aWxpdHkuQWxlcnQod2luZG93LCBcIkFsZXJ0TG9hZGluZ1F1ZXJ5RXJyb3JcIiwge30sIFwi5Yqg6L295a2X5q6157G75Z6L5aSx6LSl77yBXCIsIG51bGwpO1xuICAgICAgICB9XG4gICAgICB9LCB0aGlzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fZmllbGREYXRhVHlwZUFycmF5O1xuICB9LFxuICBHZXRGaWVsZERhdGFUeXBlT2JqZWN0QnlWYWx1ZTogZnVuY3Rpb24gR2V0RmllbGREYXRhVHlwZU9iamVjdEJ5VmFsdWUoVmFsdWUpIHtcbiAgICB2YXIgYXJyYXlEYXRhID0gdGhpcy5HZXRGaWVsZERhdGFUeXBlQXJyYXkoKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXlEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgb2JqID0gYXJyYXlEYXRhW2ldO1xuXG4gICAgICBpZiAob2JqLlZhbHVlID09IFZhbHVlKSB7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9XG4gICAgfVxuXG4gICAgYWxlcnQoXCLmib7kuI3liLDmjIflrprnmoTmlbDmja7nsbvlnovvvIzor7fnoa7orqTmmK/lkKbmlK/mjIHor6XnsbvlnovvvIFcIik7XG4gIH0sXG4gIEdldEZpZWxkRGF0YVR5cGVPYmplY3RCeVRleHQ6IGZ1bmN0aW9uIEdldEZpZWxkRGF0YVR5cGVPYmplY3RCeVRleHQodGV4dCkge1xuICAgIHZhciBhcnJheURhdGEgPSB0aGlzLkdldEZpZWxkRGF0YVR5cGVBcnJheSgpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBvYmogPSBhcnJheURhdGFbaV07XG5cbiAgICAgIGlmIChvYmouVGV4dCA9PSB0ZXh0KSB7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9XG4gICAgfVxuXG4gICAgYWxlcnQoXCLmib7kuI3liLDmjIflrprnmoTmlbDmja7nsbvlnovvvIzor7fnoa7orqTmmK/lkKbmlK/mjIHor6XnsbvlnovvvIFcIik7XG4gIH1cbn07XG52YXIgRWRpdFRhYmxlX1NlbGVjdEZpZWxkVHlwZSA9IHtcbiAgR2V0X0VkaXRTdGF0dXNfSHRtbEVsZW06IGZ1bmN0aW9uIEdldF9FZGl0U3RhdHVzX0h0bWxFbGVtKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCB2aWV3U3RhdXNIdG1sRWxlbSwganNvbkRhdGFzLCBqc29uRGF0YVNpbmdsZSkge1xuICAgIHZhciB2YWwgPSBcIlwiO1xuICAgIHZhciAkZWxlbSA9ICQoXCI8c2VsZWN0IC8+XCIpO1xuXG4gICAgaWYgKGpzb25EYXRhU2luZ2xlICE9IG51bGwgJiYganNvbkRhdGFTaW5nbGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICB2YWwgPSBqc29uRGF0YVNpbmdsZVtcImZpZWxkRGF0YVR5cGVcIl07XG4gICAgfVxuXG4gICAgaWYgKHZpZXdTdGF1c0h0bWxFbGVtICE9IG51bGwgJiYgdmlld1N0YXVzSHRtbEVsZW0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICB2YWwgPSB2aWV3U3RhdXNIdG1sRWxlbS5hdHRyKFwiVmFsdWVcIik7XG4gICAgfVxuXG4gICAgdmFyIF9maWVsZERhdGFUeXBlQXJyYXkgPSBFZGl0VGFibGVfU2VsZWN0RmllbGRUeXBlRGF0YUxvYWRlci5HZXRGaWVsZERhdGFUeXBlQXJyYXkoKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgX2ZpZWxkRGF0YVR5cGVBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHZhbHVlID0gX2ZpZWxkRGF0YVR5cGVBcnJheVtpXS5WYWx1ZTtcbiAgICAgIHZhciB0ZXh0ID0gX2ZpZWxkRGF0YVR5cGVBcnJheVtpXS5UZXh0O1xuICAgICAgJGVsZW0uYXBwZW5kKFwiPG9wdGlvbiB2YWx1ZT0nXCIgKyB2YWx1ZSArIFwiJz5cIiArIHRleHQgKyBcIjwvb3B0aW9uPlwiKTtcbiAgICB9XG5cbiAgICBpZiAodmFsICE9IFwiXCIpIHtcbiAgICAgICRlbGVtLnZhbCh2YWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkZWxlbS52YWwoRWRpdFRhYmxlX1NlbGVjdEZpZWxkVHlwZURhdGFMb2FkZXIuR2V0RmllbGREYXRhVHlwZU9iamVjdEJ5VGV4dChcIuWtl+espuS4slwiKS5WYWx1ZSk7XG4gICAgfVxuXG4gICAgJGVsZW0uY2hhbmdlKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB2YWwgPSAkKHRoaXMpLnZhbCgpO1xuXG4gICAgICBpZiAodmFsID09IFwi5pW05pWwXCIpIHtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5maW5kKFwiaW5wdXRcIikudmFsKDApO1xuICAgICAgICAkKGhvc3RDZWxsKS5uZXh0KCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5uZXh0KCkuZmluZChcImlucHV0XCIpLnZhbCgwKTtcbiAgICAgIH0gZWxzZSBpZiAodmFsID09IFwi5bCP5pWwXCIpIHtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgZmFsc2UpO1xuICAgICAgICAkKGhvc3RDZWxsKS5uZXh0KCkuZmluZChcImlucHV0XCIpLnZhbCgxMCk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5uZXh0KCkuZmluZChcImlucHV0XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBmYWxzZSk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5uZXh0KCkuZmluZChcImlucHV0XCIpLnZhbCgyKTtcbiAgICAgIH0gZWxzZSBpZiAodmFsID09IFwi5pel5pyf5pe26Ze0XCIpIHtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5maW5kKFwiaW5wdXRcIikudmFsKDIwKTtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLm5leHQoKS5maW5kKFwiaW5wdXRcIikuYXR0cihcImRpc2FibGVkXCIsIHRydWUpO1xuICAgICAgICAkKGhvc3RDZWxsKS5uZXh0KCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS52YWwoMCk7XG4gICAgICB9IGVsc2UgaWYgKHZhbCA9PSBcIuWtl+espuS4slwiKSB7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5maW5kKFwiaW5wdXRcIikuYXR0cihcImRpc2FibGVkXCIsIGZhbHNlKTtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS52YWwoNTApO1xuICAgICAgICAkKGhvc3RDZWxsKS5uZXh0KCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5uZXh0KCkuZmluZChcImlucHV0XCIpLnZhbCgwKTtcbiAgICAgIH0gZWxzZSBpZiAodmFsID09IFwi6ZW/5a2X56ym5LiyXCIpIHtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5maW5kKFwiaW5wdXRcIikudmFsKDApO1xuICAgICAgICAkKGhvc3RDZWxsKS5uZXh0KCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5uZXh0KCkuZmluZChcImlucHV0XCIpLnZhbCgwKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gJGVsZW07XG4gIH0sXG4gIEdldF9Db21wbGV0ZWRTdGF0dXNfSHRtbEVsZW06IGZ1bmN0aW9uIEdldF9Db21wbGV0ZWRTdGF0dXNfSHRtbEVsZW0oX2NvbmZpZywgdGVtcGxhdGUsIGhvc3RDZWxsLCBob3N0Um93LCBob3N0VGFibGUsIGVkaXRTdGF1c0h0bWxFbGVtKSB7XG4gICAgdmFyIHZhbHVlID0gZWRpdFN0YXVzSHRtbEVsZW0udmFsKCk7XG4gICAgdmFyIHRleHQgPSBFZGl0VGFibGVfU2VsZWN0RmllbGRUeXBlRGF0YUxvYWRlci5HZXRGaWVsZERhdGFUeXBlT2JqZWN0QnlWYWx1ZSh2YWx1ZSkuVGV4dDtcbiAgICB2YXIgJGVsZW0gPSAkKFwiPGxhYmVsIElzU2VyaWFsaXplPSd0cnVlJyBCaW5kTmFtZT0nXCIgKyB0ZW1wbGF0ZS5CaW5kTmFtZSArIFwiJyBWYWx1ZT0nXCIgKyB2YWx1ZSArIFwiJz5cIiArIHRleHQgKyBcIjwvbGFiZWw+XCIpO1xuICAgIHJldHVybiAkZWxlbTtcbiAgfSxcbiAgVmFsaWRhdGVUb0NvbXBsZXRlZEVuYWJsZTogZnVuY3Rpb24gVmFsaWRhdGVUb0NvbXBsZXRlZEVuYWJsZShfY29uZmlnLCB0ZW1wbGF0ZSwgaG9zdENlbGwsIGhvc3RSb3csIGhvc3RUYWJsZSwgZWRpdFN0YXVzSHRtbEVsZW0pIHtcbiAgICB2YXIgdmFsID0gZWRpdFN0YXVzSHRtbEVsZW0udmFsKCk7XG4gICAgcmV0dXJuIEVkaXRUYWJsZVZhbGlkYXRlLlZhbGlkYXRlKHZhbCwgdGVtcGxhdGUpO1xuICB9XG59OyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgQ29sdW1uX1NlbGVjdERlZmF1bHRWYWx1ZSA9IHtcbiAgR2V0X0VkaXRTdGF0dXNfSHRtbEVsZW06IGZ1bmN0aW9uIEdldF9FZGl0U3RhdHVzX0h0bWxFbGVtKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCB2aWV3U3RhdXNIdG1sRWxlbSwganNvbkRhdGFzLCBqc29uRGF0YVNpbmdsZSkge1xuICAgIHZhciBkZWZhdWx0VHlwZSA9IFwiXCI7XG4gICAgdmFyIGRlZmF1bHRWYWx1ZSA9IFwiXCI7XG4gICAgdmFyIGRlZmF1bHRUZXh0ID0gXCJcIjtcblxuICAgIGlmIChqc29uRGF0YVNpbmdsZSAhPSBudWxsICYmIGpzb25EYXRhU2luZ2xlICE9IHVuZGVmaW5lZCkge1xuICAgICAgZGVmYXVsdFR5cGUgPSBqc29uRGF0YVNpbmdsZVtcImNvbHVtbkRlZmF1bHRUeXBlXCJdID8ganNvbkRhdGFTaW5nbGVbXCJjb2x1bW5EZWZhdWx0VHlwZVwiXSA6IFwiXCI7XG4gICAgICBkZWZhdWx0VmFsdWUgPSBqc29uRGF0YVNpbmdsZVtcImNvbHVtbkRlZmF1bHRWYWx1ZVwiXSA/IGpzb25EYXRhU2luZ2xlW1wiY29sdW1uRGVmYXVsdFZhbHVlXCJdIDogXCJcIjtcbiAgICAgIGRlZmF1bHRUZXh0ID0ganNvbkRhdGFTaW5nbGVbXCJjb2x1bW5EZWZhdWx0VGV4dFwiXSA/IGpzb25EYXRhU2luZ2xlW1wiY29sdW1uRGVmYXVsdFRleHRcIl0gOiBcIlwiO1xuICAgIH1cblxuICAgIGlmICh2aWV3U3RhdXNIdG1sRWxlbSAhPSBudWxsICYmIHZpZXdTdGF1c0h0bWxFbGVtICE9IHVuZGVmaW5lZCkge1xuICAgICAgdmlld1N0YXVzSHRtbEVsZW0uZmluZChcImxhYmVsXCIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKFwiQmluZE5hbWVcIikgPT0gXCJjb2x1bW5EZWZhdWx0VHlwZVwiKSB7XG4gICAgICAgICAgZGVmYXVsdFR5cGUgPSAkKHRoaXMpLmF0dHIoXCJWYWx1ZVwiKTtcbiAgICAgICAgfSBlbHNlIGlmICgkKHRoaXMpLmF0dHIoXCJCaW5kTmFtZVwiKSA9PSBcImNvbHVtbkRlZmF1bHRUZXh0XCIpIHtcbiAgICAgICAgICBkZWZhdWx0VGV4dCA9ICQodGhpcykuYXR0cihcIlZhbHVlXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKCQodGhpcykuYXR0cihcIkJpbmROYW1lXCIpID09IFwiY29sdW1uRGVmYXVsdFZhbHVlXCIpIHtcbiAgICAgICAgICBkZWZhdWx0VmFsdWUgPSAkKHRoaXMpLmF0dHIoXCJWYWx1ZVwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmFyICRlbGVtID0gJChcIjxkaXY+PC9kaXY+XCIpO1xuICAgIHZhciAkaW5wdXRUeHQgPSAkKFwiPGlucHV0IHR5cGU9J3RleHQnIHN0eWxlPSd3aWR0aDogOTAlJyByZWFkb25seSAvPlwiKTtcbiAgICAkaW5wdXRUeHQuYXR0cihcImNvbHVtbkRlZmF1bHRUeXBlXCIsIGRlZmF1bHRUeXBlKTtcbiAgICAkaW5wdXRUeHQuYXR0cihcImNvbHVtbkRlZmF1bHRWYWx1ZVwiLCBkZWZhdWx0VmFsdWUpO1xuICAgICRpbnB1dFR4dC5hdHRyKFwiY29sdW1uRGVmYXVsdFRleHRcIiwgZGVmYXVsdFRleHQpO1xuICAgICRpbnB1dFR4dC52YWwoSkJ1aWxkNERTZWxlY3RWaWV3LlNlbGVjdEVudlZhcmlhYmxlLmZvcm1hdFRleHQoZGVmYXVsdFR5cGUsIGRlZmF1bHRUZXh0KSk7XG4gICAgdmFyICRpbnB1dEJ0biA9ICQoXCI8aW5wdXQgY2xhc3M9J25vcm1hbGJ1dHRvbi12MScgc3R5bGU9J21hcmdpbi1sZWZ0OiA0cHg7JyB0eXBlPSdidXR0b24nIHZhbHVlPScuLi4nLz5cIik7XG4gICAgJGVsZW0uYXBwZW5kKCRpbnB1dFR4dCkuYXBwZW5kKCRpbnB1dEJ0bik7XG4gICAgd2luZG93LiRUZW1wJElucHV0dHh0ID0gJGlucHV0VHh0O1xuICAgICRpbnB1dEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICBKQnVpbGQ0RFNlbGVjdFZpZXcuU2VsZWN0RW52VmFyaWFibGUuYmVnaW5TZWxlY3QoXCJDb2x1bW5fU2VsZWN0RGVmYXVsdFZhbHVlXCIpO1xuICAgIH0pO1xuICAgIHJldHVybiAkZWxlbTtcbiAgfSxcbiAgR2V0X0NvbXBsZXRlZFN0YXR1c19IdG1sRWxlbTogZnVuY3Rpb24gR2V0X0NvbXBsZXRlZFN0YXR1c19IdG1sRWxlbShfY29uZmlnLCB0ZW1wbGF0ZSwgaG9zdENlbGwsIGhvc3RSb3csIGhvc3RUYWJsZSwgZWRpdFN0YXVzSHRtbEVsZW0pIHtcbiAgICB2YXIgJGlucHV0VHh0ID0gZWRpdFN0YXVzSHRtbEVsZW0uZmluZChcImlucHV0W3R5cGU9J3RleHQnXVwiKTtcblxuICAgIGlmICgkaW5wdXRUeHQubGVuZ3RoID4gMCkge1xuICAgICAgdmFyIGRlZmF1bHRUeXBlID0gJGlucHV0VHh0LmF0dHIoXCJjb2x1bW5EZWZhdWx0VHlwZVwiKTtcbiAgICAgIHZhciBkZWZhdWx0VmFsdWUgPSAkaW5wdXRUeHQuYXR0cihcImNvbHVtbkRlZmF1bHRWYWx1ZVwiKTtcbiAgICAgIHZhciBkZWZhdWx0VGV4dCA9ICRpbnB1dFR4dC5hdHRyKFwiY29sdW1uRGVmYXVsdFRleHRcIik7XG4gICAgICB2YXIgJGVsZW0gPSAkKFwiPGRpdj48L2Rpdj5cIik7XG4gICAgICAkZWxlbS5hcHBlbmQoXCI8bGFiZWw+XCIgKyBKQnVpbGQ0RFNlbGVjdFZpZXcuU2VsZWN0RW52VmFyaWFibGUuZm9ybWF0VGV4dChkZWZhdWx0VHlwZSwgZGVmYXVsdFRleHQpICsgXCI8L2xhYmVsPlwiKTtcbiAgICAgICRlbGVtLmFwcGVuZChcIjxsYWJlbCBJc1NlcmlhbGl6ZT0ndHJ1ZScgQmluZE5hbWU9J2NvbHVtbkRlZmF1bHRUeXBlJyBWYWx1ZT0nXCIgKyBkZWZhdWx0VHlwZSArIFwiJyBzdHlsZT0nZGlzcGxheTpub25lJy8+XCIpO1xuICAgICAgJGVsZW0uYXBwZW5kKFwiPGxhYmVsIElzU2VyaWFsaXplPSd0cnVlJyBCaW5kTmFtZT0nY29sdW1uRGVmYXVsdFRleHQnIFZhbHVlPSdcIiArIGRlZmF1bHRUZXh0ICsgXCInIHN0eWxlPSdkaXNwbGF5Om5vbmUnLz5cIik7XG4gICAgICAkZWxlbS5hcHBlbmQoXCI8bGFiZWwgSXNTZXJpYWxpemU9J3RydWUnIEJpbmROYW1lPSdjb2x1bW5EZWZhdWx0VmFsdWUnIFZhbHVlPSdcIiArIGRlZmF1bHRWYWx1ZSArIFwiJyBzdHlsZT0nZGlzcGxheTpub25lJy8+XCIpO1xuICAgICAgcmV0dXJuICRlbGVtO1xuICAgIH1cblxuICAgIHJldHVybiAkKFwiPGxhYmVsPjwvbGFiZWw+XCIpO1xuICB9LFxuICBWYWxpZGF0ZVRvQ29tcGxldGVkRW5hYmxlOiBmdW5jdGlvbiBWYWxpZGF0ZVRvQ29tcGxldGVkRW5hYmxlKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCBlZGl0U3RhdXNIdG1sRWxlbSkge1xuICAgIHZhciB2YWwgPSBlZGl0U3RhdXNIdG1sRWxlbS52YWwoKTtcbiAgICByZXR1cm4gRWRpdFRhYmxlVmFsaWRhdGUuVmFsaWRhdGUodmFsLCB0ZW1wbGF0ZSk7XG4gIH0sXG4gIHNldFNlbGVjdEVudlZhcmlhYmxlUmVzdWx0VmFsdWU6IGZ1bmN0aW9uIHNldFNlbGVjdEVudlZhcmlhYmxlUmVzdWx0VmFsdWUoZGVmYXVsdERhdGEpIHtcbiAgICB2YXIgJGlucHV0VHh0ID0gd2luZG93LiRUZW1wJElucHV0dHh0O1xuXG4gICAgaWYgKG51bGwgIT0gZGVmYXVsdERhdGEpIHtcbiAgICAgICRpbnB1dFR4dC5hdHRyKFwiY29sdW1uRGVmYXVsdFR5cGVcIiwgZGVmYXVsdERhdGEuVHlwZSk7XG4gICAgICAkaW5wdXRUeHQuYXR0cihcImNvbHVtbkRlZmF1bHRWYWx1ZVwiLCBkZWZhdWx0RGF0YS5WYWx1ZSk7XG4gICAgICAkaW5wdXRUeHQuYXR0cihcImNvbHVtbkRlZmF1bHRUZXh0XCIsIGRlZmF1bHREYXRhLlRleHQpO1xuICAgICAgJGlucHV0VHh0LnZhbChKQnVpbGQ0RFNlbGVjdFZpZXcuU2VsZWN0RW52VmFyaWFibGUuZm9ybWF0VGV4dChkZWZhdWx0RGF0YS5UeXBlLCBkZWZhdWx0RGF0YS5UZXh0KSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICRpbnB1dFR4dC5hdHRyKFwiY29sdW1uRGVmYXVsdFR5cGVcIiwgXCJcIik7XG4gICAgICAkaW5wdXRUeHQuYXR0cihcImNvbHVtbkRlZmF1bHRWYWx1ZVwiLCBcIlwiKTtcbiAgICAgICRpbnB1dFR4dC5hdHRyKFwiY29sdW1uRGVmYXVsdFRleHRcIiwgXCJcIik7XG4gICAgICAkaW5wdXRUeHQudmFsKFwiXCIpO1xuICAgIH1cbiAgfVxufTsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIENvbHVtbl9TZWxlY3RGaWVsZFR5cGVEYXRhTG9hZGVyID0ge1xuICBfZmllbGREYXRhVHlwZUFycmF5OiBudWxsLFxuICBHZXRGaWVsZERhdGFUeXBlQXJyYXk6IGZ1bmN0aW9uIEdldEZpZWxkRGF0YVR5cGVBcnJheSgpIHtcbiAgICBpZiAodGhpcy5fZmllbGREYXRhVHlwZUFycmF5ID09IG51bGwpIHtcbiAgICAgIHZhciBfc2VsZiA9IHRoaXM7XG5cbiAgICAgIEFqYXhVdGlsaXR5LlBvc3RTeW5jKFwiL1Jlc3QvQnVpbGRlci9EYXRhU3RvcmFnZS9EYXRhQmFzZS9UYWJsZS9HZXRUYWJsZUZpZWxkVHlwZVwiLCB7fSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgaWYgKGRhdGEuc3VjY2VzcyA9PSB0cnVlKSB7XG4gICAgICAgICAgdmFyIGxpc3QgPSBKc29uVXRpbGl0eS5TdHJpbmdUb0pzb24oZGF0YS5kYXRhKTtcblxuICAgICAgICAgIGlmIChsaXN0ICE9IG51bGwgJiYgbGlzdCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIF9zZWxmLl9maWVsZERhdGFUeXBlQXJyYXkgPSBsaXN0O1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBEaWFsb2dVdGlsaXR5LkFsZXJ0KHdpbmRvdywgXCJBbGVydExvYWRpbmdRdWVyeUVycm9yXCIsIHt9LCBcIuWKoOi9veWtl+auteexu+Wei+Wksei0pe+8gVwiLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgfSwgdGhpcyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX2ZpZWxkRGF0YVR5cGVBcnJheTtcbiAgfSxcbiAgR2V0RmllbGREYXRhVHlwZU9iamVjdEJ5VmFsdWU6IGZ1bmN0aW9uIEdldEZpZWxkRGF0YVR5cGVPYmplY3RCeVZhbHVlKFZhbHVlKSB7XG4gICAgdmFyIGFycmF5RGF0YSA9IHRoaXMuR2V0RmllbGREYXRhVHlwZUFycmF5KCk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5RGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIG9iaiA9IGFycmF5RGF0YVtpXTtcblxuICAgICAgaWYgKG9iai5WYWx1ZSA9PSBWYWx1ZSkge1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfVxuICAgIH1cblxuICAgIGFsZXJ0KFwi5om+5LiN5Yiw5oyH5a6a55qE5pWw5o2u57G75Z6L77yM6K+356Gu6K6k5piv5ZCm5pSv5oyB6K+l57G75Z6L77yBXCIpO1xuICB9LFxuICBHZXRGaWVsZERhdGFUeXBlT2JqZWN0QnlUZXh0OiBmdW5jdGlvbiBHZXRGaWVsZERhdGFUeXBlT2JqZWN0QnlUZXh0KHRleHQpIHtcbiAgICB2YXIgYXJyYXlEYXRhID0gdGhpcy5HZXRGaWVsZERhdGFUeXBlQXJyYXkoKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXlEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgb2JqID0gYXJyYXlEYXRhW2ldO1xuXG4gICAgICBpZiAob2JqLlRleHQgPT0gdGV4dCkge1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgfVxuICAgIH1cblxuICAgIGFsZXJ0KFwi5om+5LiN5Yiw5oyH5a6a55qE5pWw5o2u57G75Z6L77yM6K+356Gu6K6k5piv5ZCm5pSv5oyB6K+l57G75Z6L77yBXCIpO1xuICB9XG59O1xudmFyIENvbHVtbl9TZWxlY3RGaWVsZFR5cGUgPSB7XG4gIEdldF9FZGl0U3RhdHVzX0h0bWxFbGVtOiBmdW5jdGlvbiBHZXRfRWRpdFN0YXR1c19IdG1sRWxlbShfY29uZmlnLCB0ZW1wbGF0ZSwgaG9zdENlbGwsIGhvc3RSb3csIGhvc3RUYWJsZSwgdmlld1N0YXVzSHRtbEVsZW0sIGpzb25EYXRhcywganNvbkRhdGFTaW5nbGUpIHtcbiAgICB2YXIgdmFsID0gXCJcIjtcbiAgICB2YXIgJGVsZW0gPSAkKFwiPHNlbGVjdCAvPlwiKTtcblxuICAgIGlmIChqc29uRGF0YVNpbmdsZSAhPSBudWxsICYmIGpzb25EYXRhU2luZ2xlICE9IHVuZGVmaW5lZCkge1xuICAgICAgdmFsID0ganNvbkRhdGFTaW5nbGVbXCJjb2x1bW5EYXRhVHlwZU5hbWVcIl07XG4gICAgfVxuXG4gICAgaWYgKHZpZXdTdGF1c0h0bWxFbGVtICE9IG51bGwgJiYgdmlld1N0YXVzSHRtbEVsZW0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICB2YWwgPSB2aWV3U3RhdXNIdG1sRWxlbS5hdHRyKFwiVmFsdWVcIik7XG4gICAgfVxuXG4gICAgdmFyIF9maWVsZERhdGFUeXBlQXJyYXkgPSBDb2x1bW5fU2VsZWN0RmllbGRUeXBlRGF0YUxvYWRlci5HZXRGaWVsZERhdGFUeXBlQXJyYXkoKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgX2ZpZWxkRGF0YVR5cGVBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHZhbHVlID0gX2ZpZWxkRGF0YVR5cGVBcnJheVtpXS5WYWx1ZTtcbiAgICAgIHZhciB0ZXh0ID0gX2ZpZWxkRGF0YVR5cGVBcnJheVtpXS5UZXh0O1xuICAgICAgJGVsZW0uYXBwZW5kKFwiPG9wdGlvbiB2YWx1ZT0nXCIgKyB2YWx1ZSArIFwiJz5cIiArIHRleHQgKyBcIjwvb3B0aW9uPlwiKTtcbiAgICB9XG5cbiAgICBpZiAodmFsICE9IFwiXCIpIHtcbiAgICAgICRlbGVtLnZhbCh2YWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkZWxlbS52YWwoQ29sdW1uX1NlbGVjdEZpZWxkVHlwZURhdGFMb2FkZXIuR2V0RmllbGREYXRhVHlwZU9iamVjdEJ5VGV4dChcIuWtl+espuS4slwiKS5WYWx1ZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuICRlbGVtO1xuICB9LFxuICBHZXRfQ29tcGxldGVkU3RhdHVzX0h0bWxFbGVtOiBmdW5jdGlvbiBHZXRfQ29tcGxldGVkU3RhdHVzX0h0bWxFbGVtKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCBlZGl0U3RhdXNIdG1sRWxlbSkge1xuICAgIHZhciB2YWx1ZSA9IGVkaXRTdGF1c0h0bWxFbGVtLnZhbCgpO1xuICAgIHZhciB0ZXh0ID0gQ29sdW1uX1NlbGVjdEZpZWxkVHlwZURhdGFMb2FkZXIuR2V0RmllbGREYXRhVHlwZU9iamVjdEJ5VmFsdWUodmFsdWUpLlRleHQ7XG4gICAgdmFyICRlbGVtID0gJChcIjxsYWJlbCBJc1NlcmlhbGl6ZT0ndHJ1ZScgQmluZE5hbWU9J1wiICsgdGVtcGxhdGUuQmluZE5hbWUgKyBcIicgVmFsdWU9J1wiICsgdmFsdWUgKyBcIic+XCIgKyB0ZXh0ICsgXCI8L2xhYmVsPlwiKTtcbiAgICByZXR1cm4gJGVsZW07XG4gIH0sXG4gIFZhbGlkYXRlVG9Db21wbGV0ZWRFbmFibGU6IGZ1bmN0aW9uIFZhbGlkYXRlVG9Db21wbGV0ZWRFbmFibGUoX2NvbmZpZywgdGVtcGxhdGUsIGhvc3RDZWxsLCBob3N0Um93LCBob3N0VGFibGUsIGVkaXRTdGF1c0h0bWxFbGVtKSB7XG4gICAgdmFyIHZhbCA9IGVkaXRTdGF1c0h0bWxFbGVtLnZhbCgpO1xuICAgIHJldHVybiBFZGl0VGFibGVWYWxpZGF0ZS5WYWxpZGF0ZSh2YWwsIHRlbXBsYXRlKTtcbiAgfVxufTsiXX0=
