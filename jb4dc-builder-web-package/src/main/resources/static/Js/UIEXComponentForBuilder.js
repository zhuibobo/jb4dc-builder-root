"use strict";var Column_SelectDefaultValue={Get_EditStatus_HtmlElem:function(e,t,l,a,i,n,u,r){var d="",f="",p="";null!=r&&null!=r&&(d=r.columnDefaultType?r.columnDefaultType:"",f=r.columnDefaultValue?r.columnDefaultValue:"",p=r.columnDefaultText?r.columnDefaultText:""),null!=n&&null!=n&&n.find("label").each(function(){"columnDefaultType"==$(this).attr("BindName")?d=$(this).attr("Value"):"columnDefaultText"==$(this).attr("BindName")?p=$(this).attr("Value"):"columnDefaultValue"==$(this).attr("BindName")&&(f=$(this).attr("Value"))});var o=$("<div></div>"),T=$("<input type='text' style='width: 90%' readonly />");T.attr("columnDefaultType",d),T.attr("columnDefaultValue",f),T.attr("columnDefaultText",p),T.val(JBuild4DSelectView.SelectEnvVariable.formatText(d,p));var c=$("<input class='normalbutton-v1' style='margin-left: 4px;' type='button' value='...'/>");return o.append(T).append(c),window.$Temp$Inputtxt=T,c.click(function(){JBuild4DSelectView.SelectEnvVariable.beginSelect("Column_SelectDefaultValue")}),o},Get_CompletedStatus_HtmlElem:function(e,t,l,a,i,n){var u=n.find("input[type='text']");if(0<u.length){var r=u.attr("columnDefaultType"),d=u.attr("columnDefaultValue"),f=u.attr("columnDefaultText"),p=$("<div></div>");return p.append("<label>"+JBuild4DSelectView.SelectEnvVariable.formatText(r,f)+"</label>"),p.append("<label IsSerialize='true' BindName='columnDefaultType' Value='"+r+"' style='display:none'/>"),p.append("<label IsSerialize='true' BindName='columnDefaultText' Value='"+f+"' style='display:none'/>"),p.append("<label IsSerialize='true' BindName='columnDefaultValue' Value='"+d+"' style='display:none'/>"),p}return $("<label></label>")},ValidateToCompletedEnable:function(e,t,l,a,i,n){var u=n.val();return EditTableValidate.Validate(u,t)},setSelectEnvVariableResultValue:function(e){var t=window.$Temp$Inputtxt;null!=e?(t.attr("columnDefaultType",e.Type),t.attr("columnDefaultValue",e.Value),t.attr("columnDefaultText",e.Text),t.val(JBuild4DSelectView.SelectEnvVariable.formatText(e.Type,e.Text))):(t.attr("columnDefaultType",""),t.attr("columnDefaultValue",""),t.attr("columnDefaultText",""),t.val(""))}},Column_SelectFieldTypeDataLoader={_fieldDataTypeArray:null,GetFieldDataTypeArray:function(){if(null==this._fieldDataTypeArray){var l=this;AjaxUtility.PostSync("/Rest/Builder/DataStorage/DataBase/Table/GetTableFieldType",{},function(e){if(1==e.success){var t=JsonUtility.StringToJson(e.data);null!=t&&null!=t&&(l._fieldDataTypeArray=t)}else DialogUtility.Alert(window,"AlertLoadingQueryError",{},"加载字段类型失败！",null)},this)}return this._fieldDataTypeArray},GetFieldDataTypeObjectByValue:function(e){for(var t=this.GetFieldDataTypeArray(),l=0;l<t.length;l++){var a=t[l];if(a.Value==e)return a}alert("找不到指定的数据类型，请确认是否支持该类型！")},GetFieldDataTypeObjectByText:function(e){for(var t=this.GetFieldDataTypeArray(),l=0;l<t.length;l++){var a=t[l];if(a.Text==e)return a}alert("找不到指定的数据类型，请确认是否支持该类型！")}},Column_SelectFieldType={Get_EditStatus_HtmlElem:function(e,t,l,a,i,n,u,r){var d="",f=$("<select />");null!=r&&null!=r&&(d=r.columnDataTypeName),null!=n&&null!=n&&(d=n.attr("Value"));for(var p=Column_SelectFieldTypeDataLoader.GetFieldDataTypeArray(),o=0;o<p.length;o++){var T=p[o].Value,c=p[o].Text;f.append("<option value='"+T+"'>"+c+"</option>")}return""!=d?f.val(d):f.val(Column_SelectFieldTypeDataLoader.GetFieldDataTypeObjectByText("字符串").Value),f},Get_CompletedStatus_HtmlElem:function(e,t,l,a,i,n){var u=n.val(),r=Column_SelectFieldTypeDataLoader.GetFieldDataTypeObjectByValue(u).Text;return $("<label IsSerialize='true' BindName='"+t.BindName+"' Value='"+u+"'>"+r+"</label>")},ValidateToCompletedEnable:function(e,t,l,a,i,n){var u=n.val();return EditTableValidate.Validate(u,t)}},EditTable_FieldName={Get_EditStatus_HtmlElem:function(e,t,l,a,i,n,u,r){var d="",f=t.BindName;if(null!=t.DefaultValue&&null!=t.DefaultValue)d=EditTableDefauleValue.GetValue(t);null!=r&&null!=r&&(d=r[f]),null!=n&&null!=n&&(d=n.html());var p=$("<input type='text' style='width: 98%' />");return p.val(d),p.attr("BindName",t.BindName),p.attr("Val",d),p.attr("IsSerialize","true"),p},Get_CompletedStatus_HtmlElem:function(e,t,l,a,i,n){var u=n.val().toUpperCase();return $("<label IsSerialize='true' BindName='"+t.BindName+"' Value='"+u+"'>"+u+"</label>")},ValidateToCompletedEnable:function(e,t,l,a,i,n){var u=n.val(),r=EditTableValidate.Validate(u,t);return r.Success&&i.find("[renderer=EditTable_FieldName]").each(function(){$(this).find("label").each(function(){var e=$(this);e.text()!=u&&e.text()!=u.toUpperCase()||(r={Success:!1,Msg:"[字段名称]不能重复!"})})}),r}},EditTable_SelectDefaultValue={Get_EditStatus_HtmlElem:function(e,t,l,a,i,n,u,r){var d="",f="",p="";null!=r&&null!=r&&(d=r.fieldDefaultType?r.fieldDefaultType:"",f=r.fieldDefaultValue?r.fieldDefaultValue:"",p=r.fieldDefaultText?r.fieldDefaultText:""),null!=n&&null!=n&&n.find("label").each(function(){"fieldDefaultType"==$(this).attr("BindName")?d=$(this).attr("Value"):"fieldDefaultText"==$(this).attr("BindName")?p=$(this).attr("Value"):"fieldDefaultValue"==$(this).attr("BindName")&&(f=$(this).attr("Value"))});var o=$("<div></div>"),T=$("<input type='text' style='width: 90%' readonly />");T.attr("fieldDefaultType",d),T.attr("fieldDefaultValue",f),T.attr("fieldDefaultText",p),T.val(DefaultValueUtility.formatText(d,p));var c=$("<input class='normalbutton-v1' style='margin-left: 4px;' type='button' value='...'/>");return o.append(T).append(c),window.$Temp$Inputtxt=T,c.click(function(){window.tableDesion?tableDesion.selectDefaultValueDialogBegin(EditTable_SelectDefaultValue,null):(window.parent.listDesign.selectDefaultValueDialogBegin(window,null),window._SelectBindObj={setSelectEnvVariableResultValue:function(e){EditTable_SelectDefaultValue.setSelectEnvVariableResultValue(e)}})}),o},Get_CompletedStatus_HtmlElem:function(e,t,l,a,i,n){var u=n.find("input[type='text']");if(0<u.length){var r=u.attr("fieldDefaultType"),d=u.attr("fieldDefaultValue"),f=u.attr("fieldDefaultText"),p=$("<div></div>");return p.append("<label>"+DefaultValueUtility.formatText(r,f)+"</label>"),p.append("<label IsSerialize='true' BindName='fieldDefaultType' Value='"+r+"' style='display:none'/>"),p.append("<label IsSerialize='true' BindName='fieldDefaultText' Value='"+f+"' style='display:none'/>"),p.append("<label IsSerialize='true' BindName='fieldDefaultValue' Value='"+d+"' style='display:none'/>"),p}return $("<label></label>")},ValidateToCompletedEnable:function(e,t,l,a,i,n){var u=n.val();return EditTableValidate.Validate(u,t)},setSelectEnvVariableResultValue:function(e){var t=window.$Temp$Inputtxt;null!=e?(t.attr("fieldDefaultType",e.Type),t.attr("fieldDefaultValue",e.Value),t.attr("fieldDefaultText",e.Text),t.val(DefaultValueUtility.formatText(e.Type,e.Text))):(t.attr("fieldDefaultType",""),t.attr("fieldDefaultValue",""),t.attr("fieldDefaultText",""),t.val(""))}},EditTable_SelectFieldTypeDataLoader={_fieldDataTypeArray:null,GetFieldDataTypeArray:function(){if(null==this._fieldDataTypeArray){var l=this;AjaxUtility.PostSync("/Rest/Builder/DataStorage/DataBase/Table/GetTableFieldType",{},function(e){if(1==e.success){var t=JsonUtility.StringToJson(e.data);null!=t&&null!=t&&(l._fieldDataTypeArray=t)}else DialogUtility.Alert(window,"AlertLoadingQueryError",{},"加载字段类型失败！",null)},this)}return this._fieldDataTypeArray},GetFieldDataTypeObjectByValue:function(e){for(var t=this.GetFieldDataTypeArray(),l=0;l<t.length;l++){var a=t[l];if(a.Value==e)return a}alert("找不到指定的数据类型，请确认是否支持该类型！")},GetFieldDataTypeObjectByText:function(e){for(var t=this.GetFieldDataTypeArray(),l=0;l<t.length;l++){var a=t[l];if(a.Text==e)return a}alert("找不到指定的数据类型，请确认是否支持该类型！")}},EditTable_SelectFieldType={Get_EditStatus_HtmlElem:function(e,t,l,a,i,n,u,r){var d="",f=$("<select />");null!=r&&null!=r&&(d=r.fieldDataType),null!=n&&null!=n&&(d=n.attr("Value"));for(var p=EditTable_SelectFieldTypeDataLoader.GetFieldDataTypeArray(),o=0;o<p.length;o++){var T=p[o].Value,c=p[o].Text;f.append("<option value='"+T+"'>"+c+"</option>")}return""!=d?f.val(d):f.val(EditTable_SelectFieldTypeDataLoader.GetFieldDataTypeObjectByText("字符串").Value),f.change(function(){var e=$(this).val();"整数"==e?($(l).next().find("input").attr("disabled",!0),$(l).next().find("input").val(0),$(l).next().next().find("input").attr("disabled",!0),$(l).next().next().find("input").val(0)):"小数"==e?($(l).next().find("input").attr("disabled",!1),$(l).next().find("input").val(10),$(l).next().next().find("input").attr("disabled",!1),$(l).next().next().find("input").val(2)):"日期时间"==e?($(l).next().find("input").attr("disabled",!0),$(l).next().find("input").val(20),$(l).next().next().find("input").attr("disabled",!0),$(l).next().next().find("input").val(0)):"字符串"==e?($(l).next().find("input").attr("disabled",!1),$(l).next().find("input").val(50),$(l).next().next().find("input").attr("disabled",!0),$(l).next().next().find("input").val(0)):"长字符串"==e&&($(l).next().find("input").attr("disabled",!0),$(l).next().find("input").val(0),$(l).next().next().find("input").attr("disabled",!0),$(l).next().next().find("input").val(0))}),f},Get_CompletedStatus_HtmlElem:function(e,t,l,a,i,n){var u=n.val(),r=EditTable_SelectFieldTypeDataLoader.GetFieldDataTypeObjectByValue(u).Text;return $("<label IsSerialize='true' BindName='"+t.BindName+"' Value='"+u+"'>"+r+"</label>")},ValidateToCompletedEnable:function(e,t,l,a,i,n){var u=n.val();return EditTableValidate.Validate(u,t)}};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJlbmRlcmVycy9EYXRhU2V0L0NvbHVtbl9TZWxlY3REZWZhdWx0VmFsdWUuanMiLCJSZW5kZXJlcnMvRGF0YVNldC9Db2x1bW5fU2VsZWN0RmllbGRUeXBlLmpzIiwiUmVuZGVyZXJzL1RhYmxlRGVzaWduL0VkaXRUYWJsZV9GaWVsZE5hbWUuanMiLCJSZW5kZXJlcnMvVGFibGVEZXNpZ24vRWRpdFRhYmxlX1NlbGVjdERlZmF1bHRWYWx1ZS5qcyIsIlJlbmRlcmVycy9UYWJsZURlc2lnbi9FZGl0VGFibGVfU2VsZWN0RmllbGRUeXBlLmpzIl0sIm5hbWVzIjpbIkNvbHVtbl9TZWxlY3REZWZhdWx0VmFsdWUiLCJHZXRfRWRpdFN0YXR1c19IdG1sRWxlbSIsIl9jb25maWciLCJ0ZW1wbGF0ZSIsImhvc3RDZWxsIiwiaG9zdFJvdyIsImhvc3RUYWJsZSIsInZpZXdTdGF1c0h0bWxFbGVtIiwianNvbkRhdGFzIiwianNvbkRhdGFTaW5nbGUiLCJkZWZhdWx0VHlwZSIsImRlZmF1bHRWYWx1ZSIsImRlZmF1bHRUZXh0IiwidW5kZWZpbmVkIiwiZmluZCIsImVhY2giLCIkIiwidGhpcyIsImF0dHIiLCIkZWxlbSIsIiRpbnB1dFR4dCIsInZhbCIsIkpCdWlsZDREU2VsZWN0VmlldyIsIlNlbGVjdEVudlZhcmlhYmxlIiwiZm9ybWF0VGV4dCIsIiRpbnB1dEJ0biIsImFwcGVuZCIsIndpbmRvdyIsIiRUZW1wJElucHV0dHh0IiwiY2xpY2siLCJiZWdpblNlbGVjdCIsIkdldF9Db21wbGV0ZWRTdGF0dXNfSHRtbEVsZW0iLCJlZGl0U3RhdXNIdG1sRWxlbSIsImxlbmd0aCIsIlZhbGlkYXRlVG9Db21wbGV0ZWRFbmFibGUiLCJFZGl0VGFibGVWYWxpZGF0ZSIsIlZhbGlkYXRlIiwic2V0U2VsZWN0RW52VmFyaWFibGVSZXN1bHRWYWx1ZSIsImRlZmF1bHREYXRhIiwiVHlwZSIsIlZhbHVlIiwiVGV4dCIsIkNvbHVtbl9TZWxlY3RGaWVsZFR5cGVEYXRhTG9hZGVyIiwiX2ZpZWxkRGF0YVR5cGVBcnJheSIsIkdldEZpZWxkRGF0YVR5cGVBcnJheSIsIl9zZWxmIiwiQWpheFV0aWxpdHkiLCJQb3N0U3luYyIsImRhdGEiLCJzdWNjZXNzIiwibGlzdCIsIkpzb25VdGlsaXR5IiwiU3RyaW5nVG9Kc29uIiwiRGlhbG9nVXRpbGl0eSIsIkFsZXJ0IiwiR2V0RmllbGREYXRhVHlwZU9iamVjdEJ5VmFsdWUiLCJhcnJheURhdGEiLCJpIiwib2JqIiwiYWxlcnQiLCJHZXRGaWVsZERhdGFUeXBlT2JqZWN0QnlUZXh0IiwidGV4dCIsIkNvbHVtbl9TZWxlY3RGaWVsZFR5cGUiLCJ2YWx1ZSIsIkJpbmROYW1lIiwiRWRpdFRhYmxlX0ZpZWxkTmFtZSIsImJpbmRuYW1lIiwiRGVmYXVsdFZhbHVlIiwiRWRpdFRhYmxlRGVmYXVsZVZhbHVlIiwiR2V0VmFsdWUiLCJodG1sIiwidG9VcHBlckNhc2UiLCJyZXN1bHQiLCJTdWNjZXNzIiwibGFiZWxpdGVtIiwiTXNnIiwiRWRpdFRhYmxlX1NlbGVjdERlZmF1bHRWYWx1ZSIsImZpZWxkRGVmYXVsdFR5cGUiLCJmaWVsZERlZmF1bHRWYWx1ZSIsImZpZWxkRGVmYXVsdFRleHQiLCJEZWZhdWx0VmFsdWVVdGlsaXR5IiwidGFibGVEZXNpb24iLCJzZWxlY3REZWZhdWx0VmFsdWVEaWFsb2dCZWdpbiIsInBhcmVudCIsImxpc3REZXNpZ24iLCJfU2VsZWN0QmluZE9iaiIsIkVkaXRUYWJsZV9TZWxlY3RGaWVsZFR5cGVEYXRhTG9hZGVyIiwiRWRpdFRhYmxlX1NlbGVjdEZpZWxkVHlwZSIsImNoYW5nZSIsIm5leHQiXSwibWFwcGluZ3MiOiJBQUFBLGFBRUEsSUFBQUEsMEJBQUEsQ0FDQUMsd0JBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQSxJQUFBQyxFQUFBLEdBQ0FDLEVBQUEsR0FDQUMsRUFBQSxHQUVBLE1BQUFILEdBQUFJLE1BQUFKLElBQ0FDLEVBQUFELEVBQUEsa0JBQUFB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LEdBQ0FMLEVBQUFaLEdBQUFxRixPQUFBM0UsS0FBQSxTQUFBSSxLQUFBLFlBQUEsR0FDQUYsRUFBQVosR0FBQXFGLE9BQUEzRSxLQUFBLFNBQUFPLElBQUEsR0FDQUwsRUFBQVosR0FBQXFGLE9BQUFBLE9BQUEzRSxLQUFBLFNBQUFJLEtBQUEsWUFBQSxHQUNBRixFQUFBWixHQUFBcUYsT0FBQUEsT0FBQTNFLEtBQUEsU0FBQU8sSUFBQSxJQUNBLE1BQUFBLEdBQ0FMLEVBQUFaLEdBQUFxRixPQUFBM0UsS0FBQSxTQUFBSSxLQUFBLFlBQUEsR0FDQUYsRUFBQVosR0FBQXFGLE9BQUEzRSxLQUFBLFNBQUFPLElBQUEsSUFDQUwsRUFBQVosR0FBQXFGLE9BQUFBLE9BQUEzRSxLQUFBLFNBQUFJLEtBQUEsWUFBQSxHQUNBRixFQUFBWixHQUFBcUYsT0FBQUEsT0FBQTNFLEtBQUEsU0FBQU8sSUFBQSxJQUNBLFFBQUFBLEdBQ0FMLEVBQUFaLEdBQUFxRixPQUFBM0UsS0FBQSxTQUFBSSxLQUFBLFlBQUEsR0FDQUYsRUFBQVosR0FBQXFGLE9BQUEzRSxLQUFBLFNBQUFPLElBQUEsSUFDQUwsRUFBQVosR0FBQXFGLE9BQUFBLE9BQUEzRSxLQUFBLFNBQUFJLEtBQUEsWUFBQSxHQUNBRixFQUFBWixHQUFBcUYsT0FBQUEsT0FBQTNFLEtBQUEsU0FBQU8sSUFBQSxJQUNBLE9BQUFBLEdBQ0FMLEVBQUFaLEdBQUFxRixPQUFBM0UsS0FBQSxTQUFBSSxLQUFBLFlBQUEsR0FDQUYsRUFBQVosR0FBQXFGLE9BQUEzRSxLQUFBLFNBQUFPLElBQUEsSUFDQUwsRUFBQVosR0FBQXFGLE9BQUFBLE9BQUEzRSxLQUFBLFNBQUFJLEtBQUEsWUFBQSxHQUNBRixFQUFBWixHQUFBcUYsT0FBQUEsT0FBQTNFLEtBQUEsU0FBQU8sSUFBQSxJQUNBLFFBQUFBLElBQ0FMLEVBQUFaLEdBQUFxRixPQUFBM0UsS0FBQSxTQUFBSSxLQUFBLFlBQUEsR0FDQUYsRUFBQVosR0FBQXFGLE9BQUEzRSxLQUFBLFNBQUFPLElBQUEsR0FDQUwsRUFBQVosR0FBQXFGLE9BQUFBLE9BQUEzRSxLQUFBLFNBQUFJLEtBQUEsWUFBQSxHQUNBRixFQUFBWixHQUFBcUYsT0FBQUEsT0FBQTNFLEtBQUEsU0FBQU8sSUFBQSxNQUdBRixHQUVBWSw2QkFBQSxTQUFBN0IsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQTBCLEdBQ0EsSUFBQStCLEVBQUEvQixFQUFBWCxNQUNBd0MsRUFBQXlCLG9DQUFBL0IsOEJBQUFRLEdBQUF0QixLQUVBLE9BREF6QixFQUFBLHVDQUFBYixFQUFBNkQsU0FBQSxZQUFBRCxFQUFBLEtBQUFGLEVBQUEsYUFHQTNCLDBCQUFBLFNBQUFoQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBMEIsR0FDQSxJQUFBWCxFQUFBVyxFQUFBWCxNQUNBLE9BQUFjLGtCQUFBQyxTQUFBZixFQUFBbEIiLCJmaWxlIjoiVUlFWENvbXBvbmVudEZvckJ1aWxkZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxudmFyIENvbHVtbl9TZWxlY3REZWZhdWx0VmFsdWUgPSB7XG4gIEdldF9FZGl0U3RhdHVzX0h0bWxFbGVtOiBmdW5jdGlvbiBHZXRfRWRpdFN0YXR1c19IdG1sRWxlbShfY29uZmlnLCB0ZW1wbGF0ZSwgaG9zdENlbGwsIGhvc3RSb3csIGhvc3RUYWJsZSwgdmlld1N0YXVzSHRtbEVsZW0sIGpzb25EYXRhcywganNvbkRhdGFTaW5nbGUpIHtcbiAgICB2YXIgZGVmYXVsdFR5cGUgPSBcIlwiO1xuICAgIHZhciBkZWZhdWx0VmFsdWUgPSBcIlwiO1xuICAgIHZhciBkZWZhdWx0VGV4dCA9IFwiXCI7XG5cbiAgICBpZiAoanNvbkRhdGFTaW5nbGUgIT0gbnVsbCAmJiBqc29uRGF0YVNpbmdsZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgIGRlZmF1bHRUeXBlID0ganNvbkRhdGFTaW5nbGVbXCJjb2x1bW5EZWZhdWx0VHlwZVwiXSA/IGpzb25EYXRhU2luZ2xlW1wiY29sdW1uRGVmYXVsdFR5cGVcIl0gOiBcIlwiO1xuICAgICAgZGVmYXVsdFZhbHVlID0ganNvbkRhdGFTaW5nbGVbXCJjb2x1bW5EZWZhdWx0VmFsdWVcIl0gPyBqc29uRGF0YVNpbmdsZVtcImNvbHVtbkRlZmF1bHRWYWx1ZVwiXSA6IFwiXCI7XG4gICAgICBkZWZhdWx0VGV4dCA9IGpzb25EYXRhU2luZ2xlW1wiY29sdW1uRGVmYXVsdFRleHRcIl0gPyBqc29uRGF0YVNpbmdsZVtcImNvbHVtbkRlZmF1bHRUZXh0XCJdIDogXCJcIjtcbiAgICB9XG5cbiAgICBpZiAodmlld1N0YXVzSHRtbEVsZW0gIT0gbnVsbCAmJiB2aWV3U3RhdXNIdG1sRWxlbSAhPSB1bmRlZmluZWQpIHtcbiAgICAgIHZpZXdTdGF1c0h0bWxFbGVtLmZpbmQoXCJsYWJlbFwiKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCQodGhpcykuYXR0cihcIkJpbmROYW1lXCIpID09IFwiY29sdW1uRGVmYXVsdFR5cGVcIikge1xuICAgICAgICAgIGRlZmF1bHRUeXBlID0gJCh0aGlzKS5hdHRyKFwiVmFsdWVcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoJCh0aGlzKS5hdHRyKFwiQmluZE5hbWVcIikgPT0gXCJjb2x1bW5EZWZhdWx0VGV4dFwiKSB7XG4gICAgICAgICAgZGVmYXVsdFRleHQgPSAkKHRoaXMpLmF0dHIoXCJWYWx1ZVwiKTtcbiAgICAgICAgfSBlbHNlIGlmICgkKHRoaXMpLmF0dHIoXCJCaW5kTmFtZVwiKSA9PSBcImNvbHVtbkRlZmF1bHRWYWx1ZVwiKSB7XG4gICAgICAgICAgZGVmYXVsdFZhbHVlID0gJCh0aGlzKS5hdHRyKFwiVmFsdWVcIik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHZhciAkZWxlbSA9ICQoXCI8ZGl2PjwvZGl2PlwiKTtcbiAgICB2YXIgJGlucHV0VHh0ID0gJChcIjxpbnB1dCB0eXBlPSd0ZXh0JyBzdHlsZT0nd2lkdGg6IDkwJScgcmVhZG9ubHkgLz5cIik7XG4gICAgJGlucHV0VHh0LmF0dHIoXCJjb2x1bW5EZWZhdWx0VHlwZVwiLCBkZWZhdWx0VHlwZSk7XG4gICAgJGlucHV0VHh0LmF0dHIoXCJjb2x1bW5EZWZhdWx0VmFsdWVcIiwgZGVmYXVsdFZhbHVlKTtcbiAgICAkaW5wdXRUeHQuYXR0cihcImNvbHVtbkRlZmF1bHRUZXh0XCIsIGRlZmF1bHRUZXh0KTtcbiAgICAkaW5wdXRUeHQudmFsKEpCdWlsZDREU2VsZWN0Vmlldy5TZWxlY3RFbnZWYXJpYWJsZS5mb3JtYXRUZXh0KGRlZmF1bHRUeXBlLCBkZWZhdWx0VGV4dCkpO1xuICAgIHZhciAkaW5wdXRCdG4gPSAkKFwiPGlucHV0IGNsYXNzPSdub3JtYWxidXR0b24tdjEnIHN0eWxlPSdtYXJnaW4tbGVmdDogNHB4OycgdHlwZT0nYnV0dG9uJyB2YWx1ZT0nLi4uJy8+XCIpO1xuICAgICRlbGVtLmFwcGVuZCgkaW5wdXRUeHQpLmFwcGVuZCgkaW5wdXRCdG4pO1xuICAgIHdpbmRvdy4kVGVtcCRJbnB1dHR4dCA9ICRpbnB1dFR4dDtcbiAgICAkaW5wdXRCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgSkJ1aWxkNERTZWxlY3RWaWV3LlNlbGVjdEVudlZhcmlhYmxlLmJlZ2luU2VsZWN0KFwiQ29sdW1uX1NlbGVjdERlZmF1bHRWYWx1ZVwiKTtcbiAgICB9KTtcbiAgICByZXR1cm4gJGVsZW07XG4gIH0sXG4gIEdldF9Db21wbGV0ZWRTdGF0dXNfSHRtbEVsZW06IGZ1bmN0aW9uIEdldF9Db21wbGV0ZWRTdGF0dXNfSHRtbEVsZW0oX2NvbmZpZywgdGVtcGxhdGUsIGhvc3RDZWxsLCBob3N0Um93LCBob3N0VGFibGUsIGVkaXRTdGF1c0h0bWxFbGVtKSB7XG4gICAgdmFyICRpbnB1dFR4dCA9IGVkaXRTdGF1c0h0bWxFbGVtLmZpbmQoXCJpbnB1dFt0eXBlPSd0ZXh0J11cIik7XG5cbiAgICBpZiAoJGlucHV0VHh0Lmxlbmd0aCA+IDApIHtcbiAgICAgIHZhciBkZWZhdWx0VHlwZSA9ICRpbnB1dFR4dC5hdHRyKFwiY29sdW1uRGVmYXVsdFR5cGVcIik7XG4gICAgICB2YXIgZGVmYXVsdFZhbHVlID0gJGlucHV0VHh0LmF0dHIoXCJjb2x1bW5EZWZhdWx0VmFsdWVcIik7XG4gICAgICB2YXIgZGVmYXVsdFRleHQgPSAkaW5wdXRUeHQuYXR0cihcImNvbHVtbkRlZmF1bHRUZXh0XCIpO1xuICAgICAgdmFyICRlbGVtID0gJChcIjxkaXY+PC9kaXY+XCIpO1xuICAgICAgJGVsZW0uYXBwZW5kKFwiPGxhYmVsPlwiICsgSkJ1aWxkNERTZWxlY3RWaWV3LlNlbGVjdEVudlZhcmlhYmxlLmZvcm1hdFRleHQoZGVmYXVsdFR5cGUsIGRlZmF1bHRUZXh0KSArIFwiPC9sYWJlbD5cIik7XG4gICAgICAkZWxlbS5hcHBlbmQoXCI8bGFiZWwgSXNTZXJpYWxpemU9J3RydWUnIEJpbmROYW1lPSdjb2x1bW5EZWZhdWx0VHlwZScgVmFsdWU9J1wiICsgZGVmYXVsdFR5cGUgKyBcIicgc3R5bGU9J2Rpc3BsYXk6bm9uZScvPlwiKTtcbiAgICAgICRlbGVtLmFwcGVuZChcIjxsYWJlbCBJc1NlcmlhbGl6ZT0ndHJ1ZScgQmluZE5hbWU9J2NvbHVtbkRlZmF1bHRUZXh0JyBWYWx1ZT0nXCIgKyBkZWZhdWx0VGV4dCArIFwiJyBzdHlsZT0nZGlzcGxheTpub25lJy8+XCIpO1xuICAgICAgJGVsZW0uYXBwZW5kKFwiPGxhYmVsIElzU2VyaWFsaXplPSd0cnVlJyBCaW5kTmFtZT0nY29sdW1uRGVmYXVsdFZhbHVlJyBWYWx1ZT0nXCIgKyBkZWZhdWx0VmFsdWUgKyBcIicgc3R5bGU9J2Rpc3BsYXk6bm9uZScvPlwiKTtcbiAgICAgIHJldHVybiAkZWxlbTtcbiAgICB9XG5cbiAgICByZXR1cm4gJChcIjxsYWJlbD48L2xhYmVsPlwiKTtcbiAgfSxcbiAgVmFsaWRhdGVUb0NvbXBsZXRlZEVuYWJsZTogZnVuY3Rpb24gVmFsaWRhdGVUb0NvbXBsZXRlZEVuYWJsZShfY29uZmlnLCB0ZW1wbGF0ZSwgaG9zdENlbGwsIGhvc3RSb3csIGhvc3RUYWJsZSwgZWRpdFN0YXVzSHRtbEVsZW0pIHtcbiAgICB2YXIgdmFsID0gZWRpdFN0YXVzSHRtbEVsZW0udmFsKCk7XG4gICAgcmV0dXJuIEVkaXRUYWJsZVZhbGlkYXRlLlZhbGlkYXRlKHZhbCwgdGVtcGxhdGUpO1xuICB9LFxuICBzZXRTZWxlY3RFbnZWYXJpYWJsZVJlc3VsdFZhbHVlOiBmdW5jdGlvbiBzZXRTZWxlY3RFbnZWYXJpYWJsZVJlc3VsdFZhbHVlKGRlZmF1bHREYXRhKSB7XG4gICAgdmFyICRpbnB1dFR4dCA9IHdpbmRvdy4kVGVtcCRJbnB1dHR4dDtcblxuICAgIGlmIChudWxsICE9IGRlZmF1bHREYXRhKSB7XG4gICAgICAkaW5wdXRUeHQuYXR0cihcImNvbHVtbkRlZmF1bHRUeXBlXCIsIGRlZmF1bHREYXRhLlR5cGUpO1xuICAgICAgJGlucHV0VHh0LmF0dHIoXCJjb2x1bW5EZWZhdWx0VmFsdWVcIiwgZGVmYXVsdERhdGEuVmFsdWUpO1xuICAgICAgJGlucHV0VHh0LmF0dHIoXCJjb2x1bW5EZWZhdWx0VGV4dFwiLCBkZWZhdWx0RGF0YS5UZXh0KTtcbiAgICAgICRpbnB1dFR4dC52YWwoSkJ1aWxkNERTZWxlY3RWaWV3LlNlbGVjdEVudlZhcmlhYmxlLmZvcm1hdFRleHQoZGVmYXVsdERhdGEuVHlwZSwgZGVmYXVsdERhdGEuVGV4dCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkaW5wdXRUeHQuYXR0cihcImNvbHVtbkRlZmF1bHRUeXBlXCIsIFwiXCIpO1xuICAgICAgJGlucHV0VHh0LmF0dHIoXCJjb2x1bW5EZWZhdWx0VmFsdWVcIiwgXCJcIik7XG4gICAgICAkaW5wdXRUeHQuYXR0cihcImNvbHVtbkRlZmF1bHRUZXh0XCIsIFwiXCIpO1xuICAgICAgJGlucHV0VHh0LnZhbChcIlwiKTtcbiAgICB9XG4gIH1cbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBDb2x1bW5fU2VsZWN0RmllbGRUeXBlRGF0YUxvYWRlciA9IHtcbiAgX2ZpZWxkRGF0YVR5cGVBcnJheTogbnVsbCxcbiAgR2V0RmllbGREYXRhVHlwZUFycmF5OiBmdW5jdGlvbiBHZXRGaWVsZERhdGFUeXBlQXJyYXkoKSB7XG4gICAgaWYgKHRoaXMuX2ZpZWxkRGF0YVR5cGVBcnJheSA9PSBudWxsKSB7XG4gICAgICB2YXIgX3NlbGYgPSB0aGlzO1xuXG4gICAgICBBamF4VXRpbGl0eS5Qb3N0U3luYyhcIi9SZXN0L0J1aWxkZXIvRGF0YVN0b3JhZ2UvRGF0YUJhc2UvVGFibGUvR2V0VGFibGVGaWVsZFR5cGVcIiwge30sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MgPT0gdHJ1ZSkge1xuICAgICAgICAgIHZhciBsaXN0ID0gSnNvblV0aWxpdHkuU3RyaW5nVG9Kc29uKGRhdGEuZGF0YSk7XG5cbiAgICAgICAgICBpZiAobGlzdCAhPSBudWxsICYmIGxpc3QgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBfc2VsZi5fZmllbGREYXRhVHlwZUFycmF5ID0gbGlzdDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgRGlhbG9nVXRpbGl0eS5BbGVydCh3aW5kb3csIFwiQWxlcnRMb2FkaW5nUXVlcnlFcnJvclwiLCB7fSwgXCLliqDovb3lrZfmrrXnsbvlnovlpLHotKXvvIFcIiwgbnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLl9maWVsZERhdGFUeXBlQXJyYXk7XG4gIH0sXG4gIEdldEZpZWxkRGF0YVR5cGVPYmplY3RCeVZhbHVlOiBmdW5jdGlvbiBHZXRGaWVsZERhdGFUeXBlT2JqZWN0QnlWYWx1ZShWYWx1ZSkge1xuICAgIHZhciBhcnJheURhdGEgPSB0aGlzLkdldEZpZWxkRGF0YVR5cGVBcnJheSgpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBvYmogPSBhcnJheURhdGFbaV07XG5cbiAgICAgIGlmIChvYmouVmFsdWUgPT0gVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBhbGVydChcIuaJvuS4jeWIsOaMh+WumueahOaVsOaNruexu+Wei++8jOivt+ehruiupOaYr+WQpuaUr+aMgeivpeexu+Wei++8gVwiKTtcbiAgfSxcbiAgR2V0RmllbGREYXRhVHlwZU9iamVjdEJ5VGV4dDogZnVuY3Rpb24gR2V0RmllbGREYXRhVHlwZU9iamVjdEJ5VGV4dCh0ZXh0KSB7XG4gICAgdmFyIGFycmF5RGF0YSA9IHRoaXMuR2V0RmllbGREYXRhVHlwZUFycmF5KCk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5RGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIG9iaiA9IGFycmF5RGF0YVtpXTtcblxuICAgICAgaWYgKG9iai5UZXh0ID09IHRleHQpIHtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBhbGVydChcIuaJvuS4jeWIsOaMh+WumueahOaVsOaNruexu+Wei++8jOivt+ehruiupOaYr+WQpuaUr+aMgeivpeexu+Wei++8gVwiKTtcbiAgfVxufTtcbnZhciBDb2x1bW5fU2VsZWN0RmllbGRUeXBlID0ge1xuICBHZXRfRWRpdFN0YXR1c19IdG1sRWxlbTogZnVuY3Rpb24gR2V0X0VkaXRTdGF0dXNfSHRtbEVsZW0oX2NvbmZpZywgdGVtcGxhdGUsIGhvc3RDZWxsLCBob3N0Um93LCBob3N0VGFibGUsIHZpZXdTdGF1c0h0bWxFbGVtLCBqc29uRGF0YXMsIGpzb25EYXRhU2luZ2xlKSB7XG4gICAgdmFyIHZhbCA9IFwiXCI7XG4gICAgdmFyICRlbGVtID0gJChcIjxzZWxlY3QgLz5cIik7XG5cbiAgICBpZiAoanNvbkRhdGFTaW5nbGUgIT0gbnVsbCAmJiBqc29uRGF0YVNpbmdsZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgIHZhbCA9IGpzb25EYXRhU2luZ2xlW1wiY29sdW1uRGF0YVR5cGVOYW1lXCJdO1xuICAgIH1cblxuICAgIGlmICh2aWV3U3RhdXNIdG1sRWxlbSAhPSBudWxsICYmIHZpZXdTdGF1c0h0bWxFbGVtICE9IHVuZGVmaW5lZCkge1xuICAgICAgdmFsID0gdmlld1N0YXVzSHRtbEVsZW0uYXR0cihcIlZhbHVlXCIpO1xuICAgIH1cblxuICAgIHZhciBfZmllbGREYXRhVHlwZUFycmF5ID0gQ29sdW1uX1NlbGVjdEZpZWxkVHlwZURhdGFMb2FkZXIuR2V0RmllbGREYXRhVHlwZUFycmF5KCk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IF9maWVsZERhdGFUeXBlQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciB2YWx1ZSA9IF9maWVsZERhdGFUeXBlQXJyYXlbaV0uVmFsdWU7XG4gICAgICB2YXIgdGV4dCA9IF9maWVsZERhdGFUeXBlQXJyYXlbaV0uVGV4dDtcbiAgICAgICRlbGVtLmFwcGVuZChcIjxvcHRpb24gdmFsdWU9J1wiICsgdmFsdWUgKyBcIic+XCIgKyB0ZXh0ICsgXCI8L29wdGlvbj5cIik7XG4gICAgfVxuXG4gICAgaWYgKHZhbCAhPSBcIlwiKSB7XG4gICAgICAkZWxlbS52YWwodmFsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGVsZW0udmFsKENvbHVtbl9TZWxlY3RGaWVsZFR5cGVEYXRhTG9hZGVyLkdldEZpZWxkRGF0YVR5cGVPYmplY3RCeVRleHQoXCLlrZfnrKbkuLJcIikuVmFsdWUpO1xuICAgIH1cblxuICAgIHJldHVybiAkZWxlbTtcbiAgfSxcbiAgR2V0X0NvbXBsZXRlZFN0YXR1c19IdG1sRWxlbTogZnVuY3Rpb24gR2V0X0NvbXBsZXRlZFN0YXR1c19IdG1sRWxlbShfY29uZmlnLCB0ZW1wbGF0ZSwgaG9zdENlbGwsIGhvc3RSb3csIGhvc3RUYWJsZSwgZWRpdFN0YXVzSHRtbEVsZW0pIHtcbiAgICB2YXIgdmFsdWUgPSBlZGl0U3RhdXNIdG1sRWxlbS52YWwoKTtcbiAgICB2YXIgdGV4dCA9IENvbHVtbl9TZWxlY3RGaWVsZFR5cGVEYXRhTG9hZGVyLkdldEZpZWxkRGF0YVR5cGVPYmplY3RCeVZhbHVlKHZhbHVlKS5UZXh0O1xuICAgIHZhciAkZWxlbSA9ICQoXCI8bGFiZWwgSXNTZXJpYWxpemU9J3RydWUnIEJpbmROYW1lPSdcIiArIHRlbXBsYXRlLkJpbmROYW1lICsgXCInIFZhbHVlPSdcIiArIHZhbHVlICsgXCInPlwiICsgdGV4dCArIFwiPC9sYWJlbD5cIik7XG4gICAgcmV0dXJuICRlbGVtO1xuICB9LFxuICBWYWxpZGF0ZVRvQ29tcGxldGVkRW5hYmxlOiBmdW5jdGlvbiBWYWxpZGF0ZVRvQ29tcGxldGVkRW5hYmxlKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCBlZGl0U3RhdXNIdG1sRWxlbSkge1xuICAgIHZhciB2YWwgPSBlZGl0U3RhdXNIdG1sRWxlbS52YWwoKTtcbiAgICByZXR1cm4gRWRpdFRhYmxlVmFsaWRhdGUuVmFsaWRhdGUodmFsLCB0ZW1wbGF0ZSk7XG4gIH1cbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBFZGl0VGFibGVfRmllbGROYW1lID0ge1xuICBHZXRfRWRpdFN0YXR1c19IdG1sRWxlbTogZnVuY3Rpb24gR2V0X0VkaXRTdGF0dXNfSHRtbEVsZW0oX2NvbmZpZywgdGVtcGxhdGUsIGhvc3RDZWxsLCBob3N0Um93LCBob3N0VGFibGUsIHZpZXdTdGF1c0h0bWxFbGVtLCBqc29uRGF0YXMsIGpzb25EYXRhU2luZ2xlKSB7XG4gICAgdmFyIHZhbCA9IFwiXCI7XG4gICAgdmFyIGJpbmRuYW1lID0gdGVtcGxhdGUuQmluZE5hbWU7XG5cbiAgICBpZiAodGVtcGxhdGUuRGVmYXVsdFZhbHVlICE9IHVuZGVmaW5lZCAmJiB0ZW1wbGF0ZS5EZWZhdWx0VmFsdWUgIT0gbnVsbCkge1xuICAgICAgdmFyIHZhbCA9IEVkaXRUYWJsZURlZmF1bGVWYWx1ZS5HZXRWYWx1ZSh0ZW1wbGF0ZSk7XG4gICAgfVxuXG4gICAgaWYgKGpzb25EYXRhU2luZ2xlICE9IG51bGwgJiYganNvbkRhdGFTaW5nbGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICB2YWwgPSBqc29uRGF0YVNpbmdsZVtiaW5kbmFtZV07XG4gICAgfVxuXG4gICAgaWYgKHZpZXdTdGF1c0h0bWxFbGVtICE9IG51bGwgJiYgdmlld1N0YXVzSHRtbEVsZW0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICB2YWwgPSB2aWV3U3RhdXNIdG1sRWxlbS5odG1sKCk7XG4gICAgfVxuXG4gICAgdmFyICRlbGVtID0gJChcIjxpbnB1dCB0eXBlPSd0ZXh0JyBzdHlsZT0nd2lkdGg6IDk4JScgLz5cIik7XG4gICAgJGVsZW0udmFsKHZhbCk7XG4gICAgJGVsZW0uYXR0cihcIkJpbmROYW1lXCIsIHRlbXBsYXRlLkJpbmROYW1lKTtcbiAgICAkZWxlbS5hdHRyKFwiVmFsXCIsIHZhbCk7XG4gICAgJGVsZW0uYXR0cihcIklzU2VyaWFsaXplXCIsIFwidHJ1ZVwiKTtcbiAgICByZXR1cm4gJGVsZW07XG4gIH0sXG4gIEdldF9Db21wbGV0ZWRTdGF0dXNfSHRtbEVsZW06IGZ1bmN0aW9uIEdldF9Db21wbGV0ZWRTdGF0dXNfSHRtbEVsZW0oX2NvbmZpZywgdGVtcGxhdGUsIGhvc3RDZWxsLCBob3N0Um93LCBob3N0VGFibGUsIGVkaXRTdGF1c0h0bWxFbGVtKSB7XG4gICAgdmFyIHZhbCA9IGVkaXRTdGF1c0h0bWxFbGVtLnZhbCgpLnRvVXBwZXJDYXNlKCk7XG4gICAgdmFyICRlbGVtID0gJChcIjxsYWJlbCBJc1NlcmlhbGl6ZT0ndHJ1ZScgQmluZE5hbWU9J1wiICsgdGVtcGxhdGUuQmluZE5hbWUgKyBcIicgVmFsdWU9J1wiICsgdmFsICsgXCInPlwiICsgdmFsICsgXCI8L2xhYmVsPlwiKTtcbiAgICByZXR1cm4gJGVsZW07XG4gIH0sXG4gIFZhbGlkYXRlVG9Db21wbGV0ZWRFbmFibGU6IGZ1bmN0aW9uIFZhbGlkYXRlVG9Db21wbGV0ZWRFbmFibGUoX2NvbmZpZywgdGVtcGxhdGUsIGhvc3RDZWxsLCBob3N0Um93LCBob3N0VGFibGUsIGVkaXRTdGF1c0h0bWxFbGVtKSB7XG4gICAgdmFyIHZhbCA9IGVkaXRTdGF1c0h0bWxFbGVtLnZhbCgpO1xuICAgIHZhciByZXN1bHQgPSBFZGl0VGFibGVWYWxpZGF0ZS5WYWxpZGF0ZSh2YWwsIHRlbXBsYXRlKTtcblxuICAgIGlmIChyZXN1bHQuU3VjY2Vzcykge1xuICAgICAgaG9zdFRhYmxlLmZpbmQoXCJbcmVuZGVyZXI9RWRpdFRhYmxlX0ZpZWxkTmFtZV1cIikuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZXJpdGVtID0gJCh0aGlzKTtcbiAgICAgICAgc2VyaXRlbS5maW5kKFwibGFiZWxcIikuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIGxhYmVsaXRlbSA9ICQodGhpcyk7XG5cbiAgICAgICAgICBpZiAobGFiZWxpdGVtLnRleHQoKSA9PSB2YWwgfHwgbGFiZWxpdGVtLnRleHQoKSA9PSB2YWwudG9VcHBlckNhc2UoKSkge1xuICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICBTdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgTXNnOiBcIlvlrZfmrrXlkI3np7Bd5LiN6IO96YeN5aSNIVwiXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59OyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgRWRpdFRhYmxlX1NlbGVjdERlZmF1bHRWYWx1ZSA9IHtcbiAgR2V0X0VkaXRTdGF0dXNfSHRtbEVsZW06IGZ1bmN0aW9uIEdldF9FZGl0U3RhdHVzX0h0bWxFbGVtKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCB2aWV3U3RhdXNIdG1sRWxlbSwganNvbkRhdGFzLCBqc29uRGF0YVNpbmdsZSkge1xuICAgIHZhciBmaWVsZERlZmF1bHRUeXBlID0gXCJcIjtcbiAgICB2YXIgZmllbGREZWZhdWx0VmFsdWUgPSBcIlwiO1xuICAgIHZhciBmaWVsZERlZmF1bHRUZXh0ID0gXCJcIjtcblxuICAgIGlmIChqc29uRGF0YVNpbmdsZSAhPSBudWxsICYmIGpzb25EYXRhU2luZ2xlICE9IHVuZGVmaW5lZCkge1xuICAgICAgZmllbGREZWZhdWx0VHlwZSA9IGpzb25EYXRhU2luZ2xlW1wiZmllbGREZWZhdWx0VHlwZVwiXSA/IGpzb25EYXRhU2luZ2xlW1wiZmllbGREZWZhdWx0VHlwZVwiXSA6IFwiXCI7XG4gICAgICBmaWVsZERlZmF1bHRWYWx1ZSA9IGpzb25EYXRhU2luZ2xlW1wiZmllbGREZWZhdWx0VmFsdWVcIl0gPyBqc29uRGF0YVNpbmdsZVtcImZpZWxkRGVmYXVsdFZhbHVlXCJdIDogXCJcIjtcbiAgICAgIGZpZWxkRGVmYXVsdFRleHQgPSBqc29uRGF0YVNpbmdsZVtcImZpZWxkRGVmYXVsdFRleHRcIl0gPyBqc29uRGF0YVNpbmdsZVtcImZpZWxkRGVmYXVsdFRleHRcIl0gOiBcIlwiO1xuICAgIH1cblxuICAgIGlmICh2aWV3U3RhdXNIdG1sRWxlbSAhPSBudWxsICYmIHZpZXdTdGF1c0h0bWxFbGVtICE9IHVuZGVmaW5lZCkge1xuICAgICAgdmlld1N0YXVzSHRtbEVsZW0uZmluZChcImxhYmVsXCIpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKFwiQmluZE5hbWVcIikgPT0gXCJmaWVsZERlZmF1bHRUeXBlXCIpIHtcbiAgICAgICAgICBmaWVsZERlZmF1bHRUeXBlID0gJCh0aGlzKS5hdHRyKFwiVmFsdWVcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoJCh0aGlzKS5hdHRyKFwiQmluZE5hbWVcIikgPT0gXCJmaWVsZERlZmF1bHRUZXh0XCIpIHtcbiAgICAgICAgICBmaWVsZERlZmF1bHRUZXh0ID0gJCh0aGlzKS5hdHRyKFwiVmFsdWVcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoJCh0aGlzKS5hdHRyKFwiQmluZE5hbWVcIikgPT0gXCJmaWVsZERlZmF1bHRWYWx1ZVwiKSB7XG4gICAgICAgICAgZmllbGREZWZhdWx0VmFsdWUgPSAkKHRoaXMpLmF0dHIoXCJWYWx1ZVwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmFyICRlbGVtID0gJChcIjxkaXY+PC9kaXY+XCIpO1xuICAgIHZhciAkaW5wdXRUeHQgPSAkKFwiPGlucHV0IHR5cGU9J3RleHQnIHN0eWxlPSd3aWR0aDogOTAlJyByZWFkb25seSAvPlwiKTtcbiAgICAkaW5wdXRUeHQuYXR0cihcImZpZWxkRGVmYXVsdFR5cGVcIiwgZmllbGREZWZhdWx0VHlwZSk7XG4gICAgJGlucHV0VHh0LmF0dHIoXCJmaWVsZERlZmF1bHRWYWx1ZVwiLCBmaWVsZERlZmF1bHRWYWx1ZSk7XG4gICAgJGlucHV0VHh0LmF0dHIoXCJmaWVsZERlZmF1bHRUZXh0XCIsIGZpZWxkRGVmYXVsdFRleHQpO1xuICAgICRpbnB1dFR4dC52YWwoRGVmYXVsdFZhbHVlVXRpbGl0eS5mb3JtYXRUZXh0KGZpZWxkRGVmYXVsdFR5cGUsIGZpZWxkRGVmYXVsdFRleHQpKTtcbiAgICB2YXIgJGlucHV0QnRuID0gJChcIjxpbnB1dCBjbGFzcz0nbm9ybWFsYnV0dG9uLXYxJyBzdHlsZT0nbWFyZ2luLWxlZnQ6IDRweDsnIHR5cGU9J2J1dHRvbicgdmFsdWU9Jy4uLicvPlwiKTtcbiAgICAkZWxlbS5hcHBlbmQoJGlucHV0VHh0KS5hcHBlbmQoJGlucHV0QnRuKTtcbiAgICB3aW5kb3cuJFRlbXAkSW5wdXR0eHQgPSAkaW5wdXRUeHQ7XG4gICAgJGlucHV0QnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh3aW5kb3cudGFibGVEZXNpb24pIHtcbiAgICAgICAgdGFibGVEZXNpb24uc2VsZWN0RGVmYXVsdFZhbHVlRGlhbG9nQmVnaW4oRWRpdFRhYmxlX1NlbGVjdERlZmF1bHRWYWx1ZSwgbnVsbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3aW5kb3cucGFyZW50Lmxpc3REZXNpZ24uc2VsZWN0RGVmYXVsdFZhbHVlRGlhbG9nQmVnaW4od2luZG93LCBudWxsKTtcbiAgICAgICAgd2luZG93Ll9TZWxlY3RCaW5kT2JqID0ge1xuICAgICAgICAgIHNldFNlbGVjdEVudlZhcmlhYmxlUmVzdWx0VmFsdWU6IGZ1bmN0aW9uIHNldFNlbGVjdEVudlZhcmlhYmxlUmVzdWx0VmFsdWUocmVzdWx0KSB7XG4gICAgICAgICAgICBFZGl0VGFibGVfU2VsZWN0RGVmYXVsdFZhbHVlLnNldFNlbGVjdEVudlZhcmlhYmxlUmVzdWx0VmFsdWUocmVzdWx0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuICRlbGVtO1xuICB9LFxuICBHZXRfQ29tcGxldGVkU3RhdHVzX0h0bWxFbGVtOiBmdW5jdGlvbiBHZXRfQ29tcGxldGVkU3RhdHVzX0h0bWxFbGVtKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCBlZGl0U3RhdXNIdG1sRWxlbSkge1xuICAgIHZhciAkaW5wdXRUeHQgPSBlZGl0U3RhdXNIdG1sRWxlbS5maW5kKFwiaW5wdXRbdHlwZT0ndGV4dCddXCIpO1xuXG4gICAgaWYgKCRpbnB1dFR4dC5sZW5ndGggPiAwKSB7XG4gICAgICB2YXIgZGVmYXVsdFR5cGUgPSAkaW5wdXRUeHQuYXR0cihcImZpZWxkRGVmYXVsdFR5cGVcIik7XG4gICAgICB2YXIgZGVmYXVsdFZhbHVlID0gJGlucHV0VHh0LmF0dHIoXCJmaWVsZERlZmF1bHRWYWx1ZVwiKTtcbiAgICAgIHZhciBkZWZhdWx0VGV4dCA9ICRpbnB1dFR4dC5hdHRyKFwiZmllbGREZWZhdWx0VGV4dFwiKTtcbiAgICAgIHZhciAkZWxlbSA9ICQoXCI8ZGl2PjwvZGl2PlwiKTtcbiAgICAgICRlbGVtLmFwcGVuZChcIjxsYWJlbD5cIiArIERlZmF1bHRWYWx1ZVV0aWxpdHkuZm9ybWF0VGV4dChkZWZhdWx0VHlwZSwgZGVmYXVsdFRleHQpICsgXCI8L2xhYmVsPlwiKTtcbiAgICAgICRlbGVtLmFwcGVuZChcIjxsYWJlbCBJc1NlcmlhbGl6ZT0ndHJ1ZScgQmluZE5hbWU9J2ZpZWxkRGVmYXVsdFR5cGUnIFZhbHVlPSdcIiArIGRlZmF1bHRUeXBlICsgXCInIHN0eWxlPSdkaXNwbGF5Om5vbmUnLz5cIik7XG4gICAgICAkZWxlbS5hcHBlbmQoXCI8bGFiZWwgSXNTZXJpYWxpemU9J3RydWUnIEJpbmROYW1lPSdmaWVsZERlZmF1bHRUZXh0JyBWYWx1ZT0nXCIgKyBkZWZhdWx0VGV4dCArIFwiJyBzdHlsZT0nZGlzcGxheTpub25lJy8+XCIpO1xuICAgICAgJGVsZW0uYXBwZW5kKFwiPGxhYmVsIElzU2VyaWFsaXplPSd0cnVlJyBCaW5kTmFtZT0nZmllbGREZWZhdWx0VmFsdWUnIFZhbHVlPSdcIiArIGRlZmF1bHRWYWx1ZSArIFwiJyBzdHlsZT0nZGlzcGxheTpub25lJy8+XCIpO1xuICAgICAgcmV0dXJuICRlbGVtO1xuICAgIH1cblxuICAgIHJldHVybiAkKFwiPGxhYmVsPjwvbGFiZWw+XCIpO1xuICB9LFxuICBWYWxpZGF0ZVRvQ29tcGxldGVkRW5hYmxlOiBmdW5jdGlvbiBWYWxpZGF0ZVRvQ29tcGxldGVkRW5hYmxlKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCBlZGl0U3RhdXNIdG1sRWxlbSkge1xuICAgIHZhciB2YWwgPSBlZGl0U3RhdXNIdG1sRWxlbS52YWwoKTtcbiAgICByZXR1cm4gRWRpdFRhYmxlVmFsaWRhdGUuVmFsaWRhdGUodmFsLCB0ZW1wbGF0ZSk7XG4gIH0sXG4gIHNldFNlbGVjdEVudlZhcmlhYmxlUmVzdWx0VmFsdWU6IGZ1bmN0aW9uIHNldFNlbGVjdEVudlZhcmlhYmxlUmVzdWx0VmFsdWUoZGVmYXVsdERhdGEpIHtcbiAgICB2YXIgJGlucHV0VHh0ID0gd2luZG93LiRUZW1wJElucHV0dHh0O1xuXG4gICAgaWYgKG51bGwgIT0gZGVmYXVsdERhdGEpIHtcbiAgICAgICRpbnB1dFR4dC5hdHRyKFwiZmllbGREZWZhdWx0VHlwZVwiLCBkZWZhdWx0RGF0YS5UeXBlKTtcbiAgICAgICRpbnB1dFR4dC5hdHRyKFwiZmllbGREZWZhdWx0VmFsdWVcIiwgZGVmYXVsdERhdGEuVmFsdWUpO1xuICAgICAgJGlucHV0VHh0LmF0dHIoXCJmaWVsZERlZmF1bHRUZXh0XCIsIGRlZmF1bHREYXRhLlRleHQpO1xuICAgICAgJGlucHV0VHh0LnZhbChEZWZhdWx0VmFsdWVVdGlsaXR5LmZvcm1hdFRleHQoZGVmYXVsdERhdGEuVHlwZSwgZGVmYXVsdERhdGEuVGV4dCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkaW5wdXRUeHQuYXR0cihcImZpZWxkRGVmYXVsdFR5cGVcIiwgXCJcIik7XG4gICAgICAkaW5wdXRUeHQuYXR0cihcImZpZWxkRGVmYXVsdFZhbHVlXCIsIFwiXCIpO1xuICAgICAgJGlucHV0VHh0LmF0dHIoXCJmaWVsZERlZmF1bHRUZXh0XCIsIFwiXCIpO1xuICAgICAgJGlucHV0VHh0LnZhbChcIlwiKTtcbiAgICB9XG4gIH1cbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBFZGl0VGFibGVfU2VsZWN0RmllbGRUeXBlRGF0YUxvYWRlciA9IHtcbiAgX2ZpZWxkRGF0YVR5cGVBcnJheTogbnVsbCxcbiAgR2V0RmllbGREYXRhVHlwZUFycmF5OiBmdW5jdGlvbiBHZXRGaWVsZERhdGFUeXBlQXJyYXkoKSB7XG4gICAgaWYgKHRoaXMuX2ZpZWxkRGF0YVR5cGVBcnJheSA9PSBudWxsKSB7XG4gICAgICB2YXIgX3NlbGYgPSB0aGlzO1xuXG4gICAgICBBamF4VXRpbGl0eS5Qb3N0U3luYyhcIi9SZXN0L0J1aWxkZXIvRGF0YVN0b3JhZ2UvRGF0YUJhc2UvVGFibGUvR2V0VGFibGVGaWVsZFR5cGVcIiwge30sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MgPT0gdHJ1ZSkge1xuICAgICAgICAgIHZhciBsaXN0ID0gSnNvblV0aWxpdHkuU3RyaW5nVG9Kc29uKGRhdGEuZGF0YSk7XG5cbiAgICAgICAgICBpZiAobGlzdCAhPSBudWxsICYmIGxpc3QgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBfc2VsZi5fZmllbGREYXRhVHlwZUFycmF5ID0gbGlzdDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgRGlhbG9nVXRpbGl0eS5BbGVydCh3aW5kb3csIFwiQWxlcnRMb2FkaW5nUXVlcnlFcnJvclwiLCB7fSwgXCLliqDovb3lrZfmrrXnsbvlnovlpLHotKXvvIFcIiwgbnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLl9maWVsZERhdGFUeXBlQXJyYXk7XG4gIH0sXG4gIEdldEZpZWxkRGF0YVR5cGVPYmplY3RCeVZhbHVlOiBmdW5jdGlvbiBHZXRGaWVsZERhdGFUeXBlT2JqZWN0QnlWYWx1ZShWYWx1ZSkge1xuICAgIHZhciBhcnJheURhdGEgPSB0aGlzLkdldEZpZWxkRGF0YVR5cGVBcnJheSgpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBvYmogPSBhcnJheURhdGFbaV07XG5cbiAgICAgIGlmIChvYmouVmFsdWUgPT0gVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBhbGVydChcIuaJvuS4jeWIsOaMh+WumueahOaVsOaNruexu+Wei++8jOivt+ehruiupOaYr+WQpuaUr+aMgeivpeexu+Wei++8gVwiKTtcbiAgfSxcbiAgR2V0RmllbGREYXRhVHlwZU9iamVjdEJ5VGV4dDogZnVuY3Rpb24gR2V0RmllbGREYXRhVHlwZU9iamVjdEJ5VGV4dCh0ZXh0KSB7XG4gICAgdmFyIGFycmF5RGF0YSA9IHRoaXMuR2V0RmllbGREYXRhVHlwZUFycmF5KCk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5RGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIG9iaiA9IGFycmF5RGF0YVtpXTtcblxuICAgICAgaWYgKG9iai5UZXh0ID09IHRleHQpIHtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBhbGVydChcIuaJvuS4jeWIsOaMh+WumueahOaVsOaNruexu+Wei++8jOivt+ehruiupOaYr+WQpuaUr+aMgeivpeexu+Wei++8gVwiKTtcbiAgfVxufTtcbnZhciBFZGl0VGFibGVfU2VsZWN0RmllbGRUeXBlID0ge1xuICBHZXRfRWRpdFN0YXR1c19IdG1sRWxlbTogZnVuY3Rpb24gR2V0X0VkaXRTdGF0dXNfSHRtbEVsZW0oX2NvbmZpZywgdGVtcGxhdGUsIGhvc3RDZWxsLCBob3N0Um93LCBob3N0VGFibGUsIHZpZXdTdGF1c0h0bWxFbGVtLCBqc29uRGF0YXMsIGpzb25EYXRhU2luZ2xlKSB7XG4gICAgdmFyIHZhbCA9IFwiXCI7XG4gICAgdmFyICRlbGVtID0gJChcIjxzZWxlY3QgLz5cIik7XG5cbiAgICBpZiAoanNvbkRhdGFTaW5nbGUgIT0gbnVsbCAmJiBqc29uRGF0YVNpbmdsZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgIHZhbCA9IGpzb25EYXRhU2luZ2xlW1wiZmllbGREYXRhVHlwZVwiXTtcbiAgICB9XG5cbiAgICBpZiAodmlld1N0YXVzSHRtbEVsZW0gIT0gbnVsbCAmJiB2aWV3U3RhdXNIdG1sRWxlbSAhPSB1bmRlZmluZWQpIHtcbiAgICAgIHZhbCA9IHZpZXdTdGF1c0h0bWxFbGVtLmF0dHIoXCJWYWx1ZVwiKTtcbiAgICB9XG5cbiAgICB2YXIgX2ZpZWxkRGF0YVR5cGVBcnJheSA9IEVkaXRUYWJsZV9TZWxlY3RGaWVsZFR5cGVEYXRhTG9hZGVyLkdldEZpZWxkRGF0YVR5cGVBcnJheSgpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBfZmllbGREYXRhVHlwZUFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgdmFsdWUgPSBfZmllbGREYXRhVHlwZUFycmF5W2ldLlZhbHVlO1xuICAgICAgdmFyIHRleHQgPSBfZmllbGREYXRhVHlwZUFycmF5W2ldLlRleHQ7XG4gICAgICAkZWxlbS5hcHBlbmQoXCI8b3B0aW9uIHZhbHVlPSdcIiArIHZhbHVlICsgXCInPlwiICsgdGV4dCArIFwiPC9vcHRpb24+XCIpO1xuICAgIH1cblxuICAgIGlmICh2YWwgIT0gXCJcIikge1xuICAgICAgJGVsZW0udmFsKHZhbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICRlbGVtLnZhbChFZGl0VGFibGVfU2VsZWN0RmllbGRUeXBlRGF0YUxvYWRlci5HZXRGaWVsZERhdGFUeXBlT2JqZWN0QnlUZXh0KFwi5a2X56ym5LiyXCIpLlZhbHVlKTtcbiAgICB9XG5cbiAgICAkZWxlbS5jaGFuZ2UoZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHZhbCA9ICQodGhpcykudmFsKCk7XG5cbiAgICAgIGlmICh2YWwgPT0gXCLmlbTmlbBcIikge1xuICAgICAgICAkKGhvc3RDZWxsKS5uZXh0KCkuZmluZChcImlucHV0XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCB0cnVlKTtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS52YWwoMCk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5uZXh0KCkuZmluZChcImlucHV0XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCB0cnVlKTtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLm5leHQoKS5maW5kKFwiaW5wdXRcIikudmFsKDApO1xuICAgICAgfSBlbHNlIGlmICh2YWwgPT0gXCLlsI/mlbBcIikge1xuICAgICAgICAkKGhvc3RDZWxsKS5uZXh0KCkuZmluZChcImlucHV0XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCBmYWxzZSk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5maW5kKFwiaW5wdXRcIikudmFsKDEwKTtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLm5leHQoKS5maW5kKFwiaW5wdXRcIikuYXR0cihcImRpc2FibGVkXCIsIGZhbHNlKTtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLm5leHQoKS5maW5kKFwiaW5wdXRcIikudmFsKDIpO1xuICAgICAgfSBlbHNlIGlmICh2YWwgPT0gXCLml6XmnJ/ml7bpl7RcIikge1xuICAgICAgICAkKGhvc3RDZWxsKS5uZXh0KCkuZmluZChcImlucHV0XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCB0cnVlKTtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS52YWwoMjApO1xuICAgICAgICAkKGhvc3RDZWxsKS5uZXh0KCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5uZXh0KCkuZmluZChcImlucHV0XCIpLnZhbCgwKTtcbiAgICAgIH0gZWxzZSBpZiAodmFsID09IFwi5a2X56ym5LiyXCIpIHtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS5hdHRyKFwiZGlzYWJsZWRcIiwgZmFsc2UpO1xuICAgICAgICAkKGhvc3RDZWxsKS5uZXh0KCkuZmluZChcImlucHV0XCIpLnZhbCg1MCk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5uZXh0KCkuZmluZChcImlucHV0XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCB0cnVlKTtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLm5leHQoKS5maW5kKFwiaW5wdXRcIikudmFsKDApO1xuICAgICAgfSBlbHNlIGlmICh2YWwgPT0gXCLplb/lrZfnrKbkuLJcIikge1xuICAgICAgICAkKGhvc3RDZWxsKS5uZXh0KCkuZmluZChcImlucHV0XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCB0cnVlKTtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLmZpbmQoXCJpbnB1dFwiKS52YWwoMCk7XG4gICAgICAgICQoaG9zdENlbGwpLm5leHQoKS5uZXh0KCkuZmluZChcImlucHV0XCIpLmF0dHIoXCJkaXNhYmxlZFwiLCB0cnVlKTtcbiAgICAgICAgJChob3N0Q2VsbCkubmV4dCgpLm5leHQoKS5maW5kKFwiaW5wdXRcIikudmFsKDApO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiAkZWxlbTtcbiAgfSxcbiAgR2V0X0NvbXBsZXRlZFN0YXR1c19IdG1sRWxlbTogZnVuY3Rpb24gR2V0X0NvbXBsZXRlZFN0YXR1c19IdG1sRWxlbShfY29uZmlnLCB0ZW1wbGF0ZSwgaG9zdENlbGwsIGhvc3RSb3csIGhvc3RUYWJsZSwgZWRpdFN0YXVzSHRtbEVsZW0pIHtcbiAgICB2YXIgdmFsdWUgPSBlZGl0U3RhdXNIdG1sRWxlbS52YWwoKTtcbiAgICB2YXIgdGV4dCA9IEVkaXRUYWJsZV9TZWxlY3RGaWVsZFR5cGVEYXRhTG9hZGVyLkdldEZpZWxkRGF0YVR5cGVPYmplY3RCeVZhbHVlKHZhbHVlKS5UZXh0O1xuICAgIHZhciAkZWxlbSA9ICQoXCI8bGFiZWwgSXNTZXJpYWxpemU9J3RydWUnIEJpbmROYW1lPSdcIiArIHRlbXBsYXRlLkJpbmROYW1lICsgXCInIFZhbHVlPSdcIiArIHZhbHVlICsgXCInPlwiICsgdGV4dCArIFwiPC9sYWJlbD5cIik7XG4gICAgcmV0dXJuICRlbGVtO1xuICB9LFxuICBWYWxpZGF0ZVRvQ29tcGxldGVkRW5hYmxlOiBmdW5jdGlvbiBWYWxpZGF0ZVRvQ29tcGxldGVkRW5hYmxlKF9jb25maWcsIHRlbXBsYXRlLCBob3N0Q2VsbCwgaG9zdFJvdywgaG9zdFRhYmxlLCBlZGl0U3RhdXNIdG1sRWxlbSkge1xuICAgIHZhciB2YWwgPSBlZGl0U3RhdXNIdG1sRWxlbS52YWwoKTtcbiAgICByZXR1cm4gRWRpdFRhYmxlVmFsaWRhdGUuVmFsaWRhdGUodmFsLCB0ZW1wbGF0ZSk7XG4gIH1cbn07Il19
