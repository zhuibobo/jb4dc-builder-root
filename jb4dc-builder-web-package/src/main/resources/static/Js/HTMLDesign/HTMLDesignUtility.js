"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var CKEditorPluginUtility=function(){function s(){_classCallCheck(this,s)}return _createClass(s,null,[{key:"AddPluginsServerConfig",value:function(e,t,i,n,o,r,a,l,s,u,d,c,m,f){this.PluginsServerConfig[e]={SingleName:e,ToolbarLocation:t,ToolbarLabel:i,ClientResolve:n,ServerResolve:o,ClientResolveJs:r,DialogWidth:a,DialogHeight:l,IsJBuild4DCData:s,ControlCategory:u,ServerDynamicBind:d,ShowRemoveButton:c,ShowInEditorToolbar:m,EnableChildControls:f}}},{key:"_UseServerConfigCoverEmptyPluginProp",value:function(e){var t=this.PluginsServerConfig[e.SingleName];if(t){for(var i in e)"function"!=typeof e[i]&&(""!=e[i]&&null!=e[i]||t[i]&&(e[i]=t[i]));return e}return null}},{key:"GetGeneralPluginInstance",value:function(e,t){var i={SingleName:e,DialogName:"",DialogWidth:null,DialogHeight:null,DialogPageUrl:BaseUtility.AppendTimeStampUrl("Dialog.html"),DialogTitle:"DIV",ToolbarCommand:"",ToolbarIcon:"Icon.png",ToolbarLabel:"",ToolbarLocation:"",IFrameWindow:null,IFrameExecuteActionName:"Insert",DesignModalInputCss:"",ClientResolve:"",ServerResolve:"",IsJBuild4DCData:"",ControlCategory:"",ServerDynamicBind:"",ShowRemoveButton:"",ShowInEditorToolbar:"",EnableChildControls:""};return i=$.extend(!0,{},i,t),null!=(i=s._UseServerConfigCoverEmptyPluginProp(i))?(i.DialogName=i.SingleName,i.ToolbarCommand="JBuild4DC.FormDesign.Plugins."+i.SingleName,i.DialogSettingTitle=i.ToolbarLabel+"Web控件",{Setting:i}):{}}},{key:"GetEnableChildControls",value:function(e){return this.Plugins[e].Setting.EnableChildControls}},{key:"GetPlugins",value:function(){return this.Plugins}},{key:"RegGeneralPluginToEditor",value:function(t,e,i,n){CKEDITOR.dialog.addIframe(i.DialogName,i.DialogSettingTitle,e+i.DialogPageUrl,i.DialogWidth,i.DialogHeight,function(){var e=document.getElementById(this._.frameId);i.IFrameWindow=e,s.SetElemPropsInEditDialog(i.IFrameWindow,i.IFrameExecuteActionName)},{onOk:function(){var e=i.IFrameWindow.contentWindow.DialogApp.getControlProps();if(0==e.success)return!1;n(t,i,e,i.IFrameWindow.contentWindow),i.IFrameExecuteActionName=s.DialogExecuteInsertActionName},onCancel:function(){i.IFrameExecuteActionName=s.DialogExecuteInsertActionName}}),t.addCommand(i.ToolbarCommand,new CKEDITOR.dialogCommand(i.DialogName)),"true"==i.ShowInEditorToolbar&&t.ui.addButton(i.SingleName,{label:i.ToolbarLabel,icon:e+i.ToolbarIcon,command:i.ToolbarCommand,toolbar:i.ToolbarLocation}),t.on("doubleclick",function(e){s.OnCKWysiwygElemDBClickEvent(e,i)})}},{key:"OnCKWysiwygElemDBClickEvent",value:function(e,t){var i=e.data.element;"true"==i.getAttribute("runtime_auto_remove")&&(i=e.data.element.getParent()),i.getAttribute("singleName")==t.SingleName&&(CKEditorUtility.SetSelectedElem(i.getOuterHtml()),e.data.dialog=t.DialogName,t.IFrameExecuteActionName=s.DialogExecuteEditActionName)}},{key:"SerializePropsToElem",value:function(e,t,i){if(e.setAttribute("jbuild4dc_custom","true"),e.setAttribute("singlename",i.SingleName),e.setAttribute("is_jbuild4dc_data",i.IsJBuild4DCData),e.setAttribute("control_category",i.ControlCategory),e.setAttribute("show_remove_button",i.ShowRemoveButton),t.baseInfo)for(var n in t.baseInfo)"readonly"==n?"readonly"==t.baseInfo[n]?e.setAttribute(n.toLocaleLowerCase(),t.baseInfo[n]):e.removeAttribute("readonly"):"disabled"==n?"disabled"==t.baseInfo[n]?e.setAttribute(n.toLocaleLowerCase(),t.baseInfo[n]):e.removeAttribute("disabled"):e.setAttribute(n.toLocaleLowerCase(),t.baseInfo[n]);if(t.bindToField)for(var n in t.bindToField)e.setAttribute(n.toLocaleLowerCase(),t.bindToField[n]);if(t.defaultValue)for(var n in t.defaultValue)e.setAttribute(n.toLocaleLowerCase(),t.defaultValue[n]);if(t.validateRules&&t.validateRules.rules&&0<t.validateRules.rules.length&&e.setAttribute("validaterules",encodeURIComponent(JsonUtility.JsonToString(t.validateRules))),t.normalProps)for(var n in t.normalProps)e.setAttribute(n.toLocaleLowerCase(),t.normalProps[n]);if(t.bindToSearchField)for(var n in t.bindToSearchField)e.setAttribute(n.toLocaleLowerCase(),t.bindToSearchField[n]);if(t.normalDataSource)for(var n in t.normalDataSource)e.setAttribute(n.toLocaleLowerCase(),t.normalDataSource[n]);return e}},{key:"DeserializePropsFromElem",value:function(e){var t={},o=$(e);function i(e,t){var i={};for(var n in this.DefaultProps[t])o.attr(n)?i[n]=o.attr(n):i[n]=this.DefaultProps[t][n];return e[t]=i,e}return t=i.call(this,t,"baseInfo"),t=i.call(this,t,"bindToField"),t=i.call(this,t,"defaultValue"),t=i.call(this,t,"bindToSearchField"),t=i.call(this,t,"normalDataSource"),o.attr("validateRules")&&(t.validateRules=JsonUtility.StringToJson(decodeURIComponent(o.attr("validateRules")))),t}},{key:"BuildGeneralElemToCKWysiwyg",value:function(e,t,i,n){if(this.ValidateBuildEnable(e,t,i,n))if(console.log("IFrameExecuteActionName:"+t.IFrameExecuteActionName),t.IFrameExecuteActionName==s.DialogExecuteInsertActionName){var o=CKEDITOR.dom.element.createFromHtml(e);this.SerializePropsToElem(o,i,t),CKEditorUtility.GetCKEditorInst().insertElement(o),CKEditorUtility.SingleElemBindDefaultEvent(o)}else{var r=CKEditorUtility.GetSelectedCKEditorElem();if(r){var a=new CKEDITOR.dom.element.createFromHtml(r.getOuterHtml());if("InputControl"==a.getAttribute("control_category")){var l=$(e).text();a.setText(l)}r.copyAttributes(a,{temp:"temp"}),this.SerializePropsToElem(a,i,t),a.replace(r),CKEditorUtility.SingleElemBindDefaultEvent(a)}}}},{key:"ValidateBuildEnable",value:function(e,t,i,n){return!0}},{key:"ValidateSerializeControlDialogCompletedEnable",value:function(e){return"true"==e.baseInfo.serialize&&""==e.bindToField.fieldName?(DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"序列化的控件必须绑定字段!",null),{success:!1}):e}},{key:"SetElemPropsInEditDialog",value:function(e,t){var i=CKEditorUtility.GetCKEditorInst().getSelection().getStartElement(),n=null;if(i&&(n=i.getParents()),e.contentWindow.DialogApp.ready(t,i,n),t==this.DialogExecuteEditActionName){var o=CKEditorUtility.GetSelectedElem().outerHTML(),r=this.DeserializePropsFromElem(o);e.contentWindow.DialogApp.setControlProps($(o),r)}}},{key:"GetControlDescText",value:function(e,t){console.log(t);var i="类型:【"+e.ToolbarLabel+"】<br />绑定:【"+t.bindToField.tableCaption+"-"+t.bindToField.fieldCaption+"】";if(t.defaultValue&&t.defaultValue.defaultText&&(i+="<br />默认:【"+t.defaultValue.defaultType+":"+t.defaultValue.defaultText+"】"),t.validateRules&&t.validateRules.rules&&0<t.validateRules.rules.length){i+="<br />验证:【";for(var n=0;n<t.validateRules.rules.length;n++)i+=t.validateRules.rules[n].validateType+";";i=StringUtility.RemoveLastChar(i),i+="】"}return i}},{key:"GetSearchControlDescText",value:function(e,t){return"["+e.ToolbarLabel+"] 绑定:["+t.bindToSearchField.columnCaption+"]("+t.bindToSearchField.columnOperator+")"}},{key:"GetAutoRemoveTipLabel",value:function(e){return e||(e="双击编辑该部件"),'<div runtime_auto_remove="true" class="wysiwyg-auto-remove-tip">'+e+"</div>"}},{key:"TryGetListButtonsInPluginPage",value:function(){var i=[],e=CKEditorUtility.GetCKEditorHTMLInPluginPage();return $(e).find("[buttoncaption]").each(function(){var e=$(this).attr("buttoncaption"),t=$(this).attr("id");i.push({buttonCaption:e,buttonId:t})}),i}},{key:"TryGetDataSetId",value:function(e,t){if(e)for(var i=t.length-1;i--;0<=i)if(null!=t[i].getAttribute("datasetid")&&""!=t[i].getAttribute("datasetid"))return t[i].getAttribute("datasetid");return this.dataSetId?null:window.parent.listDesign.listResourceEntity.listDatasetId}},{key:"TemplateAddDefProp",value:function(e,t,i,n,o){e.attr("classname",""),e.attr("control_category","ContainerControl"),e.attr("custdisabled","nodisabled"),e.attr("custreadonly","noreadonly"),e.attr("desc",""),e.attr("id",t),e.attr("is_jbuild4dc_data","false"),e.attr("jbuild4dc_custom","true"),e.attr("name",t),e.attr("placeholder",""),e.attr("serialize","false"),e.attr("show_remove_button",i),e.attr("singlename",n),e.attr("style",""),e.attr("status",o)}}]),s}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}_defineProperty(CKEditorPluginUtility,"PluginsServerConfig",{}),_defineProperty(CKEditorPluginUtility,"Plugins",{}),_defineProperty(CKEditorPluginUtility,"DefaultProps",{bindToField:{relationId:"",tableId:"",tableName:"",tableCaption:"",fieldName:"",fieldCaption:"",fieldDataType:"",fieldLength:""},defaultValue:{defaultType:"",defaultValue:"",defaultText:""},validateRules:{msg:"",rules:[]},baseInfo:{id:"",serialize:"true",name:"",className:"",placeholder:"",custReadonly:"noreadonly",custDisabled:"nodisabled",style:"",desc:"",status:"enable"},bindToSearchField:{columnTitle:"",columnTableName:"",columnName:"",columnCaption:"",columnDataTypeName:"",columnOperator:"匹配"},normalDataSource:{defaultIsNull:"true",sqlDataSource:"",dictionaryIdDataSource:"",restDataSource:"",staticDataSource:""}}),_defineProperty(CKEditorPluginUtility,"DialogExecuteEditActionName","Edit"),_defineProperty(CKEditorPluginUtility,"DialogExecuteInsertActionName","Insert");var CKEditorUtility=function(){function D(){_classCallCheck(this,D)}return _createClass(D,null,[{key:"SetSelectedElem",value:function(e){this._$CKEditorSelectElem=$(e)}},{key:"GetSelectedElem",value:function(){return this._$CKEditorSelectElem&&0<this._$CKEditorSelectElem.length?this._$CKEditorSelectElem:null}},{key:"GetSelectedCKEditorElem",value:function(){if(this.GetSelectedElem()){var e=this.GetSelectedElem().attr("id");return this.GetCKEditorInst().document.getById(e)}return null}},{key:"SetLastSelectedTempHTML",value:function(e){this._LastSelectedTempHTML=e}},{key:"GetLastSelectedTempHTML",value:function(){return this._LastSelectedTempHTML}},{key:"TryGetIdFromLastSelectedTempHTML",value:function(e){return this._LastSelectedTempHTML&&$(e).attr("name")==$(this.GetLastSelectedTempHTML()).attr("name")?$(this.GetLastSelectedTempHTML()).attr("id"):""}},{key:"GetCKEditorInst",value:function(){return this._CKEditorInst}},{key:"SetCKEditorInst",value:function(e){this._CKEditorInst=e}},{key:"GetCKEditorHTML",value:function(){return this.ClearALLForDivElemButton(),this.ClearALLPluginInnerPanel(),this.GetCKEditorInst().getData()}},{key:"SetCKEditorHTML",value:function(e){this.GetCKEditorInst().setData(e),window.setTimeout(function(){D.ALLElemBindDefaultEvent()},500)}},{key:"GetCKEditorHTMLInPluginPage",value:function(){return window.parent.CKEditorUtility.GetCKEditorHTML()}},{key:"InitializeCKEditor",value:function(e,t,i,n,o,r){for(var a=new Array,l=0;l<t.length;l++){var s=t[l],u=s.singleName,d=s.toolbarLocation,c=s.text,m=s.serverResolve,f=s.clientResolve,g=s.clientResolveJs,C=s.dialogWidth,v=s.dialogHeight,E=s.isJBuild4DCData,y=s.controlCategory,p=s.serverDynamicBind,h=s.showRemoveButton,b=s.showInEditorToolbar,T=s.enableChildControls,I=u+"Plugin.js",S=o+u+"/";CKEDITOR.plugins.addExternal(u,S,I),a.push(u),CKEditorPluginUtility.AddPluginsServerConfig(u,d,c,f,m,g,C,v,E,y,p,h,b,T)}this.SetThemeVo(r);var P=BaseUtility.AppendTimeStampUrl(n);CKEDITOR.replace(e,{customConfig:P,extraPlugins:a.join(",")}),CKEDITOR.instances.html_design.on("beforePaste",function(e){}),CKEDITOR.instances.html_design.on("paste",function(t){var i=t.data.dataValue;console.log(i);try{var e=$(i);if(e.find(".pluginInnerPanelWrap").remove(),1==e.find("div").length){var n=$(e.find("div").eq(0)),o=D.TryGetIdFromLastSelectedTempHTML(n);if(console.log(o),o)D.GetCKEditorInst().document.getById(o)&&(o="ct_copy_"+StringUtility.Timestamp());else o="ct_copy_"+StringUtility.Timestamp();t.data.dataValue=n.attr("id",o).outerHTML()}}catch(e){console.log("黏贴异常,还原HTML"),t.data.dataValue=i}}),CKEDITOR.instances.html_design.on("afterPaste",function(e){}),CKEDITOR.instances.html_design.on("insertElement",function(e){}),CKEDITOR.instances.html_design.on("insertHtml",function(e){}),CKEDITOR.instances.html_design.on("selectionChange",function(e){for(var t=e.data.selection.getSelectedElement(),i="",n=0;n<e.data.path.elements.length;n++){var o=(t=e.data.path.elements[n]).getAttribute("singlename"),r=t.getHtml();if(o){i=o,D.SetSelectedElem(t.getOuterHtml()),D.SetLastSelectedTempHTML(t.getOuterHtml());var a=t.getHtml();(a=a.replace(/<br \/>/g,"").replace(/<br>/g,"")).indexOf("<")<0&&(console.log(t),D.GetCKEditorInst().getSelection().selectElement(t)),"WFDCT_Template"!=i&&D.CreatePluginInnerPanel(t);break}if("td"==t.getName()&&"&nbsp;"==r){D.GetCKEditorInst().getSelection().selectElement(t.getChild(0));break}}i&&D.DisplayPluginControls(CKEditorPluginUtility.GetEnableChildControls(i))}),this.SetCKEditorInst(CKEDITOR.instances.html_design),CKEDITOR.on("instanceReady",function(e){"function"==typeof i&&i()})}},{key:"DisplayPluginControls",value:function(e){if($(".cke_button").show(),"*"!=e){var t=CKEditorPluginUtility.GetPlugins();for(var i in t){var n=t[i].Setting.SingleName;$(".cke_button__"+StringUtility.ToLowerCase(n)).hide()}for(var o=e.split(";"),r=0;r<o.length;r++){n=o[r];$(".cke_button__"+StringUtility.ToLowerCase(n)).show()}}}},{key:"GetThemeVo",value:function(){return this._ThemeVo}},{key:"SetThemeVo",value:function(e){this._ThemeVo=e,this.ResetRootElemTheme(e)}},{key:"ResetRootElemTheme",value:function(e){if(this.GetCKEditorInst()){var t=this.GetCKEditorHTML();if(null!=t&&""!=t){var i=$(t);if(0<i.length){var n=i.attr("class").split(/\s+/);$.each(n,function(e,t){0<=t.indexOf("html-design-theme-")&&i.removeClass(t)}),i.addClass(e.rootElemClass),this.SetCKEditorHTML(i.outerHTML())}}}}},{key:"ClearALLForDivElemButton",value:function(){for(var e=D.GetCKEditorInst().document.find(".del-button"),t=0;t<e.count();t++)e.getItem(t).remove()}},{key:"CreatePluginInnerPanel",value:function(i){D.ClearALLPluginInnerPanel();var e=new CKEDITOR.dom.element("div");e.addClass("pluginInnerPanelWrap"),i.append(e);var t=new CKEDITOR.dom.element("div");t.addClass("button"),t.addClass("select-img"),t.setAttribute("title","选中"),e.append(t),t.on("click",function(e){alert("暂不支持!");var t=e.data;t.preventDefault(),t.stopPropagation()});var n=new CKEDITOR.dom.element("div");n.addClass("button"),n.addClass("del-img"),n.setAttribute("title","删除"),e.append(n),n.on("click",function(e){i.remove();var t=e.data;t.preventDefault(),t.stopPropagation()});var o=new CKEDITOR.dom.element("div");o.addClass("button"),o.addClass("copy-id-img"),o.setAttribute("title","复制ID"),e.append(o),o.on("click",function(e){alert("暂不支持!");var t=e.data;t.preventDefault(),t.stopPropagation()})}},{key:"ClearALLPluginInnerPanel",value:function(){for(var e=D.GetCKEditorInst().document.find(".pluginInnerPanelWrap"),t=0;t<e.count();t++)e.getItem(t).remove()}},{key:"SingleElemBindDefaultEvent",value:function(e){var t=e.getAttribute("singlename"),i=e.getHtml();(i=i.replace(/<br \/>/g,"")).indexOf("<")<0&&t&&e.on("click",function(e){console.log(this),D.GetCKEditorInst().getSelection().selectElement(this),D.SetSelectedElem(this.getOuterHtml());var t=e.data;t.preventDefault(),t.stopPropagation()})}},{key:"ALLElemBindDefaultEvent",value:function(){console.log("取消使用点击进行元素选择和删除的功能,迁移为selectionChange事件进行!")}}]),D}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}_defineProperty(CKEditorUtility,"_$CKEditorSelectElem",null),_defineProperty(CKEditorUtility,"_LastSelectedTempHTML",null),_defineProperty(CKEditorUtility,"_CKEditorInst",null),_defineProperty(CKEditorUtility,"_ThemeVo",null);var HTMLEditorUtility=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"GetHTMLEditorInst",value:function(){return this._HTMLEditorInst}},{key:"SetHTMLEditorHTML",value:function(e){if(!StringUtility.IsNullOrEmpty(e)){this.GetHTMLEditorInst().setValue(e),CodeMirror.commands.selectAll(this.GetHTMLEditorInst());var t={from:this.GetHTMLEditorInst().getCursor(!0),to:this.GetHTMLEditorInst().getCursor(!1)};this.GetHTMLEditorInst().autoFormatRange(t.from,t.to);this.GetHTMLEditorInst().getDoc().eachLine(function(e){});var i=CKEditorUtility.GetSelectedElem(),n="";i&&(n=i.outerHTML().split(">")[0]);var o=this.GetHTMLEditorInst().getSearchCursor(n);o.findNext(),o.from()&&o.to()&&this.GetHTMLEditorInst().getDoc().setSelection(o.from(),o.to())}}},{key:"GetHtmlEditorHTML",value:function(){return this.GetHTMLEditorInst().getValue()}},{key:"InitializeHTMLCodeDesign",value:function(){this._HTMLEditorInst=CodeMirror.fromTextArea(document.getElementById("TextAreaHTMLEditor"),{mode:{name:"htmlmixed",scriptTypes:[{matches:/\/x-handlebars-template|\/x-mustache/i,mode:null},{matches:/(text|application)\/(x-)?vb(a|script)/i,mode:"vbscript"}]},selectionPointer:!0,theme:"monokai",foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],lineNumbers:!0,lineWrapping:!0}),this._HTMLEditorInst.setSize("100%",PageStyleUtility.GetWindowHeight()-85)}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}_defineProperty(HTMLEditorUtility,"_HTMLEditorInst",null);var JsEditorUtility=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"_GetNewFormJsString",value:function(){return"<script>var FormPageObjectInstance={data:{userEntity:{},formEntity:[],config:[]},pageReady:function(){},bindRecordDataReady:function(){},validateEveryFromControl:function(controlObj){}}<\/script>"}},{key:"GetJsEditorInst",value:function(){return this._JsEditorInst}},{key:"SetJsEditorJs",value:function(e){this.GetJsEditorInst().setValue(e)}},{key:"GetJsEditorJs",value:function(){return this.GetJsEditorInst().getValue()}},{key:"InitializeJsCodeDesign",value:function(e){if(this._JsEditorInst=CodeMirror.fromTextArea($("#TextAreaJsEditor")[0],{mode:"application/ld+json",lineNumbers:!0,lineWrapping:!0,extraKeys:{"Ctrl-Q":function(e){e.foldCode(e.getCursor())}},foldGutter:!0,smartIndent:!0,matchBrackets:!0,theme:"monokai",gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]}),this._JsEditorInst.setSize("100%",PageStyleUtility.GetWindowHeight()-85),"add"==e){this.SetJsEditorJs(this._GetNewFormJsString()),CodeMirror.commands.selectAll(this.GetJsEditorInst());var t={from:this.GetJsEditorInst().getCursor(!0),to:this.GetJsEditorInst().getCursor(!1)};this.GetJsEditorInst().autoFormatRange(t.from,t.to)}}}]),e}();_defineProperty(JsEditorUtility,"_JsEditorInst",null);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNLRWRpdG9yUGx1Z2luVXRpbGl0eS5qcyIsIkNLRWRpdG9yVXRpbGl0eS5qcyIsIkhUTUxFZGl0b3JVdGlsaXR5LmpzIiwiSnNFZGl0b3JVdGlsaXR5LmpzIl0sIm5hbWVzIjpbIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsIl9jcmVhdGVDbGFzcyIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIl9kZWZpbmVQcm9wZXJ0eSIsIm9iaiIsInZhbHVlIiwiQ0tFZGl0b3JQbHVnaW5VdGlsaXR5IiwidGhpcyIsInNpbmdsZU5hbWUiLCJ0b29sYmFyTG9jYXRpb24iLCJ0ZXh0IiwiY2xpZW50UmVzb2x2ZSIsInNlcnZlclJlc29sdmUiLCJjbGllbnRSZXNvbHZlSnMiLCJkaWFsb2dXaWR0aCIsImRpYWxvZ0hlaWdodCIsImlzSkJ1aWxkNERDRGF0YSIsImNvbnRyb2xDYXRlZ29yeSIsInNlcnZlckR5bmFtaWNCaW5kIiwic2hvd1JlbW92ZUJ1dHRvbiIsInNob3dJbkVkaXRvclRvb2xiYXIiLCJlbmFibGVDaGlsZENvbnRyb2xzIiwiUGx1Z2luc1NlcnZlckNvbmZpZyIsIlNpbmdsZU5hbWUiLCJUb29sYmFyTG9jYXRpb24iLCJUb29sYmFyTGFiZWwiLCJDbGllbnRSZXNvbHZlIiwiU2VydmVyUmVzb2x2ZSIsIkNsaWVudFJlc29sdmVKcyIsIkRpYWxvZ1dpZHRoIiwiRGlhbG9nSGVpZ2h0IiwiSXNKQnVpbGQ0RENEYXRhIiwiQ29udHJvbENhdGVnb3J5IiwiU2VydmVyRHluYW1pY0JpbmQiLCJTaG93UmVtb3ZlQnV0dG9uIiwiU2hvd0luRWRpdG9yVG9vbGJhciIsIkVuYWJsZUNoaWxkQ29udHJvbHMiLCJjb3Zlck9iaiIsInByb3AiLCJwbHVnaW5TaW5nbGVOYW1lIiwiZXhDb25maWciLCJkZWZhdWx0U2V0dGluZyIsIkRpYWxvZ05hbWUiLCJEaWFsb2dQYWdlVXJsIiwiQmFzZVV0aWxpdHkiLCJBcHBlbmRUaW1lU3RhbXBVcmwiLCJEaWFsb2dUaXRsZSIsIlRvb2xiYXJDb21tYW5kIiwiVG9vbGJhckljb24iLCJJRnJhbWVXaW5kb3ciLCJJRnJhbWVFeGVjdXRlQWN0aW9uTmFtZSIsIkRlc2lnbk1vZGFsSW5wdXRDc3MiLCIkIiwiZXh0ZW5kIiwiX1VzZVNlcnZlckNvbmZpZ0NvdmVyRW1wdHlQbHVnaW5Qcm9wIiwiRGlhbG9nU2V0dGluZ1RpdGxlIiwiU2V0dGluZyIsIlBsdWdpbnMiLCJja0VkaXRvciIsInBhdGgiLCJwbHVnaW5TZXR0aW5nIiwib2tGdW5jIiwiQ0tFRElUT1IiLCJkaWFsb2ciLCJhZGRJZnJhbWUiLCJpZnJhbWUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiXyIsImZyYW1lSWQiLCJTZXRFbGVtUHJvcHNJbkVkaXREaWFsb2ciLCJvbk9rIiwiY29udGVudFdpbmRvdyIsIkRpYWxvZ0FwcCIsImdldENvbnRyb2xQcm9wcyIsInN1Y2Nlc3MiLCJEaWFsb2dFeGVjdXRlSW5zZXJ0QWN0aW9uTmFtZSIsIm9uQ2FuY2VsIiwiYWRkQ29tbWFuZCIsImRpYWxvZ0NvbW1hbmQiLCJ1aSIsImFkZEJ1dHRvbiIsImxhYmVsIiwiaWNvbiIsImNvbW1hbmQiLCJ0b29sYmFyIiwib24iLCJldmVudCIsIk9uQ0tXeXNpd3lnRWxlbURCQ2xpY2tFdmVudCIsImNvbnRyb2xTZXR0aW5nIiwiZWxlbWVudCIsImRhdGEiLCJnZXRBdHRyaWJ1dGUiLCJnZXRQYXJlbnQiLCJDS0VkaXRvclV0aWxpdHkiLCJTZXRTZWxlY3RlZEVsZW0iLCJnZXRPdXRlckh0bWwiLCJEaWFsb2dFeGVjdXRlRWRpdEFjdGlvbk5hbWUiLCJlbGVtIiwic2V0QXR0cmlidXRlIiwidG9Mb2NhbGVMb3dlckNhc2UiLCJyZW1vdmVBdHRyaWJ1dGUiLCJydWxlcyIsImVuY29kZVVSSUNvbXBvbmVudCIsIkpzb25VdGlsaXR5IiwiSnNvblRvU3RyaW5nIiwiJGVsZW0iLCJhdHRyVG9Qcm9wIiwiZ3JvdXBOYW1lIiwiZ3JvdXBQcm9wIiwiRGVmYXVsdFByb3BzIiwiYXR0ciIsImNhbGwiLCJ2YWxpZGF0ZVJ1bGVzIiwiU3RyaW5nVG9Kc29uIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiaHRtbCIsImNvbnRyb2xQcm9wcyIsIl9pZnJhbWUiLCJWYWxpZGF0ZUJ1aWxkRW5hYmxlIiwiY29uc29sZSIsImxvZyIsImRvbSIsImNyZWF0ZUZyb21IdG1sIiwiU2VyaWFsaXplUHJvcHNUb0VsZW0iLCJHZXRDS0VkaXRvckluc3QiLCJpbnNlcnRFbGVtZW50IiwiU2luZ2xlRWxlbUJpbmREZWZhdWx0RXZlbnQiLCJzZWxlY3RlZEVsZW0iLCJHZXRTZWxlY3RlZENLRWRpdG9yRWxlbSIsInJlRnJlc2hFbGVtIiwibmV3VGV4dCIsInNldFRleHQiLCJjb3B5QXR0cmlidXRlcyIsInRlbXAiLCJyZXBsYWNlIiwicmV0dXJuUmVzdWx0IiwiYmFzZUluZm8iLCJzZXJpYWxpemUiLCJiaW5kVG9GaWVsZCIsImZpZWxkTmFtZSIsIkRpYWxvZ1V0aWxpdHkiLCJBbGVydCIsIndpbmRvdyIsIkRpYWxvZ0FsZXJ0SWQiLCJpZnJhbWVPYmoiLCJhY3Rpb25OYW1lIiwic2VsIiwiZ2V0U2VsZWN0aW9uIiwiZ2V0U3RhcnRFbGVtZW50IiwicGFyZW50cyIsImdldFBhcmVudHMiLCJyZWFkeSIsIkdldFNlbGVjdGVkRWxlbSIsIm91dGVySFRNTCIsIkRlc2VyaWFsaXplUHJvcHNGcm9tRWxlbSIsInNldENvbnRyb2xQcm9wcyIsInJlc3VsdCIsInRhYmxlQ2FwdGlvbiIsImZpZWxkQ2FwdGlvbiIsImRlZmF1bHRWYWx1ZSIsImRlZmF1bHRUZXh0IiwiZGVmYXVsdFR5cGUiLCJ2YWxpZGF0ZVR5cGUiLCJTdHJpbmdVdGlsaXR5IiwiUmVtb3ZlTGFzdENoYXIiLCJiaW5kVG9TZWFyY2hGaWVsZCIsImNvbHVtbkNhcHRpb24iLCJjb2x1bW5PcGVyYXRvciIsInRpcE1zZyIsImJ1dHRvbnMiLCJHZXRDS0VkaXRvckhUTUxJblBsdWdpblBhZ2UiLCJmaW5kIiwiZWFjaCIsImJ1dHRvbkNhcHRpb24iLCJidXR0b25JZCIsInB1c2giLCJkYXRhU2V0SWQiLCJwYXJlbnQiLCJsaXN0RGVzaWduIiwibGlzdFJlc291cmNlRW50aXR5IiwibGlzdERhdGFzZXRJZCIsIiR0ZW1wbGF0ZUVsZW0iLCJpZCIsInNob3dfcmVtb3ZlX2J1dHRvbiIsInN0YXR1cyIsInJlbGF0aW9uSWQiLCJ0YWJsZUlkIiwidGFibGVOYW1lIiwiZmllbGREYXRhVHlwZSIsImZpZWxkTGVuZ3RoIiwibXNnIiwibmFtZSIsImNsYXNzTmFtZSIsInBsYWNlaG9sZGVyIiwiY3VzdFJlYWRvbmx5IiwiY3VzdERpc2FibGVkIiwic3R5bGUiLCJkZXNjIiwiY29sdW1uVGl0bGUiLCJjb2x1bW5UYWJsZU5hbWUiLCJjb2x1bW5OYW1lIiwiY29sdW1uRGF0YVR5cGVOYW1lIiwibm9ybWFsRGF0YVNvdXJjZSIsImRlZmF1bHRJc051bGwiLCJzcWxEYXRhU291cmNlIiwiZGljdGlvbmFyeUlkRGF0YVNvdXJjZSIsInJlc3REYXRhU291cmNlIiwic3RhdGljRGF0YVNvdXJjZSIsImVsZW1IdG1sIiwiXyRDS0VkaXRvclNlbGVjdEVsZW0iLCJnZXRCeUlkIiwiX0xhc3RTZWxlY3RlZFRlbXBIVE1MIiwibmV3SFRNTCIsIkdldExhc3RTZWxlY3RlZFRlbXBIVE1MIiwiX0NLRWRpdG9ySW5zdCIsImluc3QiLCJDbGVhckFMTEZvckRpdkVsZW1CdXR0b24iLCJDbGVhckFMTFBsdWdpbklubmVyUGFuZWwiLCJnZXREYXRhIiwic2V0RGF0YSIsInNldFRpbWVvdXQiLCJBTExFbGVtQmluZERlZmF1bHRFdmVudCIsIkdldENLRWRpdG9ySFRNTCIsInRleHRBcmVhRWxlbUlkIiwicGx1Z2luc0NvbmZpZyIsImxvYWRDb21wbGV0ZWRGdW5jIiwiY2tlZGl0b3JDb25maWdGdWxsUGF0aCIsInBsdWdpbkJhc2VQYXRoIiwidGhlbWVWbyIsImV4dHJhUGx1Z2lucyIsIkFycmF5Iiwic2luZ2xlUGx1Z2luQ29uZmlnIiwicGx1Z2luRmlsZU5hbWUiLCJwbHVnaW5Gb2xkZXJOYW1lIiwicGx1Z2lucyIsImFkZEV4dGVybmFsIiwiQWRkUGx1Z2luc1NlcnZlckNvbmZpZyIsIlNldFRoZW1lVm8iLCJlZGl0b3JDb25maWdVcmwiLCJjdXN0b21Db25maWciLCJqb2luIiwiaW5zdGFuY2VzIiwiaHRtbF9kZXNpZ24iLCJzb3VyY2VIVE1MIiwiZGF0YVZhbHVlIiwiJHNvdXJjZUhUTUwiLCJyZW1vdmUiLCIkaW5uZXJFbGVtIiwiZXEiLCJUcnlHZXRJZEZyb21MYXN0U2VsZWN0ZWRUZW1wSFRNTCIsIlRpbWVzdGFtcCIsImUiLCJzZWxlY3Rpb24iLCJnZXRTZWxlY3RlZEVsZW1lbnQiLCJsYXN0Q3VzdFNpbmdsZU5hbWUiLCJlbGVtZW50cyIsImVsZW1Jbm5lckhUTUwiLCJnZXRIdG1sIiwiU2V0TGFzdFNlbGVjdGVkVGVtcEhUTUwiLCJpbm5lckh0bWwiLCJpbmRleE9mIiwic2VsZWN0RWxlbWVudCIsIkNyZWF0ZVBsdWdpbklubmVyUGFuZWwiLCJnZXROYW1lIiwiZ2V0Q2hpbGQiLCJEaXNwbGF5UGx1Z2luQ29udHJvbHMiLCJHZXRFbmFibGVDaGlsZENvbnRyb2xzIiwiU2V0Q0tFZGl0b3JJbnN0Iiwic2hvdyIsIkdldFBsdWdpbnMiLCJUb0xvd2VyQ2FzZSIsImhpZGUiLCJlbmFibGVQbHVnaW5zIiwic3BsaXQiLCJfVGhlbWVWbyIsIl90aGVtZVZvIiwiUmVzZXRSb290RWxlbVRoZW1lIiwicm9vdEVsZW0iLCJjbGFzc0xpc3QiLCJpbmRleCIsIml0ZW0iLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwicm9vdEVsZW1DbGFzcyIsIlNldENLRWRpdG9ySFRNTCIsIm9sZERlbEJ1dHRvbnMiLCJjb3VudCIsImdldEl0ZW0iLCJwbHVnaW5Jbm5lclBhbmVsIiwiYXBwZW5kIiwic2VsZWN0QWxsQnV0dG9uIiwiZXYiLCJhbGVydCIsImRvbUV2ZW50IiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJkZWxCdXR0b24iLCJjb3B5SWRCdXR0b24iLCJIVE1MRWRpdG9yVXRpbGl0eSIsIl9IVE1MRWRpdG9ySW5zdCIsIklzTnVsbE9yRW1wdHkiLCJHZXRIVE1MRWRpdG9ySW5zdCIsInNldFZhbHVlIiwiQ29kZU1pcnJvciIsImNvbW1hbmRzIiwicmFuZ2UiLCJmcm9tIiwiZ2V0Q3Vyc29yIiwidG8iLCJhdXRvRm9ybWF0UmFuZ2UiLCJnZXREb2MiLCJlYWNoTGluZSIsImxpbmUiLCJzZWFyY2hIVE1MIiwiY3Vyc29yIiwiZ2V0U2VhcmNoQ3Vyc29yIiwiZmluZE5leHQiLCJzZXRTZWxlY3Rpb24iLCJnZXRWYWx1ZSIsImZyb21UZXh0QXJlYSIsIm1vZGUiLCJzY3JpcHRUeXBlcyIsIm1hdGNoZXMiLCJzZWxlY3Rpb25Qb2ludGVyIiwidGhlbWUiLCJmb2xkR3V0dGVyIiwiZ3V0dGVycyIsImxpbmVOdW1iZXJzIiwibGluZVdyYXBwaW5nIiwic2V0U2l6ZSIsIlBhZ2VTdHlsZVV0aWxpdHkiLCJHZXRXaW5kb3dIZWlnaHQiLCJKc0VkaXRvclV0aWxpdHkiLCJfSnNFZGl0b3JJbnN0IiwianMiLCJHZXRKc0VkaXRvckluc3QiLCJleHRyYUtleXMiLCJDdHJsLVEiLCJjbSIsImZvbGRDb2RlIiwic21hcnRJbmRlbnQiLCJtYXRjaEJyYWNrZXRzIiwiU2V0SnNFZGl0b3JKcyIsIl9HZXROZXdGb3JtSnNTdHJpbmciXSwibWFwcGluZ3MiOiJBQUFBLGFBRUEsU0FBQUEsZ0JBQUFDLEVBQUFDLEdBQUEsS0FBQUQsYUFBQUMsR0FBQSxNQUFBLElBQUFDLFVBQUEscUNBRUEsU0FBQUMsa0JBQUFDLEVBQUFDLEdBQUEsSUFBQSxJQUFBQyxFQUFBLEVBQUFBLEVBQUFELEVBQUFF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QUFBLEVBQ0FqQixNQUFBLFVBQ0FFLFFBQUEsQ0FBQSx5QkFBQSwyQkFHQWhVLEtBQUF1VSxjQUFBSixRQUFBLE9BQUFDLGlCQUFBQyxrQkFBQSxJQUVBLE9BQUFuSixFQUFBLENBQ0FsTCxLQUFBZ1YsY0FBQWhWLEtBQUFpVix1QkFDQXhDLFdBQUFDLFNBQUEsVUFBQTFTLEtBQUF5VSxtQkFDQSxJQUFBOUIsRUFBQSxDQUNBQyxLQUFBNVMsS0FBQXlVLGtCQUFBNUIsV0FBQSxHQUNBQyxHQUFBOVMsS0FBQXlVLGtCQUFBNUIsV0FBQSxJQUVBN1MsS0FBQXlVLGtCQUFBMUIsZ0JBQUFKLEVBQUFDLEtBQUFELEVBQUFHLFNBS0F3QixFQTFEQSxHQTZEQTFVLGdCQUFBMFUsZ0JBQUEsZ0JBQUEiLCJmaWxlIjoiSFRNTERlc2lnblV0aWxpdHkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfVxuXG52YXIgQ0tFZGl0b3JQbHVnaW5VdGlsaXR5ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBDS0VkaXRvclBsdWdpblV0aWxpdHkoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENLRWRpdG9yUGx1Z2luVXRpbGl0eSk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoQ0tFZGl0b3JQbHVnaW5VdGlsaXR5LCBudWxsLCBbe1xuICAgIGtleTogXCJBZGRQbHVnaW5zU2VydmVyQ29uZmlnXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIEFkZFBsdWdpbnNTZXJ2ZXJDb25maWcoc2luZ2xlTmFtZSwgdG9vbGJhckxvY2F0aW9uLCB0ZXh0LCBjbGllbnRSZXNvbHZlLCBzZXJ2ZXJSZXNvbHZlLCBjbGllbnRSZXNvbHZlSnMsIGRpYWxvZ1dpZHRoLCBkaWFsb2dIZWlnaHQsIGlzSkJ1aWxkNERDRGF0YSwgY29udHJvbENhdGVnb3J5LCBzZXJ2ZXJEeW5hbWljQmluZCwgc2hvd1JlbW92ZUJ1dHRvbiwgc2hvd0luRWRpdG9yVG9vbGJhciwgZW5hYmxlQ2hpbGRDb250cm9scykge1xuICAgICAgdGhpcy5QbHVnaW5zU2VydmVyQ29uZmlnW3NpbmdsZU5hbWVdID0ge1xuICAgICAgICBTaW5nbGVOYW1lOiBzaW5nbGVOYW1lLFxuICAgICAgICBUb29sYmFyTG9jYXRpb246IHRvb2xiYXJMb2NhdGlvbixcbiAgICAgICAgVG9vbGJhckxhYmVsOiB0ZXh0LFxuICAgICAgICBDbGllbnRSZXNvbHZlOiBjbGllbnRSZXNvbHZlLFxuICAgICAgICBTZXJ2ZXJSZXNvbHZlOiBzZXJ2ZXJSZXNvbHZlLFxuICAgICAgICBDbGllbnRSZXNvbHZlSnM6IGNsaWVudFJlc29sdmVKcyxcbiAgICAgICAgRGlhbG9nV2lkdGg6IGRpYWxvZ1dpZHRoLFxuICAgICAgICBEaWFsb2dIZWlnaHQ6IGRpYWxvZ0hlaWdodCxcbiAgICAgICAgSXNKQnVpbGQ0RENEYXRhOiBpc0pCdWlsZDREQ0RhdGEsXG4gICAgICAgIENvbnRyb2xDYXRlZ29yeTogY29udHJvbENhdGVnb3J5LFxuICAgICAgICBTZXJ2ZXJEeW5hbWljQmluZDogc2VydmVyRHluYW1pY0JpbmQsXG4gICAgICAgIFNob3dSZW1vdmVCdXR0b246IHNob3dSZW1vdmVCdXR0b24sXG4gICAgICAgIFNob3dJbkVkaXRvclRvb2xiYXI6IHNob3dJbkVkaXRvclRvb2xiYXIsXG4gICAgICAgIEVuYWJsZUNoaWxkQ29udHJvbHM6IGVuYWJsZUNoaWxkQ29udHJvbHNcbiAgICAgIH07XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIl9Vc2VTZXJ2ZXJDb25maWdDb3ZlckVtcHR5UGx1Z2luUHJvcFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfVXNlU2VydmVyQ29uZmlnQ292ZXJFbXB0eVBsdWdpblByb3Aob2JqKSB7XG4gICAgICB2YXIgY292ZXJPYmogPSB0aGlzLlBsdWdpbnNTZXJ2ZXJDb25maWdbb2JqLlNpbmdsZU5hbWVdO1xuXG4gICAgICBpZiAoY292ZXJPYmopIHtcbiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHtcbiAgICAgICAgICBpZiAodHlwZW9mIG9ialtwcm9wXSAhPSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGlmIChvYmpbcHJvcF0gPT0gXCJcIiB8fCBvYmpbcHJvcF0gPT0gbnVsbCkge1xuICAgICAgICAgICAgICBpZiAoY292ZXJPYmpbcHJvcF0pIHtcbiAgICAgICAgICAgICAgICBvYmpbcHJvcF0gPSBjb3Zlck9ialtwcm9wXTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJHZXRHZW5lcmFsUGx1Z2luSW5zdGFuY2VcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gR2V0R2VuZXJhbFBsdWdpbkluc3RhbmNlKHBsdWdpblNpbmdsZU5hbWUsIGV4Q29uZmlnKSB7XG4gICAgICB2YXIgZGVmYXVsdFNldHRpbmcgPSB7XG4gICAgICAgIFNpbmdsZU5hbWU6IHBsdWdpblNpbmdsZU5hbWUsXG4gICAgICAgIERpYWxvZ05hbWU6ICcnLFxuICAgICAgICBEaWFsb2dXaWR0aDogbnVsbCxcbiAgICAgICAgRGlhbG9nSGVpZ2h0OiBudWxsLFxuICAgICAgICBEaWFsb2dQYWdlVXJsOiBCYXNlVXRpbGl0eS5BcHBlbmRUaW1lU3RhbXBVcmwoJ0RpYWxvZy5odG1sJyksXG4gICAgICAgIERpYWxvZ1RpdGxlOiBcIkRJVlwiLFxuICAgICAgICBUb29sYmFyQ29tbWFuZDogJycsXG4gICAgICAgIFRvb2xiYXJJY29uOiAnSWNvbi5wbmcnLFxuICAgICAgICBUb29sYmFyTGFiZWw6IFwiXCIsXG4gICAgICAgIFRvb2xiYXJMb2NhdGlvbjogJycsXG4gICAgICAgIElGcmFtZVdpbmRvdzogbnVsbCxcbiAgICAgICAgSUZyYW1lRXhlY3V0ZUFjdGlvbk5hbWU6IFwiSW5zZXJ0XCIsXG4gICAgICAgIERlc2lnbk1vZGFsSW5wdXRDc3M6IFwiXCIsXG4gICAgICAgIENsaWVudFJlc29sdmU6IFwiXCIsXG4gICAgICAgIFNlcnZlclJlc29sdmU6IFwiXCIsXG4gICAgICAgIElzSkJ1aWxkNERDRGF0YTogXCJcIixcbiAgICAgICAgQ29udHJvbENhdGVnb3J5OiBcIlwiLFxuICAgICAgICBTZXJ2ZXJEeW5hbWljQmluZDogXCJcIixcbiAgICAgICAgU2hvd1JlbW92ZUJ1dHRvbjogXCJcIixcbiAgICAgICAgU2hvd0luRWRpdG9yVG9vbGJhcjogXCJcIixcbiAgICAgICAgRW5hYmxlQ2hpbGRDb250cm9sczogXCJcIlxuICAgICAgfTtcbiAgICAgIGRlZmF1bHRTZXR0aW5nID0gJC5leHRlbmQodHJ1ZSwge30sIGRlZmF1bHRTZXR0aW5nLCBleENvbmZpZyk7XG4gICAgICBkZWZhdWx0U2V0dGluZyA9IENLRWRpdG9yUGx1Z2luVXRpbGl0eS5fVXNlU2VydmVyQ29uZmlnQ292ZXJFbXB0eVBsdWdpblByb3AoZGVmYXVsdFNldHRpbmcpO1xuXG4gICAgICBpZiAoZGVmYXVsdFNldHRpbmcgIT0gbnVsbCkge1xuICAgICAgICBkZWZhdWx0U2V0dGluZy5EaWFsb2dOYW1lID0gZGVmYXVsdFNldHRpbmcuU2luZ2xlTmFtZTtcbiAgICAgICAgZGVmYXVsdFNldHRpbmcuVG9vbGJhckNvbW1hbmQgPSBcIkpCdWlsZDREQy5Gb3JtRGVzaWduLlBsdWdpbnMuXCIgKyBkZWZhdWx0U2V0dGluZy5TaW5nbGVOYW1lO1xuICAgICAgICBkZWZhdWx0U2V0dGluZy5EaWFsb2dTZXR0aW5nVGl0bGUgPSBkZWZhdWx0U2V0dGluZy5Ub29sYmFyTGFiZWwgKyBcIldlYuaOp+S7tlwiO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIFNldHRpbmc6IGRlZmF1bHRTZXR0aW5nXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiR2V0RW5hYmxlQ2hpbGRDb250cm9sc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBHZXRFbmFibGVDaGlsZENvbnRyb2xzKHNpbmdsZU5hbWUpIHtcbiAgICAgIHJldHVybiB0aGlzLlBsdWdpbnNbc2luZ2xlTmFtZV0uU2V0dGluZy5FbmFibGVDaGlsZENvbnRyb2xzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJHZXRQbHVnaW5zXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIEdldFBsdWdpbnMoKSB7XG4gICAgICByZXR1cm4gdGhpcy5QbHVnaW5zO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJSZWdHZW5lcmFsUGx1Z2luVG9FZGl0b3JcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gUmVnR2VuZXJhbFBsdWdpblRvRWRpdG9yKGNrRWRpdG9yLCBwYXRoLCBwbHVnaW5TZXR0aW5nLCBva0Z1bmMpIHtcbiAgICAgIENLRURJVE9SLmRpYWxvZy5hZGRJZnJhbWUocGx1Z2luU2V0dGluZy5EaWFsb2dOYW1lLCBwbHVnaW5TZXR0aW5nLkRpYWxvZ1NldHRpbmdUaXRsZSwgcGF0aCArIHBsdWdpblNldHRpbmcuRGlhbG9nUGFnZVVybCwgcGx1Z2luU2V0dGluZy5EaWFsb2dXaWR0aCwgcGx1Z2luU2V0dGluZy5EaWFsb2dIZWlnaHQsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuXy5mcmFtZUlkKTtcbiAgICAgICAgcGx1Z2luU2V0dGluZy5JRnJhbWVXaW5kb3cgPSBpZnJhbWU7XG4gICAgICAgIENLRWRpdG9yUGx1Z2luVXRpbGl0eS5TZXRFbGVtUHJvcHNJbkVkaXREaWFsb2cocGx1Z2luU2V0dGluZy5JRnJhbWVXaW5kb3csIHBsdWdpblNldHRpbmcuSUZyYW1lRXhlY3V0ZUFjdGlvbk5hbWUpO1xuICAgICAgfSwge1xuICAgICAgICBvbk9rOiBmdW5jdGlvbiBvbk9rKCkge1xuICAgICAgICAgIHZhciBwcm9wcyA9IHBsdWdpblNldHRpbmcuSUZyYW1lV2luZG93LmNvbnRlbnRXaW5kb3cuRGlhbG9nQXBwLmdldENvbnRyb2xQcm9wcygpO1xuXG4gICAgICAgICAgaWYgKHByb3BzLnN1Y2Nlc3MgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBva0Z1bmMoY2tFZGl0b3IsIHBsdWdpblNldHRpbmcsIHByb3BzLCBwbHVnaW5TZXR0aW5nLklGcmFtZVdpbmRvdy5jb250ZW50V2luZG93KTtcbiAgICAgICAgICBwbHVnaW5TZXR0aW5nLklGcmFtZUV4ZWN1dGVBY3Rpb25OYW1lID0gQ0tFZGl0b3JQbHVnaW5VdGlsaXR5LkRpYWxvZ0V4ZWN1dGVJbnNlcnRBY3Rpb25OYW1lO1xuICAgICAgICB9LFxuICAgICAgICBvbkNhbmNlbDogZnVuY3Rpb24gb25DYW5jZWwoKSB7XG4gICAgICAgICAgcGx1Z2luU2V0dGluZy5JRnJhbWVFeGVjdXRlQWN0aW9uTmFtZSA9IENLRWRpdG9yUGx1Z2luVXRpbGl0eS5EaWFsb2dFeGVjdXRlSW5zZXJ0QWN0aW9uTmFtZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBja0VkaXRvci5hZGRDb21tYW5kKHBsdWdpblNldHRpbmcuVG9vbGJhckNvbW1hbmQsIG5ldyBDS0VESVRPUi5kaWFsb2dDb21tYW5kKHBsdWdpblNldHRpbmcuRGlhbG9nTmFtZSkpO1xuXG4gICAgICBpZiAocGx1Z2luU2V0dGluZy5TaG93SW5FZGl0b3JUb29sYmFyID09IFwidHJ1ZVwiKSB7XG4gICAgICAgIGNrRWRpdG9yLnVpLmFkZEJ1dHRvbihwbHVnaW5TZXR0aW5nLlNpbmdsZU5hbWUsIHtcbiAgICAgICAgICBsYWJlbDogcGx1Z2luU2V0dGluZy5Ub29sYmFyTGFiZWwsXG4gICAgICAgICAgaWNvbjogcGF0aCArIHBsdWdpblNldHRpbmcuVG9vbGJhckljb24sXG4gICAgICAgICAgY29tbWFuZDogcGx1Z2luU2V0dGluZy5Ub29sYmFyQ29tbWFuZCxcbiAgICAgICAgICB0b29sYmFyOiBwbHVnaW5TZXR0aW5nLlRvb2xiYXJMb2NhdGlvblxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgY2tFZGl0b3Iub24oJ2RvdWJsZWNsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIENLRWRpdG9yUGx1Z2luVXRpbGl0eS5PbkNLV3lzaXd5Z0VsZW1EQkNsaWNrRXZlbnQoZXZlbnQsIHBsdWdpblNldHRpbmcpO1xuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIk9uQ0tXeXNpd3lnRWxlbURCQ2xpY2tFdmVudFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBPbkNLV3lzaXd5Z0VsZW1EQkNsaWNrRXZlbnQoZXZlbnQsIGNvbnRyb2xTZXR0aW5nKSB7XG4gICAgICB2YXIgZWxlbWVudCA9IGV2ZW50LmRhdGEuZWxlbWVudDtcblxuICAgICAgaWYgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwicnVudGltZV9hdXRvX3JlbW92ZVwiKSA9PSBcInRydWVcIikge1xuICAgICAgICBlbGVtZW50ID0gZXZlbnQuZGF0YS5lbGVtZW50LmdldFBhcmVudCgpO1xuICAgICAgfVxuXG4gICAgICB2YXIgc2luZ2xlTmFtZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwic2luZ2xlTmFtZVwiKTtcblxuICAgICAgaWYgKHNpbmdsZU5hbWUgPT0gY29udHJvbFNldHRpbmcuU2luZ2xlTmFtZSkge1xuICAgICAgICBDS0VkaXRvclV0aWxpdHkuU2V0U2VsZWN0ZWRFbGVtKGVsZW1lbnQuZ2V0T3V0ZXJIdG1sKCkpO1xuICAgICAgICBldmVudC5kYXRhLmRpYWxvZyA9IGNvbnRyb2xTZXR0aW5nLkRpYWxvZ05hbWU7XG4gICAgICAgIGNvbnRyb2xTZXR0aW5nLklGcmFtZUV4ZWN1dGVBY3Rpb25OYW1lID0gQ0tFZGl0b3JQbHVnaW5VdGlsaXR5LkRpYWxvZ0V4ZWN1dGVFZGl0QWN0aW9uTmFtZTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiU2VyaWFsaXplUHJvcHNUb0VsZW1cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gU2VyaWFsaXplUHJvcHNUb0VsZW0oZWxlbSwgcHJvcHMsIGNvbnRyb2xTZXR0aW5nKSB7XG4gICAgICBlbGVtLnNldEF0dHJpYnV0ZShcImpidWlsZDRkY19jdXN0b21cIiwgXCJ0cnVlXCIpO1xuICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoXCJzaW5nbGVuYW1lXCIsIGNvbnRyb2xTZXR0aW5nLlNpbmdsZU5hbWUpO1xuICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoXCJpc19qYnVpbGQ0ZGNfZGF0YVwiLCBjb250cm9sU2V0dGluZy5Jc0pCdWlsZDREQ0RhdGEpO1xuICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoXCJjb250cm9sX2NhdGVnb3J5XCIsIGNvbnRyb2xTZXR0aW5nLkNvbnRyb2xDYXRlZ29yeSk7XG4gICAgICBlbGVtLnNldEF0dHJpYnV0ZShcInNob3dfcmVtb3ZlX2J1dHRvblwiLCBjb250cm9sU2V0dGluZy5TaG93UmVtb3ZlQnV0dG9uKTtcblxuICAgICAgaWYgKHByb3BzW1wiYmFzZUluZm9cIl0pIHtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIHByb3BzW1wiYmFzZUluZm9cIl0pIHtcbiAgICAgICAgICBpZiAoa2V5ID09IFwicmVhZG9ubHlcIikge1xuICAgICAgICAgICAgaWYgKHByb3BzW1wiYmFzZUluZm9cIl1ba2V5XSA9PSBcInJlYWRvbmx5XCIpIHtcbiAgICAgICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoa2V5LnRvTG9jYWxlTG93ZXJDYXNlKCksIHByb3BzW1wiYmFzZUluZm9cIl1ba2V5XSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBlbGVtLnJlbW92ZUF0dHJpYnV0ZShcInJlYWRvbmx5XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoa2V5ID09IFwiZGlzYWJsZWRcIikge1xuICAgICAgICAgICAgaWYgKHByb3BzW1wiYmFzZUluZm9cIl1ba2V5XSA9PSBcImRpc2FibGVkXCIpIHtcbiAgICAgICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoa2V5LnRvTG9jYWxlTG93ZXJDYXNlKCksIHByb3BzW1wiYmFzZUluZm9cIl1ba2V5XSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBlbGVtLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZShrZXkudG9Mb2NhbGVMb3dlckNhc2UoKSwgcHJvcHNbXCJiYXNlSW5mb1wiXVtrZXldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHByb3BzW1wiYmluZFRvRmllbGRcIl0pIHtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIHByb3BzW1wiYmluZFRvRmllbGRcIl0pIHtcbiAgICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZShrZXkudG9Mb2NhbGVMb3dlckNhc2UoKSwgcHJvcHNbXCJiaW5kVG9GaWVsZFwiXVtrZXldKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAocHJvcHNbXCJkZWZhdWx0VmFsdWVcIl0pIHtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIHByb3BzW1wiZGVmYXVsdFZhbHVlXCJdKSB7XG4gICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoa2V5LnRvTG9jYWxlTG93ZXJDYXNlKCksIHByb3BzW1wiZGVmYXVsdFZhbHVlXCJdW2tleV0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChwcm9wc1tcInZhbGlkYXRlUnVsZXNcIl0pIHtcbiAgICAgICAgaWYgKHByb3BzW1widmFsaWRhdGVSdWxlc1wiXS5ydWxlcykge1xuICAgICAgICAgIGlmIChwcm9wc1tcInZhbGlkYXRlUnVsZXNcIl0ucnVsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoXCJ2YWxpZGF0ZXJ1bGVzXCIsIGVuY29kZVVSSUNvbXBvbmVudChKc29uVXRpbGl0eS5Kc29uVG9TdHJpbmcocHJvcHNbXCJ2YWxpZGF0ZVJ1bGVzXCJdKSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAocHJvcHNbXCJub3JtYWxQcm9wc1wiXSkge1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gcHJvcHNbXCJub3JtYWxQcm9wc1wiXSkge1xuICAgICAgICAgIGVsZW0uc2V0QXR0cmlidXRlKGtleS50b0xvY2FsZUxvd2VyQ2FzZSgpLCBwcm9wc1tcIm5vcm1hbFByb3BzXCJdW2tleV0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChwcm9wc1tcImJpbmRUb1NlYXJjaEZpZWxkXCJdKSB7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBwcm9wc1tcImJpbmRUb1NlYXJjaEZpZWxkXCJdKSB7XG4gICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoa2V5LnRvTG9jYWxlTG93ZXJDYXNlKCksIHByb3BzW1wiYmluZFRvU2VhcmNoRmllbGRcIl1ba2V5XSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHByb3BzW1wibm9ybWFsRGF0YVNvdXJjZVwiXSkge1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gcHJvcHNbXCJub3JtYWxEYXRhU291cmNlXCJdKSB7XG4gICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoa2V5LnRvTG9jYWxlTG93ZXJDYXNlKCksIHByb3BzW1wibm9ybWFsRGF0YVNvdXJjZVwiXVtrZXldKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gZWxlbTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiRGVzZXJpYWxpemVQcm9wc0Zyb21FbGVtXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIERlc2VyaWFsaXplUHJvcHNGcm9tRWxlbShlbGVtKSB7XG4gICAgICB2YXIgcHJvcHMgPSB7fTtcbiAgICAgIHZhciAkZWxlbSA9ICQoZWxlbSk7XG5cbiAgICAgIGZ1bmN0aW9uIGF0dHJUb1Byb3AocHJvcHMsIGdyb3VwTmFtZSkge1xuICAgICAgICB2YXIgZ3JvdXBQcm9wID0ge307XG5cbiAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuRGVmYXVsdFByb3BzW2dyb3VwTmFtZV0pIHtcbiAgICAgICAgICBpZiAoJGVsZW0uYXR0cihrZXkpKSB7XG4gICAgICAgICAgICBncm91cFByb3Bba2V5XSA9ICRlbGVtLmF0dHIoa2V5KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ3JvdXBQcm9wW2tleV0gPSB0aGlzLkRlZmF1bHRQcm9wc1tncm91cE5hbWVdW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcHJvcHNbZ3JvdXBOYW1lXSA9IGdyb3VwUHJvcDtcbiAgICAgICAgcmV0dXJuIHByb3BzO1xuICAgICAgfVxuXG4gICAgICBwcm9wcyA9IGF0dHJUb1Byb3AuY2FsbCh0aGlzLCBwcm9wcywgXCJiYXNlSW5mb1wiKTtcbiAgICAgIHByb3BzID0gYXR0clRvUHJvcC5jYWxsKHRoaXMsIHByb3BzLCBcImJpbmRUb0ZpZWxkXCIpO1xuICAgICAgcHJvcHMgPSBhdHRyVG9Qcm9wLmNhbGwodGhpcywgcHJvcHMsIFwiZGVmYXVsdFZhbHVlXCIpO1xuICAgICAgcHJvcHMgPSBhdHRyVG9Qcm9wLmNhbGwodGhpcywgcHJvcHMsIFwiYmluZFRvU2VhcmNoRmllbGRcIik7XG4gICAgICBwcm9wcyA9IGF0dHJUb1Byb3AuY2FsbCh0aGlzLCBwcm9wcywgXCJub3JtYWxEYXRhU291cmNlXCIpO1xuXG4gICAgICBpZiAoJGVsZW0uYXR0cihcInZhbGlkYXRlUnVsZXNcIikpIHtcbiAgICAgICAgcHJvcHMudmFsaWRhdGVSdWxlcyA9IEpzb25VdGlsaXR5LlN0cmluZ1RvSnNvbihkZWNvZGVVUklDb21wb25lbnQoJGVsZW0uYXR0cihcInZhbGlkYXRlUnVsZXNcIikpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByb3BzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJCdWlsZEdlbmVyYWxFbGVtVG9DS1d5c2l3eWdcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gQnVpbGRHZW5lcmFsRWxlbVRvQ0tXeXNpd3lnKGh0bWwsIGNvbnRyb2xTZXR0aW5nLCBjb250cm9sUHJvcHMsIF9pZnJhbWUpIHtcbiAgICAgIGlmICh0aGlzLlZhbGlkYXRlQnVpbGRFbmFibGUoaHRtbCwgY29udHJvbFNldHRpbmcsIGNvbnRyb2xQcm9wcywgX2lmcmFtZSkpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJJRnJhbWVFeGVjdXRlQWN0aW9uTmFtZTpcIiArIGNvbnRyb2xTZXR0aW5nLklGcmFtZUV4ZWN1dGVBY3Rpb25OYW1lKTtcblxuICAgICAgICBpZiAoY29udHJvbFNldHRpbmcuSUZyYW1lRXhlY3V0ZUFjdGlvbk5hbWUgPT0gQ0tFZGl0b3JQbHVnaW5VdGlsaXR5LkRpYWxvZ0V4ZWN1dGVJbnNlcnRBY3Rpb25OYW1lKSB7XG4gICAgICAgICAgdmFyIGVsZW0gPSBDS0VESVRPUi5kb20uZWxlbWVudC5jcmVhdGVGcm9tSHRtbChodG1sKTtcbiAgICAgICAgICB0aGlzLlNlcmlhbGl6ZVByb3BzVG9FbGVtKGVsZW0sIGNvbnRyb2xQcm9wcywgY29udHJvbFNldHRpbmcpO1xuICAgICAgICAgIENLRWRpdG9yVXRpbGl0eS5HZXRDS0VkaXRvckluc3QoKS5pbnNlcnRFbGVtZW50KGVsZW0pO1xuICAgICAgICAgIENLRWRpdG9yVXRpbGl0eS5TaW5nbGVFbGVtQmluZERlZmF1bHRFdmVudChlbGVtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgc2VsZWN0ZWRFbGVtID0gQ0tFZGl0b3JVdGlsaXR5LkdldFNlbGVjdGVkQ0tFZGl0b3JFbGVtKCk7XG5cbiAgICAgICAgICBpZiAoc2VsZWN0ZWRFbGVtKSB7XG4gICAgICAgICAgICB2YXIgcmVGcmVzaEVsZW0gPSBuZXcgQ0tFRElUT1IuZG9tLmVsZW1lbnQuY3JlYXRlRnJvbUh0bWwoc2VsZWN0ZWRFbGVtLmdldE91dGVySHRtbCgpKTtcblxuICAgICAgICAgICAgaWYgKHJlRnJlc2hFbGVtLmdldEF0dHJpYnV0ZShcImNvbnRyb2xfY2F0ZWdvcnlcIikgPT0gXCJJbnB1dENvbnRyb2xcIikge1xuICAgICAgICAgICAgICB2YXIgbmV3VGV4dCA9ICQoaHRtbCkudGV4dCgpO1xuICAgICAgICAgICAgICByZUZyZXNoRWxlbS5zZXRUZXh0KG5ld1RleHQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZWxlY3RlZEVsZW0uY29weUF0dHJpYnV0ZXMocmVGcmVzaEVsZW0sIHtcbiAgICAgICAgICAgICAgdGVtcDogXCJ0ZW1wXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5TZXJpYWxpemVQcm9wc1RvRWxlbShyZUZyZXNoRWxlbSwgY29udHJvbFByb3BzLCBjb250cm9sU2V0dGluZyk7XG4gICAgICAgICAgICByZUZyZXNoRWxlbS5yZXBsYWNlKHNlbGVjdGVkRWxlbSk7XG4gICAgICAgICAgICBDS0VkaXRvclV0aWxpdHkuU2luZ2xlRWxlbUJpbmREZWZhdWx0RXZlbnQocmVGcmVzaEVsZW0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJWYWxpZGF0ZUJ1aWxkRW5hYmxlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIFZhbGlkYXRlQnVpbGRFbmFibGUoaHRtbCwgY29udHJvbFNldHRpbmcsIGNvbnRyb2xQcm9wcywgX2lmcmFtZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIlZhbGlkYXRlU2VyaWFsaXplQ29udHJvbERpYWxvZ0NvbXBsZXRlZEVuYWJsZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBWYWxpZGF0ZVNlcmlhbGl6ZUNvbnRyb2xEaWFsb2dDb21wbGV0ZWRFbmFibGUocmV0dXJuUmVzdWx0KSB7XG4gICAgICBpZiAocmV0dXJuUmVzdWx0LmJhc2VJbmZvLnNlcmlhbGl6ZSA9PSBcInRydWVcIiAmJiByZXR1cm5SZXN1bHQuYmluZFRvRmllbGQuZmllbGROYW1lID09IFwiXCIpIHtcbiAgICAgICAgRGlhbG9nVXRpbGl0eS5BbGVydCh3aW5kb3csIERpYWxvZ1V0aWxpdHkuRGlhbG9nQWxlcnRJZCwge30sIFwi5bqP5YiX5YyW55qE5o6n5Lu25b+F6aG757uR5a6a5a2X5q61IVwiLCBudWxsKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmV0dXJuUmVzdWx0O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJTZXRFbGVtUHJvcHNJbkVkaXREaWFsb2dcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gU2V0RWxlbVByb3BzSW5FZGl0RGlhbG9nKGlmcmFtZU9iaiwgYWN0aW9uTmFtZSkge1xuICAgICAgdmFyIHNlbCA9IENLRWRpdG9yVXRpbGl0eS5HZXRDS0VkaXRvckluc3QoKS5nZXRTZWxlY3Rpb24oKS5nZXRTdGFydEVsZW1lbnQoKTtcbiAgICAgIHZhciBwYXJlbnRzID0gbnVsbDtcblxuICAgICAgaWYgKHNlbCkge1xuICAgICAgICBwYXJlbnRzID0gc2VsLmdldFBhcmVudHMoKTtcbiAgICAgIH1cblxuICAgICAgaWZyYW1lT2JqLmNvbnRlbnRXaW5kb3cuRGlhbG9nQXBwLnJlYWR5KGFjdGlvbk5hbWUsIHNlbCwgcGFyZW50cyk7XG5cbiAgICAgIGlmIChhY3Rpb25OYW1lID09IHRoaXMuRGlhbG9nRXhlY3V0ZUVkaXRBY3Rpb25OYW1lKSB7XG4gICAgICAgIHZhciBlbGVtID0gQ0tFZGl0b3JVdGlsaXR5LkdldFNlbGVjdGVkRWxlbSgpLm91dGVySFRNTCgpO1xuICAgICAgICB2YXIgcHJvcHMgPSB0aGlzLkRlc2VyaWFsaXplUHJvcHNGcm9tRWxlbShlbGVtKTtcbiAgICAgICAgaWZyYW1lT2JqLmNvbnRlbnRXaW5kb3cuRGlhbG9nQXBwLnNldENvbnRyb2xQcm9wcygkKGVsZW0pLCBwcm9wcyk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIkdldENvbnRyb2xEZXNjVGV4dFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBHZXRDb250cm9sRGVzY1RleHQocGx1Z2luU2V0dGluZywgcHJvcHMpIHtcbiAgICAgIGNvbnNvbGUubG9nKHByb3BzKTtcbiAgICAgIHZhciByZXN1bHQgPSBcIuexu+WeizrjgJBcIiArIHBsdWdpblNldHRpbmcuVG9vbGJhckxhYmVsICsgXCLjgJE8YnIgLz7nu5Hlrpo644CQXCIgKyBwcm9wcy5iaW5kVG9GaWVsZC50YWJsZUNhcHRpb24gKyBcIi1cIiArIHByb3BzLmJpbmRUb0ZpZWxkLmZpZWxkQ2FwdGlvbiArIFwi44CRXCI7XG5cbiAgICAgIGlmIChwcm9wcy5kZWZhdWx0VmFsdWUpIHtcbiAgICAgICAgaWYgKHByb3BzLmRlZmF1bHRWYWx1ZS5kZWZhdWx0VGV4dCkge1xuICAgICAgICAgIHJlc3VsdCArPSBcIjxiciAvPum7mOiupDrjgJBcIiArIHByb3BzLmRlZmF1bHRWYWx1ZS5kZWZhdWx0VHlwZSArIFwiOlwiICsgcHJvcHMuZGVmYXVsdFZhbHVlLmRlZmF1bHRUZXh0ICsgXCLjgJFcIjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAocHJvcHMudmFsaWRhdGVSdWxlcykge1xuICAgICAgICBpZiAocHJvcHMudmFsaWRhdGVSdWxlcy5ydWxlcykge1xuICAgICAgICAgIGlmIChwcm9wcy52YWxpZGF0ZVJ1bGVzLnJ1bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcIjxiciAvPumqjOivgTrjgJBcIjtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy52YWxpZGF0ZVJ1bGVzLnJ1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgIHJlc3VsdCArPSBwcm9wcy52YWxpZGF0ZVJ1bGVzLnJ1bGVzW2ldLnZhbGlkYXRlVHlwZSArIFwiO1wiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXN1bHQgPSBTdHJpbmdVdGlsaXR5LlJlbW92ZUxhc3RDaGFyKHJlc3VsdCk7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCLjgJFcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiR2V0U2VhcmNoQ29udHJvbERlc2NUZXh0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIEdldFNlYXJjaENvbnRyb2xEZXNjVGV4dChwbHVnaW5TZXR0aW5nLCBwcm9wcykge1xuICAgICAgcmV0dXJuIFwiW1wiICsgcGx1Z2luU2V0dGluZy5Ub29sYmFyTGFiZWwgKyBcIl0g57uR5a6aOltcIiArIHByb3BzLmJpbmRUb1NlYXJjaEZpZWxkLmNvbHVtbkNhcHRpb24gKyBcIl0oXCIgKyBwcm9wcy5iaW5kVG9TZWFyY2hGaWVsZC5jb2x1bW5PcGVyYXRvciArIFwiKVwiO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJHZXRBdXRvUmVtb3ZlVGlwTGFiZWxcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gR2V0QXV0b1JlbW92ZVRpcExhYmVsKHRpcE1zZykge1xuICAgICAgaWYgKCF0aXBNc2cpIHtcbiAgICAgICAgdGlwTXNnID0gXCLlj4zlh7vnvJbovpHor6Xpg6jku7ZcIjtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuICc8ZGl2IHJ1bnRpbWVfYXV0b19yZW1vdmU9XCJ0cnVlXCIgY2xhc3M9XCJ3eXNpd3lnLWF1dG8tcmVtb3ZlLXRpcFwiPicgKyB0aXBNc2cgKyAnPC9kaXY+JztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiVHJ5R2V0TGlzdEJ1dHRvbnNJblBsdWdpblBhZ2VcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gVHJ5R2V0TGlzdEJ1dHRvbnNJblBsdWdpblBhZ2UoKSB7XG4gICAgICB2YXIgYnV0dG9ucyA9IFtdO1xuICAgICAgdmFyIGh0bWwgPSBDS0VkaXRvclV0aWxpdHkuR2V0Q0tFZGl0b3JIVE1MSW5QbHVnaW5QYWdlKCk7XG4gICAgICB2YXIgJGJ1dHRvbnMgPSAkKGh0bWwpLmZpbmQoXCJbYnV0dG9uY2FwdGlvbl1cIik7XG4gICAgICAkYnV0dG9ucy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJ1dHRvbkNhcHRpb24gPSAkKHRoaXMpLmF0dHIoXCJidXR0b25jYXB0aW9uXCIpO1xuICAgICAgICB2YXIgYnV0dG9uSWQgPSAkKHRoaXMpLmF0dHIoXCJpZFwiKTtcbiAgICAgICAgYnV0dG9ucy5wdXNoKHtcbiAgICAgICAgICBidXR0b25DYXB0aW9uOiBidXR0b25DYXB0aW9uLFxuICAgICAgICAgIGJ1dHRvbklkOiBidXR0b25JZFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGJ1dHRvbnM7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIlRyeUdldERhdGFTZXRJZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBUcnlHZXREYXRhU2V0SWQoc2VsLCBwYXJlbnRzKSB7XG4gICAgICBpZiAoc2VsKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBwYXJlbnRzLmxlbmd0aCAtIDE7IGktLTsgaSA+PSAwKSB7XG4gICAgICAgICAgaWYgKHBhcmVudHNbaV0uZ2V0QXR0cmlidXRlKFwiZGF0YXNldGlkXCIpICE9IG51bGwgJiYgcGFyZW50c1tpXS5nZXRBdHRyaWJ1dGUoXCJkYXRhc2V0aWRcIikgIT0gXCJcIikge1xuICAgICAgICAgICAgcmV0dXJuIHBhcmVudHNbaV0uZ2V0QXR0cmlidXRlKFwiZGF0YXNldGlkXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIXRoaXMuZGF0YVNldElkKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3cucGFyZW50Lmxpc3REZXNpZ24ubGlzdFJlc291cmNlRW50aXR5Lmxpc3REYXRhc2V0SWQ7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJUZW1wbGF0ZUFkZERlZlByb3BcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gVGVtcGxhdGVBZGREZWZQcm9wKCR0ZW1wbGF0ZUVsZW0sIGlkLCBzaG93X3JlbW92ZV9idXR0b24sIHNpbmdsZU5hbWUsIHN0YXR1cykge1xuICAgICAgJHRlbXBsYXRlRWxlbS5hdHRyKFwiY2xhc3NuYW1lXCIsIFwiXCIpO1xuICAgICAgJHRlbXBsYXRlRWxlbS5hdHRyKFwiY29udHJvbF9jYXRlZ29yeVwiLCBcIkNvbnRhaW5lckNvbnRyb2xcIik7XG4gICAgICAkdGVtcGxhdGVFbGVtLmF0dHIoXCJjdXN0ZGlzYWJsZWRcIiwgXCJub2Rpc2FibGVkXCIpO1xuICAgICAgJHRlbXBsYXRlRWxlbS5hdHRyKFwiY3VzdHJlYWRvbmx5XCIsIFwibm9yZWFkb25seVwiKTtcbiAgICAgICR0ZW1wbGF0ZUVsZW0uYXR0cihcImRlc2NcIiwgXCJcIik7XG4gICAgICAkdGVtcGxhdGVFbGVtLmF0dHIoXCJpZFwiLCBpZCk7XG4gICAgICAkdGVtcGxhdGVFbGVtLmF0dHIoXCJpc19qYnVpbGQ0ZGNfZGF0YVwiLCBcImZhbHNlXCIpO1xuICAgICAgJHRlbXBsYXRlRWxlbS5hdHRyKFwiamJ1aWxkNGRjX2N1c3RvbVwiLCBcInRydWVcIik7XG4gICAgICAkdGVtcGxhdGVFbGVtLmF0dHIoXCJuYW1lXCIsIGlkKTtcbiAgICAgICR0ZW1wbGF0ZUVsZW0uYXR0cihcInBsYWNlaG9sZGVyXCIsIFwiXCIpO1xuICAgICAgJHRlbXBsYXRlRWxlbS5hdHRyKFwic2VyaWFsaXplXCIsIFwiZmFsc2VcIik7XG4gICAgICAkdGVtcGxhdGVFbGVtLmF0dHIoXCJzaG93X3JlbW92ZV9idXR0b25cIiwgc2hvd19yZW1vdmVfYnV0dG9uKTtcbiAgICAgICR0ZW1wbGF0ZUVsZW0uYXR0cihcInNpbmdsZW5hbWVcIiwgc2luZ2xlTmFtZSk7XG4gICAgICAkdGVtcGxhdGVFbGVtLmF0dHIoXCJzdHlsZVwiLCBcIlwiKTtcbiAgICAgICR0ZW1wbGF0ZUVsZW0uYXR0cihcInN0YXR1c1wiLCBzdGF0dXMpO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBDS0VkaXRvclBsdWdpblV0aWxpdHk7XG59KCk7XG5cbl9kZWZpbmVQcm9wZXJ0eShDS0VkaXRvclBsdWdpblV0aWxpdHksIFwiUGx1Z2luc1NlcnZlckNvbmZpZ1wiLCB7fSk7XG5cbl9kZWZpbmVQcm9wZXJ0eShDS0VkaXRvclBsdWdpblV0aWxpdHksIFwiUGx1Z2luc1wiLCB7fSk7XG5cbl9kZWZpbmVQcm9wZXJ0eShDS0VkaXRvclBsdWdpblV0aWxpdHksIFwiRGVmYXVsdFByb3BzXCIsIHtcbiAgYmluZFRvRmllbGQ6IHtcbiAgICByZWxhdGlvbklkOiBcIlwiLFxuICAgIHRhYmxlSWQ6IFwiXCIsXG4gICAgdGFibGVOYW1lOiBcIlwiLFxuICAgIHRhYmxlQ2FwdGlvbjogXCJcIixcbiAgICBmaWVsZE5hbWU6IFwiXCIsXG4gICAgZmllbGRDYXB0aW9uOiBcIlwiLFxuICAgIGZpZWxkRGF0YVR5cGU6IFwiXCIsXG4gICAgZmllbGRMZW5ndGg6IFwiXCJcbiAgfSxcbiAgZGVmYXVsdFZhbHVlOiB7XG4gICAgZGVmYXVsdFR5cGU6IFwiXCIsXG4gICAgZGVmYXVsdFZhbHVlOiBcIlwiLFxuICAgIGRlZmF1bHRUZXh0OiBcIlwiXG4gIH0sXG4gIHZhbGlkYXRlUnVsZXM6IHtcbiAgICBtc2c6IFwiXCIsXG4gICAgcnVsZXM6IFtdXG4gIH0sXG4gIGJhc2VJbmZvOiB7XG4gICAgaWQ6IFwiXCIsXG4gICAgc2VyaWFsaXplOiBcInRydWVcIixcbiAgICBuYW1lOiBcIlwiLFxuICAgIGNsYXNzTmFtZTogXCJcIixcbiAgICBwbGFjZWhvbGRlcjogXCJcIixcbiAgICBjdXN0UmVhZG9ubHk6IFwibm9yZWFkb25seVwiLFxuICAgIGN1c3REaXNhYmxlZDogXCJub2Rpc2FibGVkXCIsXG4gICAgc3R5bGU6IFwiXCIsXG4gICAgZGVzYzogXCJcIixcbiAgICBzdGF0dXM6IFwiZW5hYmxlXCJcbiAgfSxcbiAgYmluZFRvU2VhcmNoRmllbGQ6IHtcbiAgICBjb2x1bW5UaXRsZTogXCJcIixcbiAgICBjb2x1bW5UYWJsZU5hbWU6IFwiXCIsXG4gICAgY29sdW1uTmFtZTogXCJcIixcbiAgICBjb2x1bW5DYXB0aW9uOiBcIlwiLFxuICAgIGNvbHVtbkRhdGFUeXBlTmFtZTogXCJcIixcbiAgICBjb2x1bW5PcGVyYXRvcjogXCLljLnphY1cIlxuICB9LFxuICBub3JtYWxEYXRhU291cmNlOiB7XG4gICAgZGVmYXVsdElzTnVsbDogXCJ0cnVlXCIsXG4gICAgc3FsRGF0YVNvdXJjZTogXCJcIixcbiAgICBkaWN0aW9uYXJ5SWREYXRhU291cmNlOiBcIlwiLFxuICAgIHJlc3REYXRhU291cmNlOiBcIlwiLFxuICAgIHN0YXRpY0RhdGFTb3VyY2U6IFwiXCJcbiAgfVxufSk7XG5cbl9kZWZpbmVQcm9wZXJ0eShDS0VkaXRvclBsdWdpblV0aWxpdHksIFwiRGlhbG9nRXhlY3V0ZUVkaXRBY3Rpb25OYW1lXCIsIFwiRWRpdFwiKTtcblxuX2RlZmluZVByb3BlcnR5KENLRWRpdG9yUGx1Z2luVXRpbGl0eSwgXCJEaWFsb2dFeGVjdXRlSW5zZXJ0QWN0aW9uTmFtZVwiLCBcIkluc2VydFwiKTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfVxuXG52YXIgQ0tFZGl0b3JVdGlsaXR5ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBDS0VkaXRvclV0aWxpdHkoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENLRWRpdG9yVXRpbGl0eSk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoQ0tFZGl0b3JVdGlsaXR5LCBudWxsLCBbe1xuICAgIGtleTogXCJTZXRTZWxlY3RlZEVsZW1cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gU2V0U2VsZWN0ZWRFbGVtKGVsZW1IdG1sKSB7XG4gICAgICB0aGlzLl8kQ0tFZGl0b3JTZWxlY3RFbGVtID0gJChlbGVtSHRtbCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIkdldFNlbGVjdGVkRWxlbVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBHZXRTZWxlY3RlZEVsZW0oKSB7XG4gICAgICBpZiAodGhpcy5fJENLRWRpdG9yU2VsZWN0RWxlbSkge1xuICAgICAgICBpZiAodGhpcy5fJENLRWRpdG9yU2VsZWN0RWxlbS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuXyRDS0VkaXRvclNlbGVjdEVsZW07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIkdldFNlbGVjdGVkQ0tFZGl0b3JFbGVtXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIEdldFNlbGVjdGVkQ0tFZGl0b3JFbGVtKCkge1xuICAgICAgaWYgKHRoaXMuR2V0U2VsZWN0ZWRFbGVtKCkpIHtcbiAgICAgICAgdmFyIGlkID0gdGhpcy5HZXRTZWxlY3RlZEVsZW0oKS5hdHRyKFwiaWRcIik7XG4gICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5HZXRDS0VkaXRvckluc3QoKS5kb2N1bWVudC5nZXRCeUlkKGlkKTtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJTZXRMYXN0U2VsZWN0ZWRUZW1wSFRNTFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBTZXRMYXN0U2VsZWN0ZWRUZW1wSFRNTChodG1sKSB7XG4gICAgICB0aGlzLl9MYXN0U2VsZWN0ZWRUZW1wSFRNTCA9IGh0bWw7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIkdldExhc3RTZWxlY3RlZFRlbXBIVE1MXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIEdldExhc3RTZWxlY3RlZFRlbXBIVE1MKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX0xhc3RTZWxlY3RlZFRlbXBIVE1MO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJUcnlHZXRJZEZyb21MYXN0U2VsZWN0ZWRUZW1wSFRNTFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBUcnlHZXRJZEZyb21MYXN0U2VsZWN0ZWRUZW1wSFRNTChuZXdIVE1MKSB7XG4gICAgICBpZiAoIXRoaXMuX0xhc3RTZWxlY3RlZFRlbXBIVE1MKSB7XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG5hbWUgPSAkKG5ld0hUTUwpLmF0dHIoXCJuYW1lXCIpO1xuICAgICAgICB2YXIgbGFzdEh0bWxOYW1lID0gJCh0aGlzLkdldExhc3RTZWxlY3RlZFRlbXBIVE1MKCkpLmF0dHIoXCJuYW1lXCIpO1xuXG4gICAgICAgIGlmIChuYW1lID09IGxhc3RIdG1sTmFtZSkge1xuICAgICAgICAgIHJldHVybiAkKHRoaXMuR2V0TGFzdFNlbGVjdGVkVGVtcEhUTUwoKSkuYXR0cihcImlkXCIpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBcIlwiO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJHZXRDS0VkaXRvckluc3RcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gR2V0Q0tFZGl0b3JJbnN0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuX0NLRWRpdG9ySW5zdDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiU2V0Q0tFZGl0b3JJbnN0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIFNldENLRWRpdG9ySW5zdChpbnN0KSB7XG4gICAgICB0aGlzLl9DS0VkaXRvckluc3QgPSBpbnN0O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJHZXRDS0VkaXRvckhUTUxcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gR2V0Q0tFZGl0b3JIVE1MKCkge1xuICAgICAgdGhpcy5DbGVhckFMTEZvckRpdkVsZW1CdXR0b24oKTtcbiAgICAgIHRoaXMuQ2xlYXJBTExQbHVnaW5Jbm5lclBhbmVsKCk7XG4gICAgICByZXR1cm4gdGhpcy5HZXRDS0VkaXRvckluc3QoKS5nZXREYXRhKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIlNldENLRWRpdG9ySFRNTFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBTZXRDS0VkaXRvckhUTUwoaHRtbCkge1xuICAgICAgdGhpcy5HZXRDS0VkaXRvckluc3QoKS5zZXREYXRhKGh0bWwpO1xuICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBDS0VkaXRvclV0aWxpdHkuQUxMRWxlbUJpbmREZWZhdWx0RXZlbnQoKTtcbiAgICAgIH0sIDUwMCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIkdldENLRWRpdG9ySFRNTEluUGx1Z2luUGFnZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBHZXRDS0VkaXRvckhUTUxJblBsdWdpblBhZ2UoKSB7XG4gICAgICByZXR1cm4gd2luZG93LnBhcmVudC5DS0VkaXRvclV0aWxpdHkuR2V0Q0tFZGl0b3JIVE1MKCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIkluaXRpYWxpemVDS0VkaXRvclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBJbml0aWFsaXplQ0tFZGl0b3IodGV4dEFyZWFFbGVtSWQsIHBsdWdpbnNDb25maWcsIGxvYWRDb21wbGV0ZWRGdW5jLCBja2VkaXRvckNvbmZpZ0Z1bGxQYXRoLCBwbHVnaW5CYXNlUGF0aCwgdGhlbWVWbykge1xuICAgICAgdmFyIGV4dHJhUGx1Z2lucyA9IG5ldyBBcnJheSgpO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBsdWdpbnNDb25maWcubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHNpbmdsZVBsdWdpbkNvbmZpZyA9IHBsdWdpbnNDb25maWdbaV07XG4gICAgICAgIHZhciBzaW5nbGVOYW1lID0gc2luZ2xlUGx1Z2luQ29uZmlnLnNpbmdsZU5hbWU7XG4gICAgICAgIHZhciB0b29sYmFyTG9jYXRpb24gPSBzaW5nbGVQbHVnaW5Db25maWcudG9vbGJhckxvY2F0aW9uO1xuICAgICAgICB2YXIgdGV4dCA9IHNpbmdsZVBsdWdpbkNvbmZpZy50ZXh0O1xuICAgICAgICB2YXIgc2VydmVyUmVzb2x2ZSA9IHNpbmdsZVBsdWdpbkNvbmZpZy5zZXJ2ZXJSZXNvbHZlO1xuICAgICAgICB2YXIgY2xpZW50UmVzb2x2ZSA9IHNpbmdsZVBsdWdpbkNvbmZpZy5jbGllbnRSZXNvbHZlO1xuICAgICAgICB2YXIgY2xpZW50UmVzb2x2ZUpzID0gc2luZ2xlUGx1Z2luQ29uZmlnLmNsaWVudFJlc29sdmVKcztcbiAgICAgICAgdmFyIGRpYWxvZ1dpZHRoID0gc2luZ2xlUGx1Z2luQ29uZmlnLmRpYWxvZ1dpZHRoO1xuICAgICAgICB2YXIgZGlhbG9nSGVpZ2h0ID0gc2luZ2xlUGx1Z2luQ29uZmlnLmRpYWxvZ0hlaWdodDtcbiAgICAgICAgdmFyIGlzSkJ1aWxkNERDRGF0YSA9IHNpbmdsZVBsdWdpbkNvbmZpZy5pc0pCdWlsZDREQ0RhdGE7XG4gICAgICAgIHZhciBjb250cm9sQ2F0ZWdvcnkgPSBzaW5nbGVQbHVnaW5Db25maWcuY29udHJvbENhdGVnb3J5O1xuICAgICAgICB2YXIgc2VydmVyRHluYW1pY0JpbmQgPSBzaW5nbGVQbHVnaW5Db25maWcuc2VydmVyRHluYW1pY0JpbmQ7XG4gICAgICAgIHZhciBzaG93UmVtb3ZlQnV0dG9uID0gc2luZ2xlUGx1Z2luQ29uZmlnLnNob3dSZW1vdmVCdXR0b247XG4gICAgICAgIHZhciBzaG93SW5FZGl0b3JUb29sYmFyID0gc2luZ2xlUGx1Z2luQ29uZmlnLnNob3dJbkVkaXRvclRvb2xiYXI7XG4gICAgICAgIHZhciBlbmFibGVDaGlsZENvbnRyb2xzID0gc2luZ2xlUGx1Z2luQ29uZmlnLmVuYWJsZUNoaWxkQ29udHJvbHM7XG4gICAgICAgIHZhciBwbHVnaW5GaWxlTmFtZSA9IHNpbmdsZU5hbWUgKyBcIlBsdWdpbi5qc1wiO1xuICAgICAgICB2YXIgcGx1Z2luRm9sZGVyTmFtZSA9IHBsdWdpbkJhc2VQYXRoICsgc2luZ2xlTmFtZSArIFwiL1wiO1xuICAgICAgICBDS0VESVRPUi5wbHVnaW5zLmFkZEV4dGVybmFsKHNpbmdsZU5hbWUsIHBsdWdpbkZvbGRlck5hbWUsIHBsdWdpbkZpbGVOYW1lKTtcbiAgICAgICAgZXh0cmFQbHVnaW5zLnB1c2goc2luZ2xlTmFtZSk7XG4gICAgICAgIENLRWRpdG9yUGx1Z2luVXRpbGl0eS5BZGRQbHVnaW5zU2VydmVyQ29uZmlnKHNpbmdsZU5hbWUsIHRvb2xiYXJMb2NhdGlvbiwgdGV4dCwgY2xpZW50UmVzb2x2ZSwgc2VydmVyUmVzb2x2ZSwgY2xpZW50UmVzb2x2ZUpzLCBkaWFsb2dXaWR0aCwgZGlhbG9nSGVpZ2h0LCBpc0pCdWlsZDREQ0RhdGEsIGNvbnRyb2xDYXRlZ29yeSwgc2VydmVyRHluYW1pY0JpbmQsIHNob3dSZW1vdmVCdXR0b24sIHNob3dJbkVkaXRvclRvb2xiYXIsIGVuYWJsZUNoaWxkQ29udHJvbHMpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLlNldFRoZW1lVm8odGhlbWVWbyk7XG4gICAgICB2YXIgZWRpdG9yQ29uZmlnVXJsID0gQmFzZVV0aWxpdHkuQXBwZW5kVGltZVN0YW1wVXJsKGNrZWRpdG9yQ29uZmlnRnVsbFBhdGgpO1xuICAgICAgQ0tFRElUT1IucmVwbGFjZSh0ZXh0QXJlYUVsZW1JZCwge1xuICAgICAgICBjdXN0b21Db25maWc6IGVkaXRvckNvbmZpZ1VybCxcbiAgICAgICAgZXh0cmFQbHVnaW5zOiBleHRyYVBsdWdpbnMuam9pbihcIixcIilcbiAgICAgIH0pO1xuICAgICAgQ0tFRElUT1IuaW5zdGFuY2VzLmh0bWxfZGVzaWduLm9uKFwiYmVmb3JlUGFzdGVcIiwgZnVuY3Rpb24gKGV2ZW50KSB7fSk7XG4gICAgICBDS0VESVRPUi5pbnN0YW5jZXMuaHRtbF9kZXNpZ24ub24oXCJwYXN0ZVwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIHNvdXJjZUhUTUwgPSBldmVudC5kYXRhLmRhdGFWYWx1ZTtcbiAgICAgICAgY29uc29sZS5sb2coc291cmNlSFRNTCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB2YXIgJHNvdXJjZUhUTUwgPSAkKHNvdXJjZUhUTUwpO1xuICAgICAgICAgICRzb3VyY2VIVE1MLmZpbmQoXCIucGx1Z2luSW5uZXJQYW5lbFdyYXBcIikucmVtb3ZlKCk7XG5cbiAgICAgICAgICBpZiAoJHNvdXJjZUhUTUwuZmluZChcImRpdlwiKS5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgdmFyICRpbm5lckVsZW0gPSAkKCRzb3VyY2VIVE1MLmZpbmQoXCJkaXZcIikuZXEoMCkpO1xuICAgICAgICAgICAgdmFyIGlkID0gQ0tFZGl0b3JVdGlsaXR5LlRyeUdldElkRnJvbUxhc3RTZWxlY3RlZFRlbXBIVE1MKCRpbm5lckVsZW0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coaWQpO1xuXG4gICAgICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgICAgdmFyIG9sZEVsZW0gPSBDS0VkaXRvclV0aWxpdHkuR2V0Q0tFZGl0b3JJbnN0KCkuZG9jdW1lbnQuZ2V0QnlJZChpZCk7XG5cbiAgICAgICAgICAgICAgaWYgKG9sZEVsZW0pIHtcbiAgICAgICAgICAgICAgICBpZCA9IFwiY3RfY29weV9cIiArIFN0cmluZ1V0aWxpdHkuVGltZXN0YW1wKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlkID0gXCJjdF9jb3B5X1wiICsgU3RyaW5nVXRpbGl0eS5UaW1lc3RhbXAoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXZlbnQuZGF0YS5kYXRhVmFsdWUgPSAkaW5uZXJFbGVtLmF0dHIoXCJpZFwiLCBpZCkub3V0ZXJIVE1MKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCLpu4/otLTlvILluLgs6L+Y5Y6fSFRNTFwiKTtcbiAgICAgICAgICBldmVudC5kYXRhLmRhdGFWYWx1ZSA9IHNvdXJjZUhUTUw7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgQ0tFRElUT1IuaW5zdGFuY2VzLmh0bWxfZGVzaWduLm9uKFwiYWZ0ZXJQYXN0ZVwiLCBmdW5jdGlvbiAoZXZlbnQpIHt9KTtcbiAgICAgIENLRURJVE9SLmluc3RhbmNlcy5odG1sX2Rlc2lnbi5vbignaW5zZXJ0RWxlbWVudCcsIGZ1bmN0aW9uIChldmVudCkge30pO1xuICAgICAgQ0tFRElUT1IuaW5zdGFuY2VzLmh0bWxfZGVzaWduLm9uKCdpbnNlcnRIdG1sJywgZnVuY3Rpb24gKGV2ZW50KSB7fSk7XG4gICAgICBDS0VESVRPUi5pbnN0YW5jZXMuaHRtbF9kZXNpZ24ub24oJ3NlbGVjdGlvbkNoYW5nZScsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgZWxlbSA9IGV2ZW50LmRhdGEuc2VsZWN0aW9uLmdldFNlbGVjdGVkRWxlbWVudCgpO1xuICAgICAgICB2YXIgbGFzdEN1c3RTaW5nbGVOYW1lID0gXCJcIjtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV2ZW50LmRhdGEucGF0aC5lbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBlbGVtID0gZXZlbnQuZGF0YS5wYXRoLmVsZW1lbnRzW2ldO1xuICAgICAgICAgIHZhciBzaW5nbGVOYW1lID0gZWxlbS5nZXRBdHRyaWJ1dGUoXCJzaW5nbGVuYW1lXCIpO1xuICAgICAgICAgIHZhciBlbGVtSW5uZXJIVE1MID0gZWxlbS5nZXRIdG1sKCk7XG5cbiAgICAgICAgICBpZiAoc2luZ2xlTmFtZSkge1xuICAgICAgICAgICAgbGFzdEN1c3RTaW5nbGVOYW1lID0gc2luZ2xlTmFtZTtcbiAgICAgICAgICAgIENLRWRpdG9yVXRpbGl0eS5TZXRTZWxlY3RlZEVsZW0oZWxlbS5nZXRPdXRlckh0bWwoKSk7XG4gICAgICAgICAgICBDS0VkaXRvclV0aWxpdHkuU2V0TGFzdFNlbGVjdGVkVGVtcEhUTUwoZWxlbS5nZXRPdXRlckh0bWwoKSk7XG4gICAgICAgICAgICB2YXIgaW5uZXJIdG1sID0gZWxlbS5nZXRIdG1sKCk7XG4gICAgICAgICAgICBpbm5lckh0bWwgPSBpbm5lckh0bWwucmVwbGFjZSgvPGJyIFxcLz4vZywgXCJcIikucmVwbGFjZSgvPGJyPi9nLCBcIlwiKTtcblxuICAgICAgICAgICAgaWYgKGlubmVySHRtbC5pbmRleE9mKFwiPFwiKSA8IDApIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZWxlbSk7XG4gICAgICAgICAgICAgIENLRWRpdG9yVXRpbGl0eS5HZXRDS0VkaXRvckluc3QoKS5nZXRTZWxlY3Rpb24oKS5zZWxlY3RFbGVtZW50KGVsZW0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobGFzdEN1c3RTaW5nbGVOYW1lICE9IFwiV0ZEQ1RfVGVtcGxhdGVcIikge1xuICAgICAgICAgICAgICBDS0VkaXRvclV0aWxpdHkuQ3JlYXRlUGx1Z2luSW5uZXJQYW5lbChlbGVtKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGVsZW0uZ2V0TmFtZSgpID09IFwidGRcIiAmJiBlbGVtSW5uZXJIVE1MID09IFwiJm5ic3A7XCIpIHtcbiAgICAgICAgICAgIENLRWRpdG9yVXRpbGl0eS5HZXRDS0VkaXRvckluc3QoKS5nZXRTZWxlY3Rpb24oKS5zZWxlY3RFbGVtZW50KGVsZW0uZ2V0Q2hpbGQoMCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxhc3RDdXN0U2luZ2xlTmFtZSkge1xuICAgICAgICAgIENLRWRpdG9yVXRpbGl0eS5EaXNwbGF5UGx1Z2luQ29udHJvbHMoQ0tFZGl0b3JQbHVnaW5VdGlsaXR5LkdldEVuYWJsZUNoaWxkQ29udHJvbHMobGFzdEN1c3RTaW5nbGVOYW1lKSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5TZXRDS0VkaXRvckluc3QoQ0tFRElUT1IuaW5zdGFuY2VzLmh0bWxfZGVzaWduKTtcbiAgICAgIENLRURJVE9SLm9uKCdpbnN0YW5jZVJlYWR5JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBsb2FkQ29tcGxldGVkRnVuYyA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBsb2FkQ29tcGxldGVkRnVuYygpO1xuICAgICAgICAgIDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIkRpc3BsYXlQbHVnaW5Db250cm9sc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBEaXNwbGF5UGx1Z2luQ29udHJvbHMoZW5hYmxlQ2hpbGRDb250cm9scykge1xuICAgICAgJChcIi5ja2VfYnV0dG9uXCIpLnNob3coKTtcblxuICAgICAgaWYgKGVuYWJsZUNoaWxkQ29udHJvbHMgPT0gXCIqXCIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgcGx1Z2lucyA9IENLRWRpdG9yUGx1Z2luVXRpbGl0eS5HZXRQbHVnaW5zKCk7XG5cbiAgICAgIGZvciAodmFyIGtleSBpbiBwbHVnaW5zKSB7XG4gICAgICAgIHZhciBwbHVnaW4gPSBwbHVnaW5zW2tleV07XG4gICAgICAgIHZhciBzaW5nbGVOYW1lID0gcGx1Z2luLlNldHRpbmcuU2luZ2xlTmFtZTtcbiAgICAgICAgJChcIi5ja2VfYnV0dG9uX19cIiArIFN0cmluZ1V0aWxpdHkuVG9Mb3dlckNhc2Uoc2luZ2xlTmFtZSkpLmhpZGUoKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGVuYWJsZVBsdWdpbnMgPSBlbmFibGVDaGlsZENvbnRyb2xzLnNwbGl0KFwiO1wiKTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbmFibGVQbHVnaW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBzaW5nbGVOYW1lID0gZW5hYmxlUGx1Z2luc1tpXTtcbiAgICAgICAgJChcIi5ja2VfYnV0dG9uX19cIiArIFN0cmluZ1V0aWxpdHkuVG9Mb3dlckNhc2Uoc2luZ2xlTmFtZSkpLnNob3coKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiR2V0VGhlbWVWb1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBHZXRUaGVtZVZvKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX1RoZW1lVm87XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIlNldFRoZW1lVm9cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gU2V0VGhlbWVWbyhfdGhlbWVWbykge1xuICAgICAgdGhpcy5fVGhlbWVWbyA9IF90aGVtZVZvO1xuICAgICAgdGhpcy5SZXNldFJvb3RFbGVtVGhlbWUoX3RoZW1lVm8pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJSZXNldFJvb3RFbGVtVGhlbWVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gUmVzZXRSb290RWxlbVRoZW1lKF90aGVtZVZvKSB7XG4gICAgICBpZiAodGhpcy5HZXRDS0VkaXRvckluc3QoKSkge1xuICAgICAgICB2YXIgc291cmNlSFRNTCA9IHRoaXMuR2V0Q0tFZGl0b3JIVE1MKCk7XG5cbiAgICAgICAgaWYgKHNvdXJjZUhUTUwgIT0gbnVsbCAmJiBzb3VyY2VIVE1MICE9IFwiXCIpIHtcbiAgICAgICAgICB2YXIgcm9vdEVsZW0gPSAkKHNvdXJjZUhUTUwpO1xuXG4gICAgICAgICAgaWYgKHJvb3RFbGVtLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBjbGFzc0xpc3QgPSByb290RWxlbS5hdHRyKCdjbGFzcycpLnNwbGl0KC9cXHMrLyk7XG4gICAgICAgICAgICB2YXIgY2xhc3NhcnkgPSBbXTtcbiAgICAgICAgICAgICQuZWFjaChjbGFzc0xpc3QsIGZ1bmN0aW9uIChpbmRleCwgaXRlbSkge1xuICAgICAgICAgICAgICBpZiAoaXRlbS5pbmRleE9mKCdodG1sLWRlc2lnbi10aGVtZS0nKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgcm9vdEVsZW0ucmVtb3ZlQ2xhc3MoaXRlbSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcm9vdEVsZW0uYWRkQ2xhc3MoX3RoZW1lVm8ucm9vdEVsZW1DbGFzcyk7XG4gICAgICAgICAgICB0aGlzLlNldENLRWRpdG9ySFRNTChyb290RWxlbS5vdXRlckhUTUwoKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIkNsZWFyQUxMRm9yRGl2RWxlbUJ1dHRvblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBDbGVhckFMTEZvckRpdkVsZW1CdXR0b24oKSB7XG4gICAgICB2YXIgb2xkRGVsQnV0dG9ucyA9IENLRWRpdG9yVXRpbGl0eS5HZXRDS0VkaXRvckluc3QoKS5kb2N1bWVudC5maW5kKFwiLmRlbC1idXR0b25cIik7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkRGVsQnV0dG9ucy5jb3VudCgpOyBpKyspIHtcbiAgICAgICAgb2xkRGVsQnV0dG9ucy5nZXRJdGVtKGkpLnJlbW92ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJDcmVhdGVQbHVnaW5Jbm5lclBhbmVsXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIENyZWF0ZVBsdWdpbklubmVyUGFuZWwoZWxlbSkge1xuICAgICAgQ0tFZGl0b3JVdGlsaXR5LkNsZWFyQUxMUGx1Z2luSW5uZXJQYW5lbCgpO1xuICAgICAgdmFyIHBsdWdpbklubmVyUGFuZWwgPSBuZXcgQ0tFRElUT1IuZG9tLmVsZW1lbnQoJ2RpdicpO1xuICAgICAgcGx1Z2luSW5uZXJQYW5lbC5hZGRDbGFzcyhcInBsdWdpbklubmVyUGFuZWxXcmFwXCIpO1xuICAgICAgZWxlbS5hcHBlbmQocGx1Z2luSW5uZXJQYW5lbCk7XG4gICAgICB2YXIgc2VsZWN0QWxsQnV0dG9uID0gbmV3IENLRURJVE9SLmRvbS5lbGVtZW50KCdkaXYnKTtcbiAgICAgIHNlbGVjdEFsbEJ1dHRvbi5hZGRDbGFzcyhcImJ1dHRvblwiKTtcbiAgICAgIHNlbGVjdEFsbEJ1dHRvbi5hZGRDbGFzcyhcInNlbGVjdC1pbWdcIik7XG4gICAgICBzZWxlY3RBbGxCdXR0b24uc2V0QXR0cmlidXRlKCd0aXRsZScsICfpgInkuK0nKTtcbiAgICAgIHBsdWdpbklubmVyUGFuZWwuYXBwZW5kKHNlbGVjdEFsbEJ1dHRvbik7XG4gICAgICBzZWxlY3RBbGxCdXR0b24ub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIGFsZXJ0KFwi5pqC5LiN5pSv5oyBIVwiKTtcbiAgICAgICAgdmFyIGRvbUV2ZW50ID0gZXYuZGF0YTtcbiAgICAgICAgZG9tRXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB9KTtcbiAgICAgIHZhciBkZWxCdXR0b24gPSBuZXcgQ0tFRElUT1IuZG9tLmVsZW1lbnQoJ2RpdicpO1xuICAgICAgZGVsQnV0dG9uLmFkZENsYXNzKFwiYnV0dG9uXCIpO1xuICAgICAgZGVsQnV0dG9uLmFkZENsYXNzKFwiZGVsLWltZ1wiKTtcbiAgICAgIGRlbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgJ+WIoOmZpCcpO1xuICAgICAgcGx1Z2luSW5uZXJQYW5lbC5hcHBlbmQoZGVsQnV0dG9uKTtcbiAgICAgIGRlbEJ1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgZWxlbS5yZW1vdmUoKTtcbiAgICAgICAgdmFyIGRvbUV2ZW50ID0gZXYuZGF0YTtcbiAgICAgICAgZG9tRXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB9KTtcbiAgICAgIHZhciBjb3B5SWRCdXR0b24gPSBuZXcgQ0tFRElUT1IuZG9tLmVsZW1lbnQoJ2RpdicpO1xuICAgICAgY29weUlkQnV0dG9uLmFkZENsYXNzKFwiYnV0dG9uXCIpO1xuICAgICAgY29weUlkQnV0dG9uLmFkZENsYXNzKFwiY29weS1pZC1pbWdcIik7XG4gICAgICBjb3B5SWRCdXR0b24uc2V0QXR0cmlidXRlKCd0aXRsZScsICflpI3liLZJRCcpO1xuICAgICAgcGx1Z2luSW5uZXJQYW5lbC5hcHBlbmQoY29weUlkQnV0dG9uKTtcbiAgICAgIGNvcHlJZEJ1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgYWxlcnQoXCLmmoLkuI3mlK/mjIEhXCIpO1xuICAgICAgICB2YXIgZG9tRXZlbnQgPSBldi5kYXRhO1xuICAgICAgICBkb21FdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkb21FdmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJDbGVhckFMTFBsdWdpbklubmVyUGFuZWxcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gQ2xlYXJBTExQbHVnaW5Jbm5lclBhbmVsKCkge1xuICAgICAgdmFyIG9sZERlbEJ1dHRvbnMgPSBDS0VkaXRvclV0aWxpdHkuR2V0Q0tFZGl0b3JJbnN0KCkuZG9jdW1lbnQuZmluZChcIi5wbHVnaW5Jbm5lclBhbmVsV3JhcFwiKTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvbGREZWxCdXR0b25zLmNvdW50KCk7IGkrKykge1xuICAgICAgICBvbGREZWxCdXR0b25zLmdldEl0ZW0oaSkucmVtb3ZlKCk7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIlNpbmdsZUVsZW1CaW5kRGVmYXVsdEV2ZW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIFNpbmdsZUVsZW1CaW5kRGVmYXVsdEV2ZW50KGVsZW0pIHtcbiAgICAgIHZhciBzaW5nbGVOYW1lID0gZWxlbS5nZXRBdHRyaWJ1dGUoXCJzaW5nbGVuYW1lXCIpO1xuICAgICAgdmFyIGlubmVySHRtbCA9IGVsZW0uZ2V0SHRtbCgpO1xuICAgICAgaW5uZXJIdG1sID0gaW5uZXJIdG1sLnJlcGxhY2UoLzxiciBcXC8+L2csIFwiXCIpO1xuXG4gICAgICBpZiAoaW5uZXJIdG1sLmluZGV4T2YoXCI8XCIpIDwgMCkge1xuICAgICAgICBpZiAoc2luZ2xlTmFtZSkge1xuICAgICAgICAgIGVsZW0ub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzKTtcbiAgICAgICAgICAgIENLRWRpdG9yVXRpbGl0eS5HZXRDS0VkaXRvckluc3QoKS5nZXRTZWxlY3Rpb24oKS5zZWxlY3RFbGVtZW50KHRoaXMpO1xuICAgICAgICAgICAgQ0tFZGl0b3JVdGlsaXR5LlNldFNlbGVjdGVkRWxlbSh0aGlzLmdldE91dGVySHRtbCgpKTtcbiAgICAgICAgICAgIHZhciBkb21FdmVudCA9IGV2LmRhdGE7XG4gICAgICAgICAgICBkb21FdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiQUxMRWxlbUJpbmREZWZhdWx0RXZlbnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gQUxMRWxlbUJpbmREZWZhdWx0RXZlbnQoKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIuWPlua2iOS9v+eUqOeCueWHu+i/m+ihjOWFg+e0oOmAieaLqeWSjOWIoOmZpOeahOWKn+iDvSzov4Hnp7vkuLpzZWxlY3Rpb25DaGFuZ2Xkuovku7bov5vooYwhXCIpO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBDS0VkaXRvclV0aWxpdHk7XG59KCk7XG5cbl9kZWZpbmVQcm9wZXJ0eShDS0VkaXRvclV0aWxpdHksIFwiXyRDS0VkaXRvclNlbGVjdEVsZW1cIiwgbnVsbCk7XG5cbl9kZWZpbmVQcm9wZXJ0eShDS0VkaXRvclV0aWxpdHksIFwiX0xhc3RTZWxlY3RlZFRlbXBIVE1MXCIsIG51bGwpO1xuXG5fZGVmaW5lUHJvcGVydHkoQ0tFZGl0b3JVdGlsaXR5LCBcIl9DS0VkaXRvckluc3RcIiwgbnVsbCk7XG5cbl9kZWZpbmVQcm9wZXJ0eShDS0VkaXRvclV0aWxpdHksIFwiX1RoZW1lVm9cIiwgbnVsbCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgeyBpZiAoa2V5IGluIG9iaikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsgdmFsdWU6IHZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pOyB9IGVsc2UgeyBvYmpba2V5XSA9IHZhbHVlOyB9IHJldHVybiBvYmo7IH1cblxudmFyIEhUTUxFZGl0b3JVdGlsaXR5ID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBIVE1MRWRpdG9yVXRpbGl0eSgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSFRNTEVkaXRvclV0aWxpdHkpO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKEhUTUxFZGl0b3JVdGlsaXR5LCBudWxsLCBbe1xuICAgIGtleTogXCJHZXRIVE1MRWRpdG9ySW5zdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBHZXRIVE1MRWRpdG9ySW5zdCgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9IVE1MRWRpdG9ySW5zdDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiU2V0SFRNTEVkaXRvckhUTUxcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gU2V0SFRNTEVkaXRvckhUTUwoaHRtbCkge1xuICAgICAgaWYgKCFTdHJpbmdVdGlsaXR5LklzTnVsbE9yRW1wdHkoaHRtbCkpIHtcbiAgICAgICAgdGhpcy5HZXRIVE1MRWRpdG9ySW5zdCgpLnNldFZhbHVlKGh0bWwpO1xuICAgICAgICBDb2RlTWlycm9yLmNvbW1hbmRzW1wic2VsZWN0QWxsXCJdKHRoaXMuR2V0SFRNTEVkaXRvckluc3QoKSk7XG4gICAgICAgIHZhciByYW5nZSA9IHtcbiAgICAgICAgICBmcm9tOiB0aGlzLkdldEhUTUxFZGl0b3JJbnN0KCkuZ2V0Q3Vyc29yKHRydWUpLFxuICAgICAgICAgIHRvOiB0aGlzLkdldEhUTUxFZGl0b3JJbnN0KCkuZ2V0Q3Vyc29yKGZhbHNlKVxuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIHRoaXMuR2V0SFRNTEVkaXRvckluc3QoKS5hdXRvRm9ybWF0UmFuZ2UocmFuZ2UuZnJvbSwgcmFuZ2UudG8pO1xuICAgICAgICB2YXIgYTEgPSB7XG4gICAgICAgICAgbGluZTogMCxcbiAgICAgICAgICBjaDogMlxuICAgICAgICB9O1xuICAgICAgICB0aGlzLkdldEhUTUxFZGl0b3JJbnN0KCkuZ2V0RG9jKCkuZWFjaExpbmUoZnVuY3Rpb24gKGxpbmUpIHt9KTtcbiAgICAgICAgdmFyIHNlbGVjdGVkRWxlbSA9IENLRWRpdG9yVXRpbGl0eS5HZXRTZWxlY3RlZEVsZW0oKTtcbiAgICAgICAgdmFyIHNlYXJjaEhUTUwgPSBcIlwiO1xuXG4gICAgICAgIGlmIChzZWxlY3RlZEVsZW0pIHtcbiAgICAgICAgICBzZWFyY2hIVE1MID0gc2VsZWN0ZWRFbGVtLm91dGVySFRNTCgpLnNwbGl0KFwiPlwiKVswXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBjdXJzb3IgPSB0aGlzLkdldEhUTUxFZGl0b3JJbnN0KCkuZ2V0U2VhcmNoQ3Vyc29yKHNlYXJjaEhUTUwpO1xuICAgICAgICBjdXJzb3IuZmluZE5leHQoKTtcblxuICAgICAgICBpZiAoY3Vyc29yLmZyb20oKSAmJiBjdXJzb3IudG8oKSkge1xuICAgICAgICAgIHRoaXMuR2V0SFRNTEVkaXRvckluc3QoKS5nZXREb2MoKS5zZXRTZWxlY3Rpb24oY3Vyc29yLmZyb20oKSwgY3Vyc29yLnRvKCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIkdldEh0bWxFZGl0b3JIVE1MXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIEdldEh0bWxFZGl0b3JIVE1MKCkge1xuICAgICAgcmV0dXJuIHRoaXMuR2V0SFRNTEVkaXRvckluc3QoKS5nZXRWYWx1ZSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJJbml0aWFsaXplSFRNTENvZGVEZXNpZ25cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gSW5pdGlhbGl6ZUhUTUxDb2RlRGVzaWduKCkge1xuICAgICAgdmFyIG1peGVkTW9kZSA9IHtcbiAgICAgICAgbmFtZTogXCJodG1sbWl4ZWRcIixcbiAgICAgICAgc2NyaXB0VHlwZXM6IFt7XG4gICAgICAgICAgbWF0Y2hlczogL1xcL3gtaGFuZGxlYmFycy10ZW1wbGF0ZXxcXC94LW11c3RhY2hlL2ksXG4gICAgICAgICAgbW9kZTogbnVsbFxuICAgICAgICB9LCB7XG4gICAgICAgICAgbWF0Y2hlczogLyh0ZXh0fGFwcGxpY2F0aW9uKVxcLyh4LSk/dmIoYXxzY3JpcHQpL2ksXG4gICAgICAgICAgbW9kZTogXCJ2YnNjcmlwdFwiXG4gICAgICAgIH1dXG4gICAgICB9O1xuICAgICAgdGhpcy5fSFRNTEVkaXRvckluc3QgPSBDb2RlTWlycm9yLmZyb21UZXh0QXJlYShkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIlRleHRBcmVhSFRNTEVkaXRvclwiKSwge1xuICAgICAgICBtb2RlOiBtaXhlZE1vZGUsXG4gICAgICAgIHNlbGVjdGlvblBvaW50ZXI6IHRydWUsXG4gICAgICAgIHRoZW1lOiBcIm1vbm9rYWlcIixcbiAgICAgICAgZm9sZEd1dHRlcjogdHJ1ZSxcbiAgICAgICAgZ3V0dGVyczogW1wiQ29kZU1pcnJvci1saW5lbnVtYmVyc1wiLCBcIkNvZGVNaXJyb3ItZm9sZGd1dHRlclwiXSxcbiAgICAgICAgbGluZU51bWJlcnM6IHRydWUsXG4gICAgICAgIGxpbmVXcmFwcGluZzogdHJ1ZVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX0hUTUxFZGl0b3JJbnN0LnNldFNpemUoXCIxMDAlXCIsIFBhZ2VTdHlsZVV0aWxpdHkuR2V0V2luZG93SGVpZ2h0KCkgLSA4NSk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIEhUTUxFZGl0b3JVdGlsaXR5O1xufSgpO1xuXG5fZGVmaW5lUHJvcGVydHkoSFRNTEVkaXRvclV0aWxpdHksIFwiX0hUTUxFZGl0b3JJbnN0XCIsIG51bGwpOyIsIlwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9XG5cbnZhciBKc0VkaXRvclV0aWxpdHkgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEpzRWRpdG9yVXRpbGl0eSgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSnNFZGl0b3JVdGlsaXR5KTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhKc0VkaXRvclV0aWxpdHksIG51bGwsIFt7XG4gICAga2V5OiBcIl9HZXROZXdGb3JtSnNTdHJpbmdcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gX0dldE5ld0Zvcm1Kc1N0cmluZygpIHtcbiAgICAgIHJldHVybiBcIjxzY3JpcHQ+dmFyIEZvcm1QYWdlT2JqZWN0SW5zdGFuY2U9e1wiICsgXCJkYXRhOntcIiArIFwidXNlckVudGl0eTp7fSxcIiArIFwiZm9ybUVudGl0eTpbXSxcIiArIFwiY29uZmlnOltdXCIgKyBcIn0sXCIgKyBcInBhZ2VSZWFkeTpmdW5jdGlvbigpe30sXCIgKyBcImJpbmRSZWNvcmREYXRhUmVhZHk6ZnVuY3Rpb24oKXt9LFwiICsgXCJ2YWxpZGF0ZUV2ZXJ5RnJvbUNvbnRyb2w6ZnVuY3Rpb24oY29udHJvbE9iail7fVwiICsgXCJ9PC9zY3JpcHQ+XCI7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIkdldEpzRWRpdG9ySW5zdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBHZXRKc0VkaXRvckluc3QoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fSnNFZGl0b3JJbnN0O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJTZXRKc0VkaXRvckpzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIFNldEpzRWRpdG9ySnMoanMpIHtcbiAgICAgIHRoaXMuR2V0SnNFZGl0b3JJbnN0KCkuc2V0VmFsdWUoanMpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJHZXRKc0VkaXRvckpzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIEdldEpzRWRpdG9ySnMoKSB7XG4gICAgICByZXR1cm4gdGhpcy5HZXRKc0VkaXRvckluc3QoKS5nZXRWYWx1ZSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJJbml0aWFsaXplSnNDb2RlRGVzaWduXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIEluaXRpYWxpemVKc0NvZGVEZXNpZ24oc3RhdHVzKSB7XG4gICAgICB0aGlzLl9Kc0VkaXRvckluc3QgPSBDb2RlTWlycm9yLmZyb21UZXh0QXJlYSgkKFwiI1RleHRBcmVhSnNFZGl0b3JcIilbMF0sIHtcbiAgICAgICAgbW9kZTogXCJhcHBsaWNhdGlvbi9sZCtqc29uXCIsXG4gICAgICAgIGxpbmVOdW1iZXJzOiB0cnVlLFxuICAgICAgICBsaW5lV3JhcHBpbmc6IHRydWUsXG4gICAgICAgIGV4dHJhS2V5czoge1xuICAgICAgICAgIFwiQ3RybC1RXCI6IGZ1bmN0aW9uIEN0cmxRKGNtKSB7XG4gICAgICAgICAgICBjbS5mb2xkQ29kZShjbS5nZXRDdXJzb3IoKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmb2xkR3V0dGVyOiB0cnVlLFxuICAgICAgICBzbWFydEluZGVudDogdHJ1ZSxcbiAgICAgICAgbWF0Y2hCcmFja2V0czogdHJ1ZSxcbiAgICAgICAgdGhlbWU6IFwibW9ub2thaVwiLFxuICAgICAgICBndXR0ZXJzOiBbXCJDb2RlTWlycm9yLWxpbmVudW1iZXJzXCIsIFwiQ29kZU1pcnJvci1mb2xkZ3V0dGVyXCJdXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fSnNFZGl0b3JJbnN0LnNldFNpemUoXCIxMDAlXCIsIFBhZ2VTdHlsZVV0aWxpdHkuR2V0V2luZG93SGVpZ2h0KCkgLSA4NSk7XG5cbiAgICAgIGlmIChzdGF0dXMgPT0gXCJhZGRcIikge1xuICAgICAgICB0aGlzLlNldEpzRWRpdG9ySnModGhpcy5fR2V0TmV3Rm9ybUpzU3RyaW5nKCkpO1xuICAgICAgICBDb2RlTWlycm9yLmNvbW1hbmRzW1wic2VsZWN0QWxsXCJdKHRoaXMuR2V0SnNFZGl0b3JJbnN0KCkpO1xuICAgICAgICB2YXIgcmFuZ2UgPSB7XG4gICAgICAgICAgZnJvbTogdGhpcy5HZXRKc0VkaXRvckluc3QoKS5nZXRDdXJzb3IodHJ1ZSksXG4gICAgICAgICAgdG86IHRoaXMuR2V0SnNFZGl0b3JJbnN0KCkuZ2V0Q3Vyc29yKGZhbHNlKVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLkdldEpzRWRpdG9ySW5zdCgpLmF1dG9Gb3JtYXRSYW5nZShyYW5nZS5mcm9tLCByYW5nZS50byk7XG4gICAgICB9XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIEpzRWRpdG9yVXRpbGl0eTtcbn0oKTtcblxuX2RlZmluZVByb3BlcnR5KEpzRWRpdG9yVXRpbGl0eSwgXCJfSnNFZGl0b3JJbnN0XCIsIG51bGwpOyJdfQ==
